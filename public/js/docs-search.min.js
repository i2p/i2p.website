(function(){"use strict";document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e();function e(){const t=document.getElementById("docs-search"),e=document.getElementById("search-results");if(!t||!e)return;let s=null,n=[],i=null;fetch("/en/docs/index.json").then(e=>e.json()).then(e=>{n=e,s=lunr(function(){this.ref("id"),this.field("title",{boost:10}),this.field("description",{boost:5}),this.field("content"),n.forEach(e=>{this.add(e)})}),console.log("Search index loaded with",n.length,"documents")}).catch(e=>{console.error("Failed to load search index:",e)}),t.addEventListener("input",function(e){const t=e.target.value.trim();if(clearTimeout(i),t.length<2){o();return}i=setTimeout(()=>{r(t)},300)}),t.addEventListener("keydown",function(n){const i=e.querySelectorAll(".search-result-item"),a=e.querySelector(".search-result-item.focused");let s=Array.from(i).indexOf(a);if(n.key==="ArrowDown")n.preventDefault(),s=s<i.length-1?s+1:0,i[s]&&(i.forEach(e=>e.classList.remove("focused")),i[s].classList.add("focused"),i[s].scrollIntoView({block:"nearest"}));else if(n.key==="ArrowUp")n.preventDefault(),s=s>0?s-1:i.length-1,i[s]&&(i.forEach(e=>e.classList.remove("focused")),i[s].classList.add("focused"),i[s].scrollIntoView({block:"nearest"}));else if(n.key==="Enter"&&a){n.preventDefault();const e=a.querySelector("a");e&&e.click()}else n.key==="Escape"&&(o(),t.blur())}),document.addEventListener("click",function(n){!t.contains(n.target)&&!e.contains(n.target)&&o()});function r(t){if(!s){e.innerHTML='<div class="search-loading">Loading search index...</div>',e.classList.add("visible");return}try{const e=s.query(function(e){t.split(/\s+/).forEach(t=>{e.term(t,{boost:100}),e.term(t,{boost:10,usePipeline:!0,wildcard:lunr.Query.wildcard.TRAILING}),e.term(t,{boost:1,usePipeline:!0,editDistance:1})})});c(e,t)}catch(t){console.error("Search error:",t),e.innerHTML='<div class="search-no-results">Search error. Please try again.</div>',e.classList.add("visible")}}function c(t,s){if(t.length===0){e.innerHTML='<div class="search-no-results">No results found</div>',e.classList.add("visible");return}const i=10,r=t.slice(0,i);let o='<div class="search-results-list">';r.forEach(e=>{const t=n.find(t=>t.id===e.ref);if(!t)return;const i=a(t.title,s),r=a(t.description||d(t.content,150),s);o+=`
          <div class="search-result-item">
            <a href="${t.url}">
              <div class="search-result-title">${i}</div>
              <div class="search-result-description">${r}</div>
              <div class="search-result-url">${t.url}</div>
            </a>
          </div>
        `}),t.length>i&&(o+=`<div class="search-results-more">${t.length-i} more results...</div>`),o+="</div>",e.innerHTML=o,e.classList.add("visible")}function a(e,t){if(!e)return"";const s=t.toLowerCase().split(/\s+/);let n=e;return s.forEach(e=>{const t=new RegExp(`(${l(e)})`,"gi");n=n.replace(t,"<mark>$1</mark>")}),n}function l(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function d(e,t){return!e||e.length<=t?e||"":e.substring(0,t).trim()+"..."}function o(){e.classList.remove("visible"),e.innerHTML=""}}})()