---
title: "Зашифрованный LeaseSet"
number: "121"
author: "zzz"
created: "2016-01-11"
lastupdated: "2016-01-12"
status: "Отклонено"
thread: "http://zzz.i2p/topics/2047"
supercededby: "123"
---

## Обзор

Это предложение о переработке механизма шифрования LeaseSet.


## Мотивация

Текущий зашифрованный LS ужасен и небезопасен. Я могу это сказать, я его разработал и реализовал.

Причины:

- Шифрование AES CBC
- Один ключ AES для всех
- Сроки действия Lease все еще открыты
- Публичный ключ шифрования все еще открыт


## Дизайн

### Цели

- Сделать всю вещь непрозрачной
- Ключи для каждого получателя


### Стратегия

Сделать так, как делает GPG/OpenPGP. Асимметрично зашифровать симметричный ключ для каждого
получателя. Данные расшифровываются с помощью этого асимметричного ключа. См., например, [RFC-4880-S5.1]_
ЕСЛИ мы можем найти алгоритм, который мал и быстр.

Хитрость заключается в нахождении асимметричного шифрования, которое будет малым и быстрым. ElGamal на 514
байтах здесь немного болезненен. Мы можем сделать лучше.

См., например, http://security.stackexchange.com/questions/824...

Это работает для небольшого числа получателей (или на самом деле, ключей; вы все равно можете
распространять ключи среди нескольких людей, если хотите).


## Спецификация

- Назначение
- Время публикации
- Срок действия
- Флаги
- Длина данных
- Зашифрованные данные
- Подпись

Зашифрованные данные могут быть префиксированы каким-либо спецификатором enctype, а могут и не быть.


## Ссылки

.. [RFC-4880-S5.1]
    https://tools.ietf.org/html/rfc4880#section-5.1
