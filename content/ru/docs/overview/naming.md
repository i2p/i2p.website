---
title: "Именование и Адресная книга"
description: "Как I2P сопоставляет удобочитаемые имена хостов с адресами назначения"
slug: "naming"
lastUpdated: "2025-10"
accurateFor: "2.10.0"
---

I2P-адреса представляют собой длинные криптографические ключи. Система именования обеспечивает более дружественный уровень поверх этих ключей **без введения центрального органа управления**. Все имена являются **локальными** — каждый router самостоятельно определяет, на какое назначение ссылается имя хоста.

> **Нужна предыстория?** В [обсуждении именования](/docs/legacy/naming/) документированы исходные дискуссии по дизайну, альтернативные предложения и философские основы децентрализованной системы именования I2P.

---

## 1. Компоненты

Система именования I2P состоит из нескольких независимых, но взаимодействующих подсистем:

1. **Naming service** – преобразует имена хостов в destinations и обрабатывает [Base32 имена хостов](#base32-hostnames).
2. **HTTP proxy** – передает запросы `.i2p` в router и предлагает jump-сервисы, когда имя неизвестно.
3. **Host-add сервисы** – CGI-формы, которые добавляют новые записи в локальную адресную книгу.
4. **Jump-сервисы** – удаленные помощники, которые возвращают destination для указанного имени хоста.
5. **Адресная книга** – периодически загружает и объединяет удаленные списки хостов, используя локально доверенную "сеть доверия".
6. **SusiDNS** – веб-интерфейс для управления адресными книгами, подписками и локальными переопределениями.

Такая модульная архитектура позволяет пользователям определять собственные границы доверия и автоматизировать процесс именования в той степени, в которой они считают нужным.

---

## 2. Службы именования

API именования роутера (`net.i2p.client.naming`) поддерживает несколько бэкендов через настраиваемое свойство `i2p.naming.impl=<class>`. Каждая реализация может предлагать различные стратегии поиска, но все они используют одну и ту же модель доверия и разрешения имён.

### 2.1 Hosts.txt (legacy format)

Устаревшая модель использовала три текстовых файла, проверяемых по порядку:

1. `privatehosts.txt`
2. `userhosts.txt`
3. `hosts.txt`

Каждая строка хранит соответствие `hostname=base64-destination`. Этот простой текстовый формат по-прежнему полностью поддерживается для импорта/экспорта, но он больше не используется по умолчанию из-за низкой производительности при превышении списком хостов нескольких тысяч записей.

---

### 2.2 Blockfile Naming Service (default backend)

Представлена в **релизе 0.8.8**, Blockfile Naming Service теперь является бэкендом по умолчанию. Она заменяет плоские файлы высокопроизводительным хранилищем ключ/значение на основе skiplist на диске (`hostsdb.blockfile`), обеспечивая примерно **в 10 раз более быструю** скорость поиска.

**Основные характеристики:** - Хранит несколько логических адресных книг (private, user и hosts) в одной бинарной базе данных. - Поддерживает совместимость с устаревшим импортом/экспортом hosts.txt. - Поддерживает обратный поиск, метаданные (дата добавления, источник, комментарии) и эффективное кэширование. - Использует тот же трёхуровневый порядок поиска: private → user → hosts.

Этот подход обеспечивает обратную совместимость, при этом значительно повышая скорость разрешения и масштабируемость.

---

### 2.1 Hosts.txt (устаревший формат)

Разработчики могут реализовать пользовательские backend-системы, такие как: - **Meta** – объединяет несколько систем именования. - **PetName** – поддерживает petnames, хранящиеся в `petnames.txt`. - **AddressDB**, **Exec**, **Eepget** и **Dummy** – для внешнего разрешения имён или резервных вариантов.

Реализация blockfile остается **рекомендуемым** бэкендом для общего использования благодаря производительности и надежности.

---

## 3. Base32 Hostnames

Имена хостов Base32 (`*.b32.i2p`) работают аналогично адресам `.onion` в Tor. Когда вы обращаетесь к адресу `.b32.i2p`:

1. Router декодирует Base32 содержимое.
2. Он восстанавливает destination непосредственно из ключа — **поиск в адресной книге не требуется**.

Это гарантирует достижимость, даже если не существует человекочитаемого имени хоста. Расширенные Base32 имена, представленные в **релизе 0.9.40**, поддерживают **LeaseSet2** и зашифрованные назначения.

---

## 4. Address Book & Subscriptions

Приложение адресной книги получает списки удалённых хостов по HTTP и объединяет их локально в соответствии с настроенными пользователем правилами доверия.

### 2.2 Blockfile Naming Service (стандартный бэкенд)

- Подписки представляют собой стандартные `.i2p` URL, указывающие на `hosts.txt` или ленты инкрементальных обновлений.
- Обновления загружаются периодически (по умолчанию ежечасно) и проверяются перед объединением.
- Конфликты разрешаются **по принципу «первым пришёл — первым обслужен»**, следуя порядку приоритета:  
  `privatehosts.txt` → `userhosts.txt` → `hosts.txt`.

#### Default Providers

Начиная с **I2P 2.3.0 (июнь 2023 года)**, включены два провайдера подписок по умолчанию: - `http://i2p-projekt.i2p/hosts.txt` - `http://notbob.i2p/hosts.txt`

Эта избыточность повышает надежность, сохраняя при этом модель локального доверия. Пользователи могут добавлять или удалять подписки через SusiDNS.

#### Incremental Updates

Инкрементальные обновления загружаются через `newhosts.txt` (заменяя устаревшую концепцию `recenthosts.cgi`). Эта конечная точка обеспечивает эффективные обновления на основе **ETag** — возвращая только новые записи с момента последнего запроса или `304 Not Modified`, когда изменений нет.

---

### 2.3 Альтернативные бэкенды и плагины

- **Сервисы добавления хостов** (`add*.cgi`) позволяют вручную отправлять сопоставления имени и destination. Всегда проверяйте destination перед принятием.
- **Jump-сервисы** отвечают соответствующим ключом и могут перенаправлять через HTTP-прокси с параметром `?i2paddresshelper=`.
  Распространённые примеры: `stats.i2p`, `identiguy.i2p` и `notbob.i2p`.
  Эти сервисы **не являются доверенными центрами**—пользователи должны сами решать, какие использовать.

---

## 5. Managing Entries Locally (SusiDNS)

SusiDNS доступен по адресу: `http://127.0.0.1:7657/susidns/`

Вы можете: - Просматривать и редактировать локальные адресные книги. - Управлять подписками и устанавливать их приоритет. - Импортировать/экспортировать списки хостов. - Настраивать расписание обновлений.

**Новое в I2P 2.8.1 (март 2025 года):** - Добавлена функция «сортировка по последним». - Улучшена обработка подписок (исправление несоответствий ETag).

Все изменения остаются **локальными** — адресная книга каждого роутера уникальна.

---

## 3. Base32 имена хостов

Следуя RFC 9476, I2P зарегистрировал **`.i2p.alt`** в GNUnet Assigned Numbers Authority (GANA) по состоянию на **март 2025 года (I2P 2.8.1)**.

**Цель:** Предотвратить случайные утечки DNS из-за неправильно настроенного программного обеспечения.

- DNS-резолверы, совместимые с RFC 9476, **не будут пересылать** домены `.alt` в публичный DNS.
- Программное обеспечение I2P обрабатывает `.i2p.alt` как эквивалент `.i2p`, удаляя суффикс `.alt` при разрешении.
- `.i2p.alt` **не** предназначен для замены `.i2p`; это техническая мера защиты, а не ребрендинг.

---

## 4. Адресная книга и подписки

- **Ключи destination:** 516–616 байт (Base64)  
- **Имена хостов:** Максимум 67 символов (включая `.i2p`)  
- **Допустимые символы:** a–z, 0–9, `-`, `.` (без двойных точек, без заглавных букв)  
- **Зарезервировано:** `*.b32.i2p`  
- **ETag и Last-Modified:** активно используются для минимизации трафика  
- **Средний размер hosts.txt:** ~400 КБ для ~800 хостов (пример)  
- **Использование трафика:** ~10 байт/сек при обновлении каждые 12 часов

---

## 8. Security Model and Philosophy

I2P намеренно жертвует глобальной уникальностью в обмен на децентрализацию и безопасность — прямое применение **треугольника Зуко** (Zooko's Triangle).

**Ключевые принципы:** - **Отсутствие центрального органа:** все запросы выполняются локально.   - **Устойчивость к перехвату DNS:** запросы шифруются с использованием публичных ключей назначения.   - **Предотвращение Sybil-атак:** отсутствие голосования или консенсусного именования.   - **Неизменяемые сопоставления:** после установления локальной ассоциации она не может быть удалённо переопределена.

Системы именования на основе блокчейна (например, Namecoin, ENS) исследовали решение всех трёх сторон треугольника Зуко, но I2P намеренно избегает их из-за задержек, сложности и философской несовместимости с его моделью локального доверия.

---

## 9. Compatibility and Stability

- Никакие функции именования не были признаны устаревшими в период 2023–2025.
- Формат hosts.txt, jump-сервисы, подписки и все реализации API именования остаются функциональными.
- Проект I2P поддерживает строгую **обратную совместимость** при внедрении улучшений производительности и безопасности (изоляция NetDB, разделение Sub-DB и т.д.).

---

## 10. Best Practices

- Храните только доверенные подписки; избегайте больших списков неизвестных хостов.
- Создавайте резервные копии `hostsdb.blockfile` и `privatehosts.txt` перед обновлением или переустановкой.
- Регулярно проверяйте jump-сервисы и отключайте те, которым больше не доверяете.
- Помните: ваша адресная книга определяет вашу версию мира I2P — **каждое имя хоста является локальным**.

---

### Further Reading

- [Обсуждение именования](/docs/legacy/naming/)  
- [Спецификация Blockfile](/docs/specs/blockfile/)  
- [Формат файла конфигурации](/docs/specs/configuration/)  
- [Javadoc службы именования](http://idk.i2p/javadoc-i2p/net/i2p/client/naming/package-summary.html)

---
