---
title: "I2P: Масштабируемая платформа для анонимных коммуникаций"
description: "Техническое введение в архитектуру и работу I2P"
slug: "tech-intro"
lastUpdated: "2025-10"
accurateFor: "2.10.0"
---

## Введение

I2P — это масштабируемый, самоорганизующийся, устойчивый анонимный сетевой уровень с коммутацией пакетов, на котором может работать любое количество различных приложений, ориентированных на анонимность или безопасность. Каждое из этих приложений может самостоятельно выбирать компромисс между анонимностью, задержкой и пропускной способностью, не беспокоясь о правильной реализации mixnet со свободной маршрутизацией, что позволяет им смешивать свою активность с более широким набором анонимности пользователей, уже работающих поверх I2P.

Уже доступные приложения обеспечивают полный спектр типичных интернет-активностей — **анонимный** веб-серфинг, веб-хостинг, чат, обмен файлами, электронную почту, ведение блогов и распространение контента, а также ряд других приложений, находящихся в разработке.

- **Веб-браузинг:** используя любой существующий браузер с поддержкой прокси  
- **Чат:** IRC и другие протоколы  
- **Обмен файлами:** [I2PSnark](#i2psnark) и другие приложения  
- **Электронная почта:** [Susimail](#i2pmail) и другие приложения  
- **Блог:** используя любой локальный веб-сервер или доступные плагины

В отличие от веб-сайтов, размещённых в сетях распространения контента, таких как [Freenet](/docs/overview/comparison#freenet) или [GNUnet](https://www.gnunet.org/), сервисы, размещённые в I2P, полностью интерактивны — здесь есть традиционные поисковые системы веб-стиля, доски объявлений, блоги, в которых можно оставлять комментарии, сайты на основе баз данных, а также мосты для запросов к статическим системам вроде Freenet без необходимости локальной установки.

Со всеми этими приложениями с поддержкой анонимности I2P выступает в роли **message-oriented middleware** (промежуточного ПО, ориентированного на обмен сообщениями) — приложения указывают данные для отправки на криптографический идентификатор («destination»), а I2P обеспечивает их безопасную и анонимную доставку. I2P также включает простую [библиотеку потоковой передачи](#streaming), которая позволяет анонимным сообщениям I2P с доставкой по принципу «best-effort» передаваться в виде надёжных упорядоченных потоков, обеспечивая управление перегрузкой на основе TCP, настроенное под высокое произведение пропускной способности на задержку сети.

Хотя были разработаны простые SOCKS-прокси для подключения существующих приложений, их ценность ограничена, поскольку большинство приложений раскрывают конфиденциальную информацию в анонимном контексте. Самый безопасный подход — это **проверить и адаптировать** приложение для прямого использования API I2P.

I2P — это не исследовательский проект (ни академический, ни коммерческий, ни государственный), а инженерная разработка, направленная на обеспечение практичной анонимности. Проект находится в активной разработке с начала 2003 года распределённой группой разработчиков по всему миру. Весь код I2P является **открытым** на [официальном сайте](https://geti2p.net/), в основном выпускается в общественное достояние, некоторые компоненты распространяются под разрешительными лицензиями в стиле BSD. Доступны несколько клиентских приложений под лицензией GPL, такие как [I2PTunnel](#i2ptunnel), [Susimail](#i2pmail) и [I2PSnark](#i2psnark). Финансирование поступает исключительно из пожертвований пользователей.

---

## Работа

### Overview

I2P четко разграничивает router'ы (узлы, участвующие в сети) и destinations (анонимные конечные точки для приложений). Сам факт работы I2P не является секретом; скрыто **что именно** делает пользователь и какой router используют его destinations. Конечные пользователи обычно запускают несколько destinations (например, один для веб-браузинга, другой для хостинга, третий для IRC).

Ключевая концепция I2P — это **tunnel** (туннель) — однонаправленный зашифрованный путь через серию роутеров. Каждый роутер расшифровывает только один слой и узнаёт только следующий переход. Tunnels истекают каждые 10 минут и должны быть перестроены заново.

![Схема входящих и исходящих туннелей](/images/tunnels.png)   *Рисунок 1: Существует два типа туннелей — inbound (входящие) и outbound (исходящие).*

- **Outbound tunnels** отправляют сообщения от создателя.  
- **Inbound tunnels** доставляют сообщения обратно к создателю.

Объединение этих туннелей обеспечивает двустороннюю связь. Например, «Алиса» использует outbound tunnel для отправки данных в inbound tunnel «Боба». Алиса шифрует своё сообщение с инструкциями маршрутизации к inbound gateway Боба.

Еще одна ключевая концепция — это **сетевая база данных** или **netDb**, которая распределяет метаданные о роутерах и назначениях:

- **RouterInfo:** Содержит контактную информацию router и ключевой материал.  
- **LeaseSet:** Содержит информацию, необходимую для связи с destination (шлюзы tunnel, время истечения, ключи шифрования).

Роутеры публикуют свою информацию RouterInfo напрямую в netDb; LeaseSets отправляются через исходящие туннели для обеспечения анонимности.

Для построения туннелей Алиса запрашивает netDb для получения записей RouterInfo, чтобы выбрать узлы, и отправляет зашифрованные сообщения построения туннеля от узла к узлу, пока туннель не будет завершён.

![Информация о роутере используется для построения туннелей](/images/netdb_get_routerinfo_2.png)   *Рисунок 2: Информация о роутере используется для построения туннелей.*

Чтобы отправить данные Бобу, Алиса ищет LeaseSet Боба и использует один из своих исходящих туннелей для маршрутизации данных через шлюз входящего туннеля Боба.

![LeaseSets соединяют входящие и исходящие туннели](/images/netdb_get_leaseset.png)   *Рисунок 3: LeaseSets соединяют исходящие и входящие туннели.*

Поскольку I2P основана на сообщениях, она добавляет **сквозное garlic-шифрование** для защиты сообщений даже от исходящей конечной точки или входящего шлюза. Garlic-сообщение содержит несколько зашифрованных «зубчиков» (сообщений), чтобы скрыть метаданные и улучшить анонимность.

Приложения могут либо напрямую использовать интерфейс сообщений, либо полагаться на [библиотеку потоковой передачи](#streaming) для надёжных соединений.

---

### Tunnels

Как входящие, так и исходящие туннели используют многослойное шифрование, но различаются по конструкции:

- В **входящих tunnel**, создатель (конечная точка) расшифровывает все слои.
- В **исходящих tunnel**, создатель (шлюз) предварительно расшифровывает слои для обеспечения ясности на конечной точке.

I2P профилирует узлы через косвенные метрики, такие как задержка и надежность, без прямого зондирования. На основе этих профилей узлы динамически группируются в четыре уровня:

1. Быстрый и высокопроизводительный  
2. Высокопроизводительный  
3. Работоспособный  
4. Неработоспособный

Выбор узлов для туннеля обычно отдаёт предпочтение высокопроизводительным узлам, случайно выбранным для баланса между анонимностью и производительностью, с дополнительными стратегиями упорядочивания на основе XOR для предотвращения атак предшественников и сбора данных netDb.

Для более подробной информации см. [Спецификацию туннелей](/docs/specs/implementation).

---

### Обзор

Роутеры, участвующие в распределённой хеш-таблице (DHT) **floodfill**, хранят и отвечают на запросы LeaseSet. DHT использует вариант [Kademlia](https://en.wikipedia.org/wiki/Kademlia). Floodfill роутеры выбираются автоматически, если они обладают достаточной производительностью и стабильностью, или могут быть настроены вручную.

- **RouterInfo:** Описывает возможности router и его транспорты.  
- **LeaseSet:** Описывает tunnel'ы destination и ключи шифрования.

Все данные в netDb подписаны издателем и имеют временные метки для предотвращения атак повторного воспроизведения или использования устаревших записей. Синхронизация времени поддерживается через SNTP и обнаружение смещения на транспортном уровне.

#### Additional concepts

- **Неопубликованные и зашифрованные LeaseSets:**  
  Точка назначения может оставаться приватной, не публикуя свой LeaseSet и делясь им только с доверенными узлами. Для доступа требуется соответствующий ключ расшифровки.

- **Bootstrapping (reseeding):**  
  Чтобы присоединиться к сети, новый router загружает подписанные файлы RouterInfo с доверенных HTTPS reseed-серверов.

- **Масштабируемость поиска:**  
  I2P использует **итеративный**, а не рекурсивный поиск для улучшения масштабируемости и безопасности DHT.

---

### Туннели

Современная коммуникация I2P использует два полностью зашифрованных транспорта:

- **[NTCP2](/docs/specs/ntcp2):** Зашифрованный протокол на основе TCP  
- **[SSU2](/docs/specs/ssu2):** Зашифрованный протокол на основе UDP

Оба построены на современном [Noise Protocol Framework](https://noiseprotocol.org/), обеспечивая надёжную аутентификацию и устойчивость к идентификации трафика. Они заменили устаревшие протоколы NTCP и SSU (полностью выведены из эксплуатации с 2023 года).

**NTCP2** предоставляет зашифрованную, эффективную потоковую передачу данных через TCP.

**SSU2** обеспечивает надежность на основе UDP, обход NAT и опциональный hole punching. SSU2 концептуально похож на WireGuard или QUIC, сочетая надежность и анонимность.

Роутеры могут поддерживать как IPv4, так и IPv6, публикуя свои транспортные адреса и стоимость в netDb. Транспорт соединения выбирается динамически с помощью **системы торгов**, которая оптимизирует условия и существующие связи.

---

### Сетевая база данных (netDb)

I2P использует многоуровневое шифрование для всех компонентов: транспортов, туннелей, garlic-сообщений и сетевой базы данных (network database).

Текущие примитивы включают:

- X25519 для обмена ключами  
- EdDSA (Ed25519) для подписей  
- ChaCha20-Poly1305 для аутентифицированного шифрования  
- SHA-256 для хеширования  
- AES256 для шифрования на уровне tunnel

Устаревшие алгоритмы (ElGamal, DSA-SHA1, ECDSA) остаются для обратной совместимости.

I2P в настоящее время внедряет гибридные постквантовые (PQ) криптографические схемы, объединяющие **X25519** с **ML-KEM**, для противодействия атакам типа "собрать сейчас, расшифровать позже".

#### Garlic Messages

Garlic-сообщения расширяют луковую маршрутизацию, группируя несколько зашифрованных "зубчиков" с независимыми инструкциями доставки. Это обеспечивает гибкость маршрутизации на уровне сообщений и единообразное заполнение трафика.

#### Session Tags

Для сквозного шифрования поддерживаются две криптографические системы:

- **ElGamal/AES+SessionTags (устаревший):**  
  Использует предварительно доставленные сессионные теги в качестве 32-байтовых nonce. Теперь устарел из-за неэффективности.

- **ECIES-X25519-AEAD-Ratchet (текущий):**  
  Использует ChaCha20-Poly1305 и синхронизированные PRNG на основе HKDF для динамической генерации эфемерных ключей сессии и 8-байтовых тегов, снижая нагрузку на CPU, память и пропускную способность при сохранении прямой секретности.

---

## Future of the Protocol

Ключевые направления исследований сосредоточены на поддержании безопасности против противников государственного уровня и внедрении постквантовой защиты. Две ранние концепции дизайна — **restricted routes** и **variable latency** — были заменены современными разработками.

### Restricted Route Operation

Первоначальные концепции ограниченной маршрутизации были направлены на сокрытие IP-адресов. Эта необходимость была в значительной степени устранена благодаря:

- UPnP для автоматической переадресации портов  
- Надёжное преодоление NAT в SSU2  
- Поддержка IPv6  
- Совместные introducers и пробивка NAT  
- Опциональная overlay-связь (например, Yggdrasil)

Таким образом, современный I2P достигает тех же целей более практичным способом без сложной ограниченной маршрутизации.

---

## Similar Systems

I2P интегрирует концепции из промежуточного программного обеспечения, ориентированного на сообщения (message-oriented middleware), распределённых хеш-таблиц (DHT) и микснетов (mixnet). Его инновационность заключается в объединении этих концепций в удобную, самоорганизующуюся платформу для обеспечения анонимности.

### Транспортные протоколы

*[Сайт](https://www.torproject.org/)*

**Tor** и **I2P** имеют общие цели, но различаются архитектурно:

- **Tor:** Коммутация каналов; опирается на доверенные серверы каталогов. (~10 тыс. relay)  
- **I2P:** Коммутация пакетов; полностью распределённая сеть на основе DHT. (~50 тыс. router)

Однонаправленные туннели I2P раскрывают меньше метаданных и позволяют гибко настраивать маршруты, в то время как Tor фокусируется на анонимном **доступе в Интернет (outproxying)**.   I2P же поддерживает анонимный **хостинг внутри сети**.

### Криптография

*[Сайт](https://freenetproject.org/)*

**Freenet** фокусируется на анонимной, постоянной публикации и получении файлов. **I2P**, напротив, предоставляет **коммуникационный уровень реального времени** для интерактивного использования (веб, чат, торренты). Вместе эти две системы дополняют друг друга — Freenet обеспечивает устойчивое к цензуре хранилище; I2P обеспечивает анонимность транспорта.

### Other Networks

- **Lokinet:** IP-оверлей с использованием мотивированных сервисных узлов.  
- **Nym:** Миксовая сеть нового поколения с акцентом на защиту метаданных с помощью маскирующего трафика при более высокой задержке.

---

## Appendix A: Application Layer

Сам I2P обрабатывает только транспорт сообщений. Функциональность прикладного уровня реализуется внешне через API и библиотеки.

### Streaming Library {#streaming}

**Библиотека потоковой передачи** функционирует как TCP-аналог в I2P, с протоколом скользящего окна и управлением перегрузкой, настроенными для высокозадержанной анонимной передачи данных.

Типичные шаблоны HTTP-запросов/ответов часто могут выполняться за один круговой обмен благодаря оптимизациям объединения сообщений.

### Naming Library and Address Book

*Разработано: mihi, Ragnarok*   См. страницу [Именование и адресная книга](/docs/overview/naming).

Система именования I2P является **локальной и децентрализованной**, избегая глобальных имён в стиле DNS. Каждый router поддерживает локальное сопоставление человекочитаемых имён с destinations (адресами назначения). Опциональные адресные книги, основанные на сети доверия, могут быть распределены или импортированы от доверенных участников.

Этот подход избегает централизованных органов управления и обходит уязвимости Sybil, присущие глобальным системам именования или системам, основанным на голосовании.

### Операция ограниченного маршрута

*Разработано: mihi*

**I2PTunnel** — это основной клиентский интерфейс, обеспечивающий анонимное TCP-проксирование. Он поддерживает:

- **Client tunnels** (исходящие к I2P-адресатам)  
- **HTTP client (eepproxy)** для доменов ".i2p"  
- **Server tunnels** (входящие из I2P к локальному сервису)  
- **HTTP server tunnels** (безопасное проксирование веб-сервисов)

Outproxy (выход в обычный интернет) является опциональным и реализуется через добровольно управляемые «серверные» tunnels.

### I2PSnark {#i2psnark}

*Разработано: jrandom и др. — портировано из [Snark](http://www.klomp.org/snark/)*

В комплекте с I2P поставляется **I2PSnark** — анонимный BitTorrent-клиент с поддержкой нескольких торрентов, DHT и UDP, доступный через веб-интерфейс.

### Tor

*Разработано: postman, susi23, mastiejaner*

**I2Pmail** предоставляет анонимную электронную почту через соединения I2PTunnel. **Susimail** — это веб-клиент, специально разработанный для предотвращения утечек информации, характерных для традиционных почтовых клиентов. Сервис [mail.i2p](https://mail.i2p/) включает фильтрацию вирусов, квоты [hashcash](https://en.wikipedia.org/wiki/Hashcash) и раздельные outproxy для дополнительной защиты.

---
