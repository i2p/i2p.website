---
title: "SAM v2"
description: "Устаревший протокол Simple Anonymous Messaging (простой протокол анонимного обмена сообщениями)"
slug: "samv2"
lastUpdated: "2025-03"
accurateFor: "0.9.20"
reviewStatus: "needs-review"
---

> **Устарело:** SAM v2 поставлялась вместе с I2P 0.6.1.31 и больше не поддерживается. Для новой разработки используйте [SAM v3](/docs/api/samv3/). Единственным улучшением v2 по сравнению с v1 была поддержка нескольких сокетов, мультиплексированных поверх одного SAM-соединения.

## Примечания к версии

- Сообщаемая строка версии по‑прежнему равна `"2.0"`.
- Начиная с 0.9.14 сообщение `HELLO VERSION` принимает однозначные значения `MIN`/`MAX`, а параметр `MIN` является необязательным.
- `DEST GENERATE` поддерживает `SIGNATURE_TYPE`, поэтому можно создавать назначения Ed25519.

## Основы сеанса

```
SESSION CREATE STYLE={STREAM|DATAGRAM|RAW} DESTINATION={name|TRANSIENT} [DIRECTION={BOTH|RECEIVE|CREATE}] [option=value]
```
- У каждого назначения может быть только один активный сеанс SAM (потоки, дейтаграммы или raw (необработанные)).
- `STYLE` выбирает виртуальные потоки, подписанные дейтаграммы или raw дейтаграммы.
- Дополнительные параметры передаются в I2CP (например, `tunnels.quantityInbound=3`).
- Ответы аналогичны v1: `SESSION STATUS RESULT=OK|DUPLICATED_DEST|I2P_ERROR|INVALID_KEY`.

## Кодирование сообщений

Построчный ASCII с парами `key=value`, разделёнными пробелами (значения могут быть заключены в кавычки). Типы взаимодействия те же, что в v1:

- Потоки через потоковую библиотеку I2P
- Дейтаграммы с возможностью ответа (`PROTO_DATAGRAM`)
- Сырые дейтаграммы (`PROTO_DATAGRAM_RAW`)

## Когда использовать

Только для устаревших клиентов, которые не могут мигрировать. SAM v3 предлагает:

- Передача назначения в бинарном виде (`DEST GENERATE BASE64`)
- Подсессии и поддержка DHT (распределённая хеш-таблица) (v3.3)
- Улучшенные сообщения об ошибках и согласование параметров

См.:

- [SAM v1](/docs/legacy/sam/)
- [SAM v3](/docs/api/samv3/)
- [API датаграмм](/docs/api/datagrams/)
- [Протокол потоковой передачи](/docs/specs/streaming/)
