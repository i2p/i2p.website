---
title: "Обсуждение NTCP"
description: "Исторические заметки по сравнению транспортов NTCP и SSU и предложения по настройке"
slug: "ntcp"
layout: "single"
reviewStatus: "needs-review"
---

## Обсуждение NTCP vs. SSU (март 2007)

### Вопросы по NTCP

_Адаптировано из беседы в IRC между zzz и cervantes._

- **Почему NTCP имеет приоритет над SSU, если NTCP, похоже, добавляет накладные расходы и задержку?**  
  В целом NTCP обеспечивает лучшую надежность, чем исходная реализация SSU.
- **Приводит ли потоковая передача поверх NTCP к классическому коллапсу TCP поверх TCP?**  
  Возможно, но SSU задумывался как облегченный вариант на основе UDP и на практике оказался слишком ненадежным.

### “NTCP признан вредным” (zzz, 25 марта 2007)

Резюме: более высокая задержка и накладные расходы NTCP могут приводить к перегрузке, однако маршрутизация предпочитает NTCP, поскольку его bid scores (оценки bid при выборе транспорта) жестко заданы ниже, чем у SSU. Анализ выявил несколько моментов:


#### Предложения из темы 2007 года

1. **Инвертировать приоритеты транспортов** так, чтобы routers предпочитали SSU (восстановив `i2np.udp.alwaysPreferred`).
2. **Пометить трафик streaming (библиотека потоковой передачи в I2P)** так, чтобы SSU снижал приоритет только для помеченных сообщений, без ущерба для анонимности.
3. **Ужесточить пределы ретрансляции SSU**, чтобы снизить риск коллапса.
4. **Изучить semi-reliable underlays (полунадежные нижние транспортные слои)**, чтобы определить, дают ли ретрансляции ниже библиотеки streaming чистую выгоду.
5. **Пересмотреть очереди приоритетов и тайм-ауты**—например, увеличить тайм-ауты streaming свыше 45 с, чтобы привести их в соответствие с NTCP.

### Ответ от jrandom (27 марта 2007 г.)

Основные контраргументы:

- NTCP существует потому, что ранние внедрения SSU страдали от коллапса сети из‑за перегрузки. Даже умеренные уровни повторных передач на каждом переходе (hop) могут взрывно возрастать через многохоповые tunnel.
- Без подтверждений на уровне tunnel лишь часть сообщений получает сквозной (end‑to‑end) статус доставки; сбои могут оставаться незаметными.
- Механизмы управления перегрузкой в TCP оптимизировались десятилетиями; NTCP использует это благодаря зрелым реализациям стеков TCP.
- Наблюдавшийся рост эффективности при предпочтении SSU может отражать поведение очередей на router, а не внутренние преимущества протокола.
- Увеличенные тайм‑ауты стриминга уже улучшали стабильность; прежде чем вносить крупные изменения, рекомендовалось собрать больше наблюдений и данных.

Дискуссия помогла уточнить последующую настройку транспорта, но не отражает современную архитектуру NTCP2/SSU2.
