---
title: "Tunnel 토론"
description: "tunnel 패딩, 단편화, 그리고 구축 전략에 대한 역사적 탐구"
slug: "tunnel"
layout: "single"
lastUpdated: "2019-07"
accurateFor: "0.9.41"
reviewStatus: "needs-review"
---

> **참고:** 이 아카이브에는 I2P 0.9.41 이전의 탐색적 설계 작업이 수록되어 있습니다. 프로덕션 구현에 대해서는 [tunnel documentation](/docs/specs/implementation/)를 참조하십시오.

## 설정 대안

향후 tunnel 조정 옵션으로 고려된 아이디어는 다음과 같다:

- 메시지 전달을 위한 빈도 제한
- 패딩 정책(chaff injection(채프 주입) 포함)
- tunnel 수명 제어
- 페이로드 전송을 위한 배치 및 큐 전략

이러한 옵션들은 레거시 구현과 함께 제공되지 않았다.

## 패딩 전략

논의된 잠재적 패딩 접근 방식:

- 패딩을 전혀 사용하지 않음
- 무작위 길이의 패딩
- 고정 길이의 패딩
- 가장 가까운 킬로바이트 단위까지 패딩
- 2의 거듭제곱(`2^n` 바이트)에 맞춘 패딩

초기 측정(릴리스 0.4) 결과, 현재의 고정된 1024바이트 tunnel 메시지 크기가 결정되었습니다. 상위 수준의 garlic messages(가릴릭 메시지)는 자체 패딩을 추가할 수 있습니다.

## 단편화

메시지 길이를 통한 태깅 공격을 방지하기 위해 tunnel 메시지는 1024바이트로 고정됩니다. 더 큰 I2NP 페이로드는 게이트웨이에서 조각으로 분할되며, 엔드포인트가 짧은 타임아웃 내에 이를 재조립합니다. router는 전송 전에 패킹 효율을 극대화하기 위해 조각을 재배열할 수 있습니다.

## 추가 대안

### 중간 단계에서 tunnel 처리 조정

세 가지 가능성이 검토되었다:

1. 복호화된 페이로드에 대한 접근을 허용하여 중간 홉이 tunnel을 일시적으로 종료할 수 있도록 한다.
2. 참여하는 routers가 다음 홉으로 진행하기 전에 메시지를 자신의 아웃바운드 tunnels 중 하나로 보내 “remix”할 수 있도록 허용한다.
3. tunnel 생성자가 피어의 다음 홉을 동적으로 재정의할 수 있도록 한다.

### 양방향 Tunnels

인바운드와 아웃바운드 tunnel을 분리하면 어떤 단일 피어 집합이 관찰할 수 있는 정보가 제한된다(예: GET 요청 vs. 대용량 응답). 양방향 tunnel은 피어 관리가 단순해지지만, 양 방향 모두에 전체 트래픽 패턴을 동시에 노출한다. 따라서 단방향 tunnel이 선호되는 설계로 유지되었다.

### Backchannels(역방향 채널)과 가변 크기

tunnel 메시지 크기를 가변적으로 허용하면 공모하는 피어들 사이에 은닉 채널이 가능해진다(예: 선택된 크기 또는 빈도를 통해 데이터를 인코딩). 고정 크기 메시지는 추가 패딩 오버헤드를 대가로 이러한 위험을 완화한다.

## Tunnel 구축의 대안

참고: [공개 환경에서의 해싱](http://www-users.cs.umn.edu/~hopper/hashing_it_out.pdf)

### 레거시 “병렬” 빌드 방법

릴리스 0.6.1.10 이전에는 tunnel 구축 요청은 각 참여자에게 병렬로 전송되었다. 이 방식은 [이전 tunnel 페이지](/docs/legacy/old-implementation/)에 문서화되어 있다.

### 원샷 망원경식 구축(현재 방식)

현대적인 접근법은 부분적으로 구축된 tunnel을 통해 빌드 메시지를 홉별로 전달한다. Tor의 telescoping(연결을 홉 단위로 단계적으로 확장하는 기법)과 유사하지만, 빌드 메시지를 탐색용 tunnel을 통해 라우팅하면 정보 누출이 줄어든다.

### “대화형” 텔레스코핑

명시적인 왕복 통신을 통해 한 번에 한 홉씩 구축하는 방식은 피어들이 메시지 수를 세어 tunnel 내에서 자신의 위치를 추론할 수 있게 하므로, 이 접근법은 채택되지 않았다.

### 비탐색 관리 tunnels

하나의 제안은 build traffic(터널 구축 시 발생하는 트래픽)을 위해 관리용 tunnels의 별도 풀을 유지하는 것이었다. 이는 분할된 routers에는 도움이 될 수 있지만, 네트워크 통합이 충분하다면 불필요하다고 판단되었다.

### 탐색 전달(레거시)

0.6.1.10 이전에는 개별 tunnel 요청이 garlic encryption으로 암호화되어 탐색용 tunnel을 통해 전달되었고, 응답은 별도로 반환되었다. 이 전략은 현재의 one-shot telescoping(단일 시도로 단계적 확장을 수행하는 방식)으로 대체되었다.

## 핵심 요점

- 고정 크기 tunnel 메시지는 추가 패딩 비용에도 불구하고 크기 기반 태깅과 은닉 채널을 방어한다.
- 대체 패딩, 단편화, 그리고 구축 전략도 검토되었지만, 익명성 트레이드오프를 감안했을 때 채택되지 않았다.
- tunnel 설계는 효율성, 관측 가능성, 그리고 선행자 공격과 혼잡 공격에 대한 저항성 사이의 균형을 지속적으로 맞춘다.
