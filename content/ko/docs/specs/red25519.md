---
title: "Red25519 서명 스킴"
description: "블라인딩된 Destination(목적지) 생성을 위한 재랜덤화 가능한 서명 스킴"
slug: "red25519-signature-scheme"
lastUpdated: "2025-10"
accurateFor: "2.10.0"
---

## 개요

이 문서는 블라인드할 수 있는 Destination(목적지)을 생성하기에 적합한 re-randomizable signature scheme(재랜덤화 가능한 서명 스킴)을 명세한다. 또한 기존 Ed25519 Destination을 블라인드하는 데에도 사용할 수 있으나, 효율성이 소폭 저하된다.

Red25519는 0.9.39 버전(2019년 3월 21일 출시)부터 I2P routers에서 완전 지원됩니다. 17개월간의 실운영 배포를 거친 뒤, 본 사양은 0.9.47 버전(2020년 8월)에서 최종 확정되었습니다. 이 서명 스킴은 I2P 네트워크에서 서명 유형 11(RedDSA_SHA512_Ed25519)로 동작합니다.

## 동기

Proposal 123 (New netDB Entries)는 Principle of Least Authority(최소 권한 원칙)를 구현한 암호화된 LeaseSet2 형식을 정의한다: 각 네트워크 참여자는 자신의 역할에 필요한 정보만 제공받는다. 특히, floodfill에 게시된 암호화된 LeaseSet2는 대상 Destination을 드러내지 않으며, Leases는 해당 Destination에 대한 사전 지식을 가진 사람만 열람할 수 있다. 그러나 floodfill은 여전히 게시 시 암호화된 LeaseSet2를 인증할 수 있어야 하고, 클라이언트는 추가로 그 인증이 Destination 자체에 의해 강제되었음을 보장해야 한다.

제안 123은 Destination(목적지 식별자)의 서명 키를 블라인딩함으로써 이를 달성한다. 블라인딩된 키는 floodfill에 의해 검증 가능한 서명을 생성하는 데 사용할 수 있으며, 클라이언트는 오직 해당 Destination만이 그 서명을 생성했음을 확신할 수 있다. 따라서 블라인딩에 사용할 수 있는 서명 스킴을 명시할 필요가 있다.

**Proposal 123 상태 안내**: Proposal 123의 일부는 0.9.38 버전부터 순차적으로 구현되어 배포되었으며, 0.9.39에서 Red25519 지원이 추가되었습니다. 암호화된 LeaseSet2 기능은 운영 환경에서 사용할 준비가 되어 있으며, 프라이버시가 강화된 히든 서비스용으로 I2P 네트워크에서 활발히 사용되고 있습니다.

## 설계

### 핵심 서명 체계

여기에서 명시하는 서명 스킴 Red25519는 Zcash 프로토콜 명세서(Sapling 및 이후) 섹션 5.4.6에 정의된 RedDSA의 구현이다. RedDSA는 key re-randomization(키 재무작위화)을 지원하는 슈노르 기반 서명 스킴이다. 다음과 같은 함수가 있다:

**GENERATE_PRIVATE()** : 균등한 분포를 따르는 무작위 개인 키를 반환합니다.

**DERIVE_PUBLIC(sk)** : 주어진 개인 키에 해당하는 공개 키를 반환합니다.

**GENERATE_RANDOM()** : 키 쌍을 재무작위화하는 데 적합한 무작위 스칼라를 반환합니다.

**RANDOMIZE_PRIVATE(sk, alpha)** : 비밀 스칼라 alpha를 사용하여 개인 키를 재랜덤화합니다.

**RANDOMIZE_PUBLIC(vk, alpha)** : 비밀 스칼라 alpha를 사용하여 공개 키를 재무작위화합니다.

**SIGN(sk, m)** : 주어진 메시지 m에 대해 개인 키 sk로 생성한 서명을 반환합니다.

**VERIFY(vk, m, sig)** : 공개키 vk와 메시지 m에 대해 서명 sig를 검증합니다. 서명이 유효하면 true를 반환하고, 그렇지 않으면 false를 반환합니다.

주어진 키 쌍 (sk, vk)에 대해 다음과 같은 관계가 성립한다:

```
RANDOMIZE_PUBLIC(vk, alpha) == DERIVE_PUBLIC(RANDOMIZE_PRIVATE(sk, alpha))
```
### Ed25519(타원곡선 전자서명 방식) 키를 Red25519(RedDSA 전자서명 방식)로 변환하기

Ed25519 키는 기존 Ed25519 Destination(목적지)의 재무작위화를 지원하기 위해 일시적인 일방향 변환을 통해 Red25519 키로 변환될 수 있습니다. 다른 서명 유형은 호환되지 않습니다.

다음과 같은 변환 함수를 정의합니다:

**CONVERT_ED25519_PRIVATE(privkey)** : 주어진 Ed25519 개인 키에 해당하는 Red25519 개인 키를 반환합니다.

**CONVERT_ED25519_PUBLIC(pubkey)** : 주어진 Ed25519 공개 키에 대응하는 Red25519 공개 키를 반환합니다.

주어진 Ed25519 키 쌍 (privkey, pubkey)에 대해 다음 관계가 성립한다:

```
CONVERT_ED25519_PUBLIC(pubkey) == DERIVE_PUBLIC(CONVERT_ED25519_PRIVATE(privkey))
```
## 명세

### 정의

**B** : [RFC 8032](https://www.rfc-editor.org/rfc/rfc8032.html)에 정의된 Ed25519 기저점.

**L** : [RFC 8032](https://www.rfc-editor.org/rfc/rfc8032.html)에 정의된 대로 Ed25519의 차수 2^252 + 27742317777372353535851937790883648493.

**[s] B** : 고정된 기준점에 대해 s를 곱하는 스칼라 곱셈.

**[s] A** : A에 s를 곱하는 가변 기준점 스칼라 곱셈.

**x || y** : 바이트 배열 x에 y를 이어 붙입니다.

### Red25519(암호학 알고리즘 명칭)

스킴 Red25519는 RedDSA를 다음과 같이 특화한다:

- G := Curve25519의 에드워즈 형태 위의 점들로 이루어진 군. 특히, 이는 Red25519가 차수 L의 소수 부분군을 사용하며, 보수(cofactor) h_G는 8임을 의미한다.
- P_G := Ed25519 기저점 B.
- l_H := 512
- H(x) := SHA-512("I2P_Red25519H(x)" || x)

**해시 함수 선택에 대한 참고**: Red25519는 Zcash RedDSA에서 사용되는 BLAKE2b-512 대신 SHA-512를 사용합니다. 이러한 설계 선택은 아래에 설명된 length-prefixing(길이 접두어 부여) 보호로 보완됩니다. I2P Proposal 148은 중복 메시지 식별(DMI) 및 길이 확장 공격(LEA)에 대한 보호를 강화하고 성능을 향상하기 위해 향후 BLAKE2b-512로의 마이그레이션을 제안합니다.

RedDSA는 H(x)가 길이 확장 공격에 대해 안전한 암호학적 해시 함수로 인스턴스화된다고 가정한다. SHA-512는 그 자체로는 이를 만족하지 않는다. 이를 보완하기 위해, 메시지의 길이를 prefix-free encoding(접두사-자유 인코딩)으로 표현한 접두사를 메시지 앞에 붙일 것을 요구한다:

```
len_u16(M) || M
```
여기서 `len_u16(M)`은 M의 길이를 2바이트로 표현한 값이며, 리틀 엔디언이다(스칼라와 포인트의 리틀 엔디언 인코딩과 일관성을 유지하기 위해).

메시지는 65534 바이트를 초과할 수 없습니다. 65535 바이트 길이는 향후 확장을 위해 예약되어 있습니다.

**Security Note**: 해시 함수에 공개키(vk)를 포함하고 서명 시 80바이트의 난수를 결합함으로써, 초기 RedDSA 설계에서 발견된 SURK-CMA (Strong Unforgeability with Re-randomized Keys under Chosen Message Attack, 선택 메시지 공격 하에서 재랜덤화된 키에 대한 강한 위조불가능성) 취약점으로부터의 보호를 보장합니다. 이 구현에는 NCC Group Zcash 감사(Finding NCC-Zcash2018-009)의 보안 수정 사항이 포함되어 있습니다.

### 인코딩과 디코딩

Red25519 개인 키는 L을 법으로 하는 스칼라이며, 리틀 엔디언 표현으로 인코딩됩니다. 스칼라의 바이트 배열 형태와 정수 형태 사이를 상호 변환하기 위해 함수 `DECODE_SCALAR`와 `ENCODE_SCALAR`를 정의합니다.

Red25519 공개키는 Curve25519(타원곡선 이름)의 에드워즈 형태 위의 점이다. 이들은 y좌표의 255비트 리틀 엔디언 표현 뒤에 x좌표의 부호를 나타내는 1비트를 이어붙인 방식으로 인코딩된다. 이는 Ed25519(서명 알고리즘 이름)와 동일한 인코딩이다. 점의 바이트 배열 형태와 좌표 형태 사이를 상호 변환하기 위해 `DECODE_POINT`와 `ENCODE_POINT` 함수를 정의한다.

### RedDSA(랜덤화된 Edwards-곡선 디지털 서명 알고리즘) 함수

구현을 용이하게 하기 위해, 이미 Red25519(레드25519)에 맞게 특화된 RedDSA(레드DSA) 함수들(그리고 몇 가지 보조 함수들)을 아래에 명시적으로 작성한다. 구현자들은 RedDSA 함수들의 일반적인 명세에 대해서는 Zcash Protocol Specification(지캐시 프로토콜 명세서) 섹션 5.4.6을 참조해야 한다.

```
HStar(prefix1, prefix2, m) :=
    h = SHA-512()
    h.input("I2P_Red25519H(x)")
    h.input(prefix1)
    h.input(prefix2)

    h.input(len(m) & 0xff)
    h.input((len(m) >> 8) & 0xff)
    h.input(m)

    s = h.digest()
    return s mod L

GENERATE_PRIVATE :=
    s = 64 random bytes
    return s mod L

DERIVE_PUBLIC(sk) := [sk] B

GENERATE_RANDOM :=
    s = 64 random bytes
    return s mod L

RANDOMIZE_PRIVATE(sk, alpha) := (sk + alpha) mod L

RANDOMIZE_PUBLIC(vk, alpha) := vk + [alpha] B

SIGN(sk, m) :=
    T = 80 random bytes
    vkBytes = ENCODE_POINT(DERIVE_PUBLIC(sk))
    r = HStar(T, vkBytes, m)

    R = [r] B
    Rbytes = ENCODE_POINT(R)

    c = HStar(Rbytes, vkBytes, m)
    S = (r + (c * sk)) mod L

    return Rbytes || ENCODE_SCALAR(S)

VERIFY(vk, m, sig) :=
    Rbytes = sig[0..32]
    Sbytes = sig[32..64]

    R = DECODE_POINT(Rbytes)
    if R is invalid:
        return false

    S = DECODE_SCALAR(Sbytes)
    if S >= L:
        return false

    vkBytes = ENCODE_POINT(vk)
    c = HStar(Rbytes, vkBytes, m)
    return ((-[S] B) + R + ([c] vk)).multiplyByCofactor().isIdentity()
```
### 변환 함수

```
CONVERT_ED25519_PRIVATE(privkey) :=
    s = SHA-512(privkey)[0..32]
    s[0] = s[0] & 248
    s[31] = (s[31] & 63) | 64
    return s

CONVERT_ED25519_PUBLIC(pubkey) := pubkey
```
`CONVERT_ED25519_PRIVATE`의 구현은 Ed25519 개인 키에서 Ed25519 공개 키를 유도할 때 비밀 스칼라 s를 계산하는 것과 동등하며, 이는 [RFC 8032](https://www.rfc-editor.org/rfc/rfc8032.html) 섹션 5.1.5의 1–3단계에 명시되어 있습니다.

## 보안상의 영향

Red25519 Destination(I2P 목적지 식별자)를 다시 무작위화한 다음 그것으로 서명을 생성하더라도, 해당 Destination에 관한 어떤 정보도 누설되지 않는다. 이는 `RANDOMIZE_PRIVATE`를 통해 생성된 Red25519 개인 키의 분포가 `GENERATE_PRIVATE`를 통해 생성된 개인 키의 분포와 동일하고, `DERIVE_PUBLIC`이 결정적이기 때문이다.

`CONVERT_ED25519_PRIVATE`를 통해 Ed25519(타원곡선 디지털 서명 방식) 개인 키를 Red25519(Ed25519에서 파생된 변환 키 형식)로 변환하면 동일한 분포가 생성되지 않습니다. 그러나 다음과 같은 이유로 보안성 감소는 수용 가능하다고 판단합니다:

- Ed25519 스칼라의 공간은 Red25519 스칼라의 공간 크기의 대략 절반이다(가능한 Ed25519 스칼라는 2^251개이고, 가능한 Red25519 스칼라는 L ~= 2^252개이다). 따라서 보안 강도 손실은 많아야 대략 2배, 즉 약 1비트에 불과하다(우연히 Ed25519에도 유효한 Red25519 스칼라를 선택했을 수 있기 때문이다).
- 기존 Ed25519 목적지는 이미 과거에 네트워크에 노출되었으며, 악의적인 floodfills가 이미 이를 열거했을 것으로 가정해야 한다.

**중요**: 이 보안 약화가 우려되는 사용자는 Ed25519(서명 유형 7) 대신 자신의 Destinations(I2P의 공개 목적지 식별자)에 대한 sigtype으로 Red25519(서명 유형 11)를 사용해야 합니다.

위의 논증은 재무작위화 스칼라 alpha에는 적용되지 않는다는 점에 유의하라. 편향된 alpha를 선택할 때마다 키에 관한 정보가 누출되는데, 이는 가법 재무작위화가 원타임 패드처럼 동작하기 때문이다.

### 보안 감사 상태

**중요한 고지**: Red25519(서명 체계)를 포함한 I2P는 정식 제3자 보안 감사를 받은 적이 없습니다. 기반이 되는 RedDSA(서명 설계)는 2018년 Zcash Sapling 프로토콜 감사의 일환으로 NCC Group의 보안 검토를 받았으며, 그 과정에서 보안 문제가 식별되어 수정되었습니다. 그러나 SHA-512(BLAKE2b-512 대신)를 사용한 I2P의 구체적 구현과 I2P 도메인 분리(domain separation)는 독립적으로 분석된 바 없습니다.

str4d가 개발한 ed25519-java 참조 구현은 독립적인 제3자 감사를 한 차례 받았으나, 그 감사는 Red25519 구현 이전에 이루어졌고 Ed25519 기능만을 대상으로 했으며 Red25519 확장 기능은 포함하지 않았습니다.

Red25519(암호학적 서명 방식)을 도입하는 사용자들은 이러한 한계를 이해하고 자신의 위협 모델에 따라 보안상의 절충관계를 평가해야 합니다.

## 호환성

Red25519(서명 알고리즘)을 지원하는 I2P 버전(0.9.39 이상)은 그 방식으로 서명된 네트워크 데이터 구조를 검증할 수 있습니다. Red25519을 지원하지 않는 I2P 버전은 이를 알 수 없는 서명으로 간주하며, 데이터 구조를 폐기(MAY)할 수도 있습니다.

**배포 타임라인**: - **0.9.39** (2019년 3월): floodfill에서 Encrypted LS2(암호화된 LS2) 지원을 포함한 최초 구현 - **0.9.40** (2019년 5월): Encrypted LS2에 대한 클라이언트별 인가 - **0.9.41** (2019년 8월): 오프라인 키와 함께 사용하는 Meta LS2(메타 LS2) 및 Encrypted LS2 - **0.9.43** (2020년 2월): Encrypted LS2에 대한 b32(base32 주소) 지원 - **0.9.47** (2020년 8월): 사양 최종화 - **2.10.0** (2025년 10월): 현재 네트워크 버전(0.9.67+와 동등)

초기 구현 이후 네트워크가 6년이 넘는 기간 동안 업그레이드를 진행해 온 만큼, Encrypted LeaseSet2 사용 사례에서는 Red25519(서명 방식)로 서명된 데이터 구조의 신뢰성이 충분히 좋을 것으로 사용자는 기대할 수 있습니다. 그러나 일반적인 Destination(I2P 목적지) 사용에 대한 채택 지표는 공개되어 있지 않습니다.

**주요 사용 사례**: Red25519는 key blinding(키 블라인딩: 공개키를 눈가림하여 연관성을 숨기는 기법)이 필요한 암호화된 LeaseSet2 기능에 주로 사용됩니다. 암호화된 leaseset 요구사항이 없는 표준 목적지의 경우, 더 넓은 호환성과 더 오래 검증된 이력 때문에 Ed25519(서명 유형 7)가 여전히 권장되는 선택입니다.

## 구현 참고 사항

Red25519는 I2P Java router의 `net.i2p.crypto.eddsa.RedDSAEngine`에 구현되어 있으며, str4d(Jack Grigg)이 만든 ed25519-java 라이브러리를 Maven 의존성 `net.i2p.crypto:eddsa`(버전 0.1.0부터 0.3.0까지)로 사용합니다.

i2pd C++ 구현은 암호화된 LeaseSet 게시를 위해 Red25519(서명 알고리즘의 한 종류) (signaturetype=11)도 지원합니다.

i2pd용 구성 예제:

```
signaturetype=11
i2cp.leaseSetType=5
```
**Encrypted LeaseSet2 호환성**: Encrypted LeaseSet 명세에 따르면 블라인드가 해제된 destination(목적지 식별자)의 서명 공개키는 Ed25519(서명 유형 7) 또는 Red25519(서명 유형 11)여야 합니다. 암호화된 LeaseSet 기능에는 이외의 서명 유형은 지원되지 않습니다.

## 테스트 벡터

다음 테스트 벡터는 구현 검증을 위해 제공됩니다. 각 벡터에는 다음이 포함됩니다:

- `edsk`: Ed25519 개인 키(무작위)
- `edpk`: edsk에 대응하는 Ed25519 공개 키
- `sk`: CONVERT_ED25519_PRIVATE(edsk)
- `vk`: CONVERT_ED25519_PUBLIC(edpk)
- `msg`: 서명할 메시지
- `sig`: SIGN(sk, msg)
- `alpha`: GENERATE_RANDOM()
- `rsk`: RANDOMIZE_PRIVATE(sk, alpha)
- `rvk`: RANDOMIZE_PUBLIC(vk, alpha)
- `rsig`: SIGN(rsk, msg)

**구현 참고**: 이 테스트 벡터는 지속적인 검증을 위해 자동화된 단위 테스트 스위트에 통합되어야 합니다. 구현자는 모든 변환, 서명, 그리고 re-randomization(재무작위화) 작업이 이러한 기대값과 일치하는지 확인해야 합니다.

### 테스트 벡터 1

```
edsk:  0101010101010101010101010101010101010101010101010101010101010101
edpk:  8a88e3dd7409f195fd52db2d3cba5d72ca6709bf1d94121bf3748801b40f6f5c
sk:    58e86efb75fa4e2c410f46e16de9f6acae1a1703528651b69bc176c088bef36e
vk:    8a88e3dd7409f195fd52db2d3cba5d72ca6709bf1d94121bf3748801b40f6f5c
msg:   0202020202020202020202020202020202020202020202020202020202020202
sig:   61f5527f4d3b46de4b2c234390370bf715ae9098907a0d191ba1b44b23a8ac1a
       6a40437a5294e9503faaf9bd2b7f2fe7ba44dec487b3185aba7ff7d7a17cd40f
alpha: ae9ba9cbbc047c442448fca7c9f4e288a202ed520bfad0c784b792b7773cee08
rsk:   8bb85f3c7a494a08890d7d142109c1a3501d04565d80227e2079097800fbe107
rvk:   6fe128737b8e76fa66698a748b0dc0a89168dd8a0601c2b1c0b26835d323e9b3
rsig:  533053074d3b44f08723aab988ede9880a001b7a684d4a98f2d1b88fabee07a5
       b5c9430c69a690321e0cb8365d7aeb6688bcbad2c0780e0c69e8a1b4a45f3001
```
### 테스트 벡터 2

```
edsk:  0202020202020202020202020202020202020202020202020202020202020202
edpk:  8139770ea87d175f56a35466c34c7ecccb8d8a91b4ee37a25df60f5b8fc9b394
sk:    a83c626bc9c38c8c201878ebb1d5b0b50ac40e8986c78793db1d4ef369fca14e
vk:    8139770ea87d175f56a35466c34c7ecccb8d8a91b4ee37a25df60f5b8fc9b394
msg:   0303030303030303030303030303030303030303030303030303030303030303
sig:   0829e58eb5399870f009bd1f0270264e556424bda7a93fbcec99f6d9d75db46d
       5c3cb546d9947ca7c1200876c8775a90c357a2aef3d2f16388242ee1914b1a0a
alpha: 98b615d9027e996cc2796c019d9c8beb46aa7d2b6eea2e5d98eb29eb1584c203
rsk:   9fcfaa734852ca40b3810ebef590e138516e8cb4f4b1b6f0730978de7f806402
rvk:   527e121090158419609e4a0d8de6f7d3271b353a8cd0b8172fe41468ea1e9177
rsig:  9a6961f35ed264a946cd6214b2326a6e6caa426c2a61bc14367fd278e0b5fb51
       3ac065a69210a457f17d12ba8a496cfd835002691affa8efcdecae48135c090f
```
**참고**: 추가 테스트 벡터 3-10은 동일한 형식을 따르며 레퍼런스 구현에서 확인할 수 있습니다.

## 참고자료

- [제안 123: 새로운 netDB 항목](/proposals/123-new-netdb-entries/) - 일부는 0.9.38, 0.9.39 및 이후 릴리스에 구현되어 배포됨
- [Zcash 프로토콜 명세, 5.4.6절: RedDSA(디지털 서명 체계), RedJubjub, 및 RedPallas](https://zips.z.cash/protocol/protocol.pdf) - RedDSA는 Zcash 프로토콜 명세의 일부로 정의됨; NCC Group에서 보안 감사(2019년 1월)
- [RFC 8032: 에드워즈 곡선 디지털 서명 알고리즘 (EdDSA)](https://www.rfc-editor.org/rfc/rfc8032.html)
- [제안 148: RedDSA-BLAKE2b-Ed25519](/proposals/148-eddsa-blake2b-ed25519/) - 제안되었으나 아직 구현되지 않음; 향후 BLAKE2b-512로의 마이그레이션을 제안
- [암호화된 LeaseSet 명세](/docs/specs/encryptedleaseset/)
- [저수준 암호화 명세](/docs/specs/cryptography/)
