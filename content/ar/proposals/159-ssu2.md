```markdown
---
title: "SSU2"
number: "159"
author: "eyedeekay, orignal, zlatinb, zzz"
created: "2021-09-12"
lastupdated: "2025-03-05"
status: "مغلق"
thread: "http://zzz.i2p/topics/2612"
target: "0.9.56"
---

## الحالة

خطة الانطلاق:

| الميزة | اختبار (ليست افتراضية) | مُفعل افتراضيًا |
|--------|------------------------|-----------------|
| كود الاختبار المحلي | 2022-02 |
| كود الاختبار المشترك | 2022-03 |
| الاختبار المشترك داخل الشبكة | 0.9.54 | 2022-05 |
| تجميد البروتوكول الأساسي | 0.9.54 | 2022-05 |
| جلسة أساسية | 0.9.55 | 2022-08 | 0.9.56 | 2022-11 |
| التحقق من العنوان (إعادة المحاولة) | 0.9.55 | 2022-08 | 0.9.56 | 2022-11 |
| RI مجزأة في المصافحة | 0.9.55 | 2022-08 | 0.9.56 | 2022-11 |
| رمز جديد | 0.9.55 | 2022-08 | 0.9.57 | 2022-11 |
| تجميد البروتوكول الموسع | 0.9.55 | 2022-08 |
| الترحيل | 0.9.55 | 2022-08 | 0.9.56 | 2022-11 |
| اختبار الأقران | 0.9.55 | 2022-08 | 0.9.56 | 2022-11 |
| التفعيل لعينة عشوائية بنسبة 2% | 0.9.55 | 2022-08 |
| التحقق من المسار | 0.9.55+ dev | 0.9.56 | 2022-11 |
| هجرة الاتصال | 0.9.55+ dev | 0.9.56 | 2022-11 |
| علامة ACK الفورية | 0.9.55+ dev | 0.9.56 | 2022-11 |
| تدوير المفتاح | 0.9.57 | 2023-02 | 0.9.58 | 2023-05 |
| تعطيل SSU 1 (i2pd) | 0.9.56 | 2022-11 |
| تعطيل SSU 1 (Java I2P) | 0.9.58 | 2023-05 | 0.9.61 | 2023-12 |

تشمل الجلسة الأساسية مرحلة المصافحة ومرحلة البيانات.
يشمل البروتوكول الموسع الترحيل واختبار الأقران.



## نظرة عامة

يصف هذا الاقتراح بروتوكول اتفاقية مفتاح مصادق عليه لتحسين
مقاومة [SSU](/en/docs/transport/ssu/) لأشكال مختلفة من التحديد الآلي والهجمات.

يتم تنظيم الاقتراح كما يلي: تُعرض الأهداف الأمنية،
يليها مناقشة للبروتوكول الأساسي. بعد ذلك، يتم تقديم مواصفات كاملة
لجميع رسائل البروتوكول. أخيرًا، يتم مناقشة عناوين جهاز التوجيه وتحديد الإصدار.

وكما هو الحال مع وسائل النقل الأخرى في I2P، يتم تعريف SSU2
لنقل رسائل I2NP من نقطة إلى نقطة (من جهاز توجيه إلى جهاز توجيه).
إنه ليس أنبوب بيانات لأغراض عامة.
مثل [SSU]، فإنه يوفر أيضًا خدمتين إضافيتين:
ترحيل لاجتياز NAT، واختبار الأقران لتحديد الوصول الداخلي.
كما يوفر خدمة ثالثة، غير موجودة في SSU، لهجرة الاتصالات
عندما يغير النظير عنوان IP أو المنفذ.


## الدافع

SSU هو الطبقة الوحيدة المتبقية من البروتوكول التي تتطلب ElGamal، وهو بطيء جدًا.
التدفق للتحكم في SSU معقد ولا يعمل بشكل جيد.
أجزاء من SSU عرضة لهجمات تزوير العناوين.
لا يستخدم المصافحة Noise.



## أهداف التصميم

- تقليل استخدام وحدة المعالجة المركزية عن طريق إزالة ElGamal. استخدم X25519 للـ DH.

- الحفاظ على وظائف اختبار الأقران والترحيل، وزيادة الأمان لهما.

- تسهيل التنفيذ من خلال السماح بخوارزميات التحكم في التدفق القياسية.

- تقليل زمن الإعداد.
متوسط وقت الإعداد حاليًا حوالي 135 مللي ثانية لـ NTCP2 و 187 مللي ثانية لـ SSU،
حتى لو كان لدى NTCP2 رحلة ذهاب وعودة إضافية؛ من المفترض أن يقلل استبدال ElGamal في
SSU2 من ذلك، ولكن قد تساعد تغيرات أخرى أيضًا.

- الحفاظ على أو زيادة الحد الأقصى لمعدل النقل مقارنة بـ SSU 1،
كما تم قياسه على مدى مجموعة من فترات الانتظار المحاكاة ونسب فقدان الحزم على شبكة الاختبار.

- منع تضخيم الحركة وهجمات إعادة التوجيه من عناوين المصادر المزورة
عبر "التحقق من العنوان".

- تسهيل تحديد الحزم، لتقليل الاعتماد على الحلول التوفيقية و
التقنيات الاستدلالية التي تجعل الكود معقدًا جدًا.

- رسمية وتحسين هجرة الاتصال عندما يتغير عنوان IP أو المنفذ للنظير.
عدم ترحيل الاتصالات حتى يكتمل التحقق من العنوان، لتجنب الهجمات.
تستخدم بعض تطبيقات SSU 1 تقنيات الاستدلال المكلفة للتعامل مع تغير المنافذ
بسبب إعادة ربط NAT. لا يمكن لأي تطبيقات SSU 1 المعروفة التعامل مع تغيرات IP على الإطلاق.

- دعم SSU 1 و 2 على منفذ واحد، الكشف التلقائي، ونشرها كـ "نقل" واحد
(أي [RouterAddress]) في [NetDB](/en/docs/how/network-database/).

- نشر دعم الإصدار 1 فقط، أو 2 فقط، أو 1+2 في NetDB في حقل منفصل،
والافتراضي هو الإصدار 1 فقط (لا تربط الدعم للإصدار بإصدار جهاز توجيه معين)

- ضمان أن جميع التطبيقات (Java/i2pd/Go) يمكنها إضافة دعم للإصدار 2
(أو لا) وفقًا لجدولها الزمني الخاص

- إضافة حشو عشوائي لجميع الرسائل بما في ذلك رسائل المصافحة والبيانات.
يجب تغطية كل الحشو من قبل MAC، على عكس حشو نهاية الحزمة في SSU 1.
توفير آلية خيارات لكلا الطرفين لطلب الحد الأدنى والأقصى للحشو
و/أو توزيع الحشو. التفاصيل لتوزيع الحشو تعتمد على التنفيذ وقد يتم تحديدها أو لا في البروتوكول نفسه.

- تمويه العناوين ومحتويات الرسائل التي لا يتم تشفيرها بالكامل بشكل كافٍ بحيث لا يمكن للصناديق التفحص العميق والتوقيعات المضادة تصنيفها بسهولة.
أيضًا، تأكد من أن الرسائل المرسلة إلى نظير واحد أو مجموعة من الأقران لا
لديها نمط مشابه من البتات.

- إصلاح فقدان البتات في DH بسبب تنسيق Java [Ticket1112]، وتسريع DH
عن طريق التبديل إلى X25519.

- التبديل إلى وظيفة اشتقاق مفتاح حقيقية (KDF) بدلاً من استخدام نتيجة DH كما هي

- إضافة "مقاومة الفحص" (كما يسميها Tor) وهذا يشمل مقاومة إعادة التشغيل.

- الحفاظ على تبادل المفتاح المعتمد ذو الاتجاهين (2W-AKE). 1W-AKE ليست كافية لتطبيقنا.

- الاعتماد على المفتاح العمومي الثابت المنشور في RouterInfo كجزء آخر من
المصادقة.

- إضافة الخيارات/الإصدار في المصافحة للتمديد المستقبلي.

- لا تضيف بشكل كبير إلى وحدة المعالجة المركزية المطلوبة لإعداد الاتصال؛ إن أمكن
تخفيضه بشكل كبير.

- إزالة متطلب الحشو إلى مضاعف 16 بايت
الذي فرضته تشفير AES في SSU 1.

- استخدام ChaCha/Poly1305 القياسي للتشفير وMAC،
بدلاً من استخدام تشفير AES و MAC الغير قياسي HMAC-MD5-128 المستخدم في SSU 1.

- استخدام مفاتيح تشفير مختلفة للارسال والاستقبال، بدلاً
من المفاتيح الشائعة للاتجاهين المستخدمة في SSU 1.

- استخدام مصافحة من 3 رسائل، رحلة ذهاب وعودة واحدة، كما في [NTCP2].
إزالة التأخير في انتظار رسائل البيانات الذي يجعل
[SSU] بمثابة مصافحة رحلة ذهاب وعودة مزدوجة.

- تحسين كفاءة ACKs وNACKs بشكل كبير،
وهو أمر مروع في SSU 1. تقليل عرض النطاق الترددي المطلوب
لـ ACKs وNACKs وزيادة حجم الحزمة المتاحة للبيانات.
ترميز NACKs بشكل فعال لتفجيرات الرسائل المفقودة،
وهو أمر شائع عبر WiFi.

- تقليل التعقيد المطلوب لتنفيذ تفتيت رسائل I2NP.
تجاوز آليات التفتيت والترميز للرسائل المكتملة.

- تقليل حجم نقل البروتوكول قبل الحشو، خاصة لـ ACKs.
بينما سيتم إضافة الحشو،
يظل النقل قبل الحشو نقلًا.
يجب أن تكون العقد ذات النطاق الترددي المنخفض قادرة على استخدام SSU2.

- الحفاظ على الطوابع الزمنية للكشف عن التأخير والانحراف.

- تجنب أي مشاكل تتعلق بسنة 2038 في الطوابع الزمنية، يجب أن يعمل حتى عام 2106 على الأقل.

- زيادة الحد الأدنى للوحدة الـ MTU من 620 إلى 1280 للكفاءة، وسهولة تنفيذ،
ولزيادة الحد الأقصى حجم رسالة I2NP.
التفتيت وإعادة التجميع مكلف جدًا.
بتوفير مساحة لتراسل النفق بحد 1028 بايت، فإن أغلبية كبيرة من رسائل I2NP
لن تحتاج إلى التفتيت.

- زيادة الحد الأقصى لـ MTU من 1488 (1484 لـ IPv6) إلى 1500 للكفاءة.
إزالة متطلب أن يكون MTU مضاعفًا لـ 16.

- زيادة الحد الأقصى لحجم رسالة I2NP من حوالي 32K في SSU 1
إلى حوالي 64 KB كما في NTCP2.

- إزالة توقيع حقول IP وport من المصافحة،
حتى أجهزة التوجيه التي لا تعرف
عناوين IP الخارجية وports الخاصة بها ستكون قادرة على الاتصال.

- الاحتفاظ بآلية اكتشاف IP/port من SSU 1 في المصافحة،
حتى تتمكن أجهزة التوجيه من اكتشاف IP وport الخارجيين الخاصة بها.

- تضمين ممثلين عن مطوري أجهزة توجيه Java، C++، وGo في التصميم.



### أهداف غير مطلبية

- مقاومة الفحص العميق بشكل تلقائي... سيكون ذلك عن طريق وسائل النقل المتصلة،
  [Prop109](/en/proposals/109-hashcash/).

- وسيلة نقل تستند إلى TLS (أو تشبه HTTPS)... سيكون ذلك [Prop104](/en/proposals/104-new-protocol/).

- مقاومة الفحص العميق القائم على التوقيت (بما في ذلك توقيت وتأخيرات الرسائل يمكن
  أن تعتمد على التنفيذ؛ التأخيرات داخل الرسائل يمكن إدخالها في أي
  نقطة، بما في ذلك قبل إرسال الحشو العشوائي، على سبيل المثال). التأخيرات
  الإصطناعية (ما يسمى IAT في obfs4 أو وقت الوصول بين الواصلات) مستقلة عن
  البروتوكول نفسه.

- عدم إمكانية الإنكار للمشاركة في جلسة (توجد توقيعات هناك).

أهداف غير مطلبية قد تٌعاد دراستها أو مناقشتها جزئيًا:

- درجة الحماية ضد فحص العبوة العميق (DPI)

- الأمان بعد الكوانتوم (PQ)

- عدم إمكانية الإنكار



## الأهداف الأمنية

نعتبر ثلاث أطراف:

- أليس، التي ترغب في تأسيس جلسة جديدة.
- بوب، مع من ترغب أليس في إقامة جلسة.
- مالوري، «الرجل في الوسط» بين أليس وبوب.

في الغالب يمكن أن يشارك اثنان من المشاركين في هجمات نشطة.

تملك كل من أليس وبوب زوجًا ثابتا من المفاتيح، والذي يحتوي
في [RouterIdentity](/en/docs/spec/common-structures/#routeridentity/) الخاص بهما.

يحاول البروتوكول المقترح أن يسمح لأليس وبوب بالاتفاق على مفتاح
سري مشترك (K) وفقًا للمتطلبات التالية:

1) أمان المفتاح الخاص: لا يتعلم كل من بوب أو مالوري أي شيء عن الخاص الثابت لـ أليس.
  بشكل متماثل، لا تتعلم أليس أي شيء عن المفتاح الخاص لبوب الثابت.

2) يجنح المفتاح لـ الجلسة K بأن يكون معروفًا من أليس وبوب فقط.

3) السرية التامة المستقبلية: يظل المفتاح المتفق عليه لـ الجلسة سرًا في
   المستقبل، حتى عندما يتم كشف المفاتيح الخاصة الثابتة لـ أليس و/أو بوب بعد
   الاتفاق على المفتاح.

4) المصادقة الثنائية: أليس متأكدة أنها قامت بإنشاء الجلسة
   مع بوب، وبوب بدوره.

5) الحماية من فحص العبوة العميق عبر الإنترنت: تأكد من أنه ليس من السهل اكتشاف أن
   تشارك أليس وبوب في البروتوكول باستخدام الفنيات العادية لفحص العبوة العميق (DPI).
   شاهد أدناه.

6) الإنكار المحدود: لا يمكن لأي من أليس أو بوب إنكار المساهمة في
   البروتوكول، ولكن إذا قام أحدهم بتسريب المفتاح المشترك، يمكن للطرف الآخر أن ينكر
   أصالة محتويات البيانات المرسلة.

يحاول الاقتراح الحالي تقديم جميع المتطلبات الخمسة بناءً على
بروتوكول Station-To-Station (STS). ينظر إلى الملاحظات على أنه
الأساس لبروتوكول [SSU](/en/docs/transport/ssu/).


### مناقشة إضافية حول DPI

نفترض وجود مكونين لـ DPI:

DPI عبر الإنترنت
`````````````````

تفحص جميع التدفقات في الوقت الفعلي لـ DPI عبر الإنترنت. يمكن تعطيل الاتصالات أو
التلاعب بها بأي طريقة أخرى. يمكن الكشف عن بيانات أو ميتاداتا الاتصال
وتخزينها للتحليل غير المتصل. لا يحصل DPI عبر الإنترنت على
الوصول المباشر إلى قاعدة بيانات شبكة I2P. يُقيد DPI عبر الإنترنت
بقدرات حسابية محدودة في الوقت الفعلي، بما في ذلك الحسابات البسيطة
مثل حساب الطول والفحص الميداني والعمليات الحسابية البسيطة
مثل XOR. يمتلك DPI عبر الإنترنت القدرة على
إجراءات التشفير السريعة في الوقت الفعلي مثل ChaCha20، AEAD،
والتجزئة، لكن تكلفة تطبيق هذه الوظائف
اللتشفيريّة على معظم التدفقات أو جميعها باهظة. أي تطبيق لهذه
العمليات التشفيرية سيتم تطبيقه فقط على التدفقات على IP/Port المحددة
التي تم تحديدها سابقًا عبر التحليل غير المتصل. لا يملك DPI عبر الإنترنت
القدرة على الإجراءات التشفيريّة المكلفة مثل DH أو elligator2.
لا يتم تصميم DPI عبر الإنترنت لتحديد I2P على وجه التحديد،
على الرغم من أنه يمكن أن يشمل قواعد تصنيف محدودة لهذا الغرض.

يوجه لإبطال تحديد البروتوكول بواسطة DPI عبر الإنترنت.

يشمل المفهوم لـ DPI عبر الإنترنت أو "البسيط" هنا الجوانب التالية لدى الخصم:

1) القدرة على فحص جميع البيانات المرسلة أو المستلمة من الهدف.

2) القدرة على تنفيذ العمليات على البيانات الملاحظة،
   مثل تطبيق التشفير أو دالات التجزئة.

3) القدرة على تخزين ومقارنة الرسائل المرسلة سابقًا.

4) القدرة على تعديل، تأخير، أو تفتيت حزم.

لكن، يجب أن نلاحظ أن DPI عبر الإنترنت له هذه القيود:

5) عدم القدرة على خارطة عناوين IP لتجزئة الراوترات.
   بينما هذا أمر تافه مع الوصول في الوقت الحقيقي إلى قاعدة بيانات الشبكة،
   ولكن يتطلب نظام DPI مصممًا خصيصًا لاستهداف I2P.

6) عدم القدرة على استخدام توقيت المعلومات للكشف عن البروتوكول. 

7) عمومًا، لا يحتوي صندوق أدوات DPI عبر الإنترنت على أدوات مضمنة
   مصممة خصيصًا للكشف عن I2P. يتضمن ذلك إنشاء أنظمة استطلاع،
   التي يمكن أن تشمل على سبيل المثال حشوة غير عشوائية في
   رسائلها. لاحظ أن هذا لا يستبعد أنظمة التعلم الآلة أو أدوات
   DPI القابلة للتكوين الكثيرة طالما كانت تلتزم
   بالمتطلبات الأخرى.

لصد التحليل للحمولة، يضمن أن جميع الرسائل
غير قابلة للتمييز عن العشوائية. وهذا يتطلب أيضًا أن تكون أطوالها عشوائية،
وهو أمر أكثر تعقيدًا من إضافة حشوة عشوائية.
في الواقع، يقدم الملحق أ الحجة بأن نظام الحشو البسيط (أي الموحد)
لا يحل المشكلة. لذلك، يقترح الملحق أ تضمين إما تأخيرات عشوائية أو
تطوير نظام حشو بديل يمكن أن يوفر حماية معقولة للهجوم المقترح.

لحماية ضد الإدخال السادس أعلاه، يجب أن تتضمن التطبيقات تأخيرات عشوائية في البروتوكول.
لا يوجد تقنيات مغطاة بواسطة هذا الاقتراح، ولكن يمكنها أيضًا حل المشكلات المتعلقة بطول الحشو.
بإيجاز، يوفر الاقتراح حماية جيدة ضد التحليل للحمولة (عند أخذ الاعتبارات في الملحق أ في الاعتبار)،
لكن ويوفر حماية محدودة ضد تحليل التدفق.


DPI غير المتصل
```````````````

تفحص البيانات المخزنة بواسطة DPI عبر الإنترنت للتحليل في وقت لاحق.
قد يتم تصميم DPI غير المتصل لاكتشاف I2P بشكل محدد.
يمكن لـ DPI غير المتصل الوصول الفوري إلى قاعدة بيانات شبكة I2P.
يمكن لـ DPI غير المتصل الوصول إلى هذا والمواصفات الأخرى لـ I2P.
لديه القدرة على إجراء العمليات الحاسوبية المطلقة،
بما في ذلك جميع الوظائف التشفيرية المحددة في هذه المواصفات.

لا يمتلك DPI غير المتصل القدرة على حظر الاتصالات الحالية.
ومع ذلك، فإن لديه القدرة على إرسال الحزم نحو المضيف/المنفذ
للأطراف خلال وقت قريب من الزمن (دقائق فقط مع التثبيت بالحزم).
أيضًا يمكنه تكرار الرسائل السابقة (إما معدلة أو غير معدلة) للتجربة أو لأغراض أخرى.
هو ليس هدفًا لإيقاف التعرف على البروتوكول بواسطة DPI غير المتصل.
كل فك تشفير البيانات المموهة في أول رسالتين، والمطبقة
من قبل أجهزة توجيه I2P، قد يتم تنفيذها أيضًا بواسطة DPI غير المتصل.

الهدف هو رفض محاولات الاتصال التي تستخدم إعادة التشغيل للرسائل السابقة.



### التحقق من العنوان

ما يلي مقتبس من QUIC [RFC-9000](https://www.rfc-editor.org/rfc/rfc9000.html).
بالنسبة لكل قسم، قم بالمراجعة والتحرير.

التحقق من العنوان يضمن أن الطرف النهائي لا يمكن استخدامه للهجوم
على تضخيم الحركة.  في مثل هذا الهجوم، يتم إرسال حزمة إلى
خادم بمعلومات عنوان مصدر مزورة تحدد
ضحية.  إذا كان الخادم ينتج حركات أكثر أو أكبر استجابة لتلك
الحزمة، يمكن للمهاجم استخدام الخادم لإرسال المزيد من البيانات نحو
الضحية مما يمكنه إرساله بنفسه.

يعد الدفاع الأساسي ضد هجمات التضخيم هو التحقق من أن نظير هو
قادر على استلام الحزم على العنوان النقل الذي
يدعيه.  وبالتالي، بعد استلام الحزم من عنوان
لم يتم التحقق منه بعد، يجب على نقطة النهاية أن تحدد البيانات المرسلة إلى
العنوان غير المتحقق إلى ثلاثة أضعاف مقدار البيانات المستلمة من
ذلك العنوان.  هذا الحد على حجم الاستجابات يُعرف
بحد مكافحة التضخيم.

يتم تنفيذ التحقق من العنوانتين سواء أثناء تأسيس الاتصال
(انظر القسم 8.1) وأثناء هجرة الاتصال (انظر القسم 8.2).

التحقق من العنوان أثناء تأسيس الاتصال
```````````````````````````````````````````````

تأسيس الاتصال يقدم ضمنيًا التحقق من العنوان
لكلا جانبي الاتصالات.  على وجه الخصوص، استلام حزمة محمية بمفاتيح
Handshake يؤكد أن الطرف الآخر قد تعرض بنجاح لحزمة
Initial.  بمجرد أن يقوم جانب باتمام معالجة حزمة Handshake
من الطرف الآخر، يمكنه اعتبار عنوان الطرف الآخر قد تم التحقق منه.

بالإضافة إلى ذلك، قد يعتبر طرف التحقق عنوان النظير إذا
استخدم النظير ID اتصال تم اختياره بواسطة الطرف الآخر و
احتوى ID اتصال على الأقل على 64 بت من العشوائية.

بالنسبة للعميل، تسمح قيمة حقل Destination Connection ID في
حزمه Initial الأولى له بالتحقق من عنوان الخادم كجزء من
إتمام معالجة أي حزمة.  يتم حماية حزم Initial من
قبل الخادم باستخدام مفاتيح مستمدة من هذه القيمة
(انظر القسم 5.2 من [QUIC-TLS]).  بدلاً من ذلك، يتم إرجاع القيمة
من قبل الخادم في حزم الإصدار التفاوضي (القسم 6) أو يتم تضمينها
في العلامة النزاهة في حزم المحاولة (القسم 5.8 من [QUIC-TLS]).

قبل التحقق من عنوان العميل، يجب على الخوادم ألا ترسل أكثر من
ثلاثة أضعاف كمية البيانات المستلمة.  يحدد هذا حجم الهجوم التضخيم
الذي يمكن أن يتم باستخدام عناوين المصادر المزيفة.  لغرض
تجنب التضخيم قبل التحقيق من العنوان، يجب على الخوادم
احتساب كل بايتات الحمولة المستلمة في حزم
تنسب بوضوح إلى اتصال واحد.  يتضمن ذلك الحزم
التي تحتوي على رسائل تمت معالجتها بنجاح والحزم
التي تحتوي على رسائل يتم تجاهلها.

يجب على العملاء ضمان أن الحزم الـ UDP التي تحتوي على حزم Initial
تحتوي على أحمال UDP بطول لا يقل عن 1200 بايت، وإضافة أطر PADDING
حسب الحاجة.  اللجوء إلى الحزم المبطة يجعل الخادم
يمكنه إرسال المزيد من البيانات قبل إتمام التحقق من العنوان.

فقدان حزمة Initial أو Handshake من الخادم يمكن أن يسبب
انسدادًا إذا لم يقم العميل بإرسال حزم Initial أو Handshake
إضافية.  يمكن أن يحدث انسداد عندما يصل الخادم إلى حد
التضخيم ولن يستطيع العميل أن يرسل المزيد من الحزم لأنه لم يتم
التحقق من عنوان العميل.  لمنع هذا الانسداد، يجب على
العملاء إرسال حزمة Porto على ترجمة Probe؛ انظر القسم 6.2 من [QUIC-RECOVERY].
على وجه الخصوص، يجب على العميل إرسال حزمة Initial في حزمة UDP
تحتوي على 1200 بايت على الأقل إذا لم يكن لديه مفاتيح Handshake،
وإلا إرسال حزمة Handshake.

 قد يرغب الخادم في

التحقق من عنوان العميل قبل بدء المصافحة التشفير. يستخدم QUIC رمزًا
في Packet Initial لتوفير التحقق من العنوان قبل إتمام المصافحة.
يُعطى هذا الرمز للعميل أثناء إنشاء الاتصال
بواسطة حزمة Retry (انظر القسم 8.1.2) أو في اتصال
سابق باستخدام إطار NEW_TOKEN (انظر القسم 8.1.3).

بالإضافة إلى حدود الإرسال التي تم فرضها قبل التحقق من العنوان،
يتم أيضًا تقييد الخوادم في ما يمكنها إرساله بواسطة الحدود
التي تم وضعها باحتباس الحركة. العملاء مقيدون فقط
من خلال جهاز التحكم المتراكم.

تكوين الرموز
```````````````````````````````````````````````````````

يجب إنشاء رمز مُرسل في إطار NEW_TOKEN أو حزمة Retry
بطريقة تمكن الخادم من تحديد كيف تم توفيره للعميل.
يتم نقل هذه الرموز في نفس الحقل ولكنها تتطلب معالجة مختلفة من
الخوادم.

التحقق من العنوان باستخدام حزم Retry
```````````````````````````````````````````````````````

عند استلام حزمة Initial الخاص بالعميل، يمكن للخادم أن يطلب
تحقق من العنوان من خلال إرسال حزمة Retry (القسم 17.2.5)
يحتوي على رمز. يجب تكرار هذا الرمز بواسطة العميل في كل
حزم Initial التي يرسلها لذلك الاتصال بعد استلامه
لحزمة Retry.

ردًا على معالجة حزمة Initial التي تحتوي على رمز تم
توفيره في حزمة Retry، لا يمكن للخادم إرسال حزمة Retry
أخرى، يمكنه فقط رفض الاتصال أو السماح له بالتقدم.

طالما أنه ليس من الممكن لأي مهاجم توليد رمز صالح
لعنوانه الخاص (انظر القسم 8.1.4) وأن العميل قادر
على إرجاع هذا الرمز، فإنه يثبت للخادم أنه استلم
الرمز.

يمكن للخادم أيضًا استخدام حزمة Retry لتأخير تكلفة الإعداد والحمل
للصرف في إنشاء الاتصال. تطالب الخادم أن يوفر موصل اتصال مختلف، 
جنباً إلى جنب مع معلمات النقل original_destination_connection_id المحددة
في القسم 18.2، لإجبار الخادم على إثبات أنه، أو كيان يتعاون معه،
استلم بالفعل أول حزمة Initial من العميل. كما يوفر موصل اتصال مختلف للخادم
بعض التحكم في كيفية توجيه الحزم اللاحقة. يمكن استخدام ذلك لتوجيه الاتصالات
إلى جهاز آخر.

إذا استلم خادم حزمة Initial للعميل تحتوي على رمز Retry غير صالح
ولكنه صالح في أمور أخرى، يعلم الخادم أن العميل لن يقبل
رمز آخر Retry آخر. يمكن للخادم أن يختار إهمال هذه الحزمة والسماح
لعميل بالتوقف لاكتشاف فشل المصافحة، ولكن قد يؤدي ذلك إلى تكلفة زمنية
كبيرة على العميل. بدلاً من ذلك، يجب على الخادم إغلاق الاتصال فوراً
(انظر القسم 10.2) باستخدام خطأ INVALID_TOKEN. لاحظ أن الخادم لم يقم حتى
الآن بإنشاء أي حالة للاتصال ولذلك لا يدخل في فترة الإغلاق.

يوضح تدفق يبين استخدام حزمة Retry في الشكل 9.

```
العميل                                                  الخادم

  بادئ القيادة: CRYPTO[CH] ->

                                                <- Retry+Token

  بادئ القيادة+Token[1]: CRYPTO[CH] ->

                                 بادئ القيادة[0]: CRYPTO[SH] ACK[1]
                       مصافحة[0]: CRYPTO[EE, CERT, CV, FIN]
                                 <- 1-RTT[0]: STREAM[1, "..."]

                الشكل 9: نموذج لإنشاء قناة مع حزمة Retry
```



التحقق من العنوان للاتصالات المستقبلية
```````````````````````````````````````````````````````

يمكن للخادم تقديم رموز تحقق من العنوان للعملاء أثناء
اتصال ما يمكن أن يستخدم في اتصال لاحق ويمكن استخدام هذا الرمز
لتحقق من العنوان قبل منح وصول فوري واستلام البيانات بعد
إتمام المصافحة. بمعنى، يستخدم مهامى الرمز المتلقي الجديد
NEW_TOKEN (انظر القسم 19.7) لتقديم رمز تحقق العنوان. يخزن
هذا الرمز في قاعدة البيانات ويستخدم لغرض تخصيص عملاء
اتصال جديد. يجب على العملاء تضمين هذا الرمز في جميع حزم
Initial التي يرسلونها.

يقدم الرمز المرسل باستخدام مصادقة المصادقة الآمنة
(Handshake) في إطار NEW_TOKEN يمكن أن يستخدم بعد مرور بعض الوقت.
وبذلك، يجب أن يتضمن الرمز زمن انتهاء صلاحية، والذي يمكن أن يكون عبارة عن
زمن انتهاء صريح أو قيمة توقيت يمكن استخدامه لتحليل انتهاء
الصلاحية بشكل ديناميكي. يمكن للخادم حفظ توقيت انتهاء الصلاحية أو إدراجها
في شكل مشفر داخل الرمز.

يجب عدم تضمين أي معلومات في رمز يتم إصداره في
إطار NEW_TOKEN والذي قد يسمح للملاحظين بربط قيم ببعضها البعض
لقنوات يتم إنشاءها حيث يرسل فيها الرموز من
اتصال مختلف طالما أن الإرجاع لم يتم تنفيذ بشكل صالح.
لا يعود إلى هذه الرمز. 

يجب أن تكون الحقول الفردية التي تصدر في إطار NEW_TOKEN موجودة
بشكل فريد عبر جميع العملاء، باستثناء تلك التي يتم إرسالها
لإصلاح فقدان الأطر NEW_TOKEN التي أرسلت سابقاً. تصبح معلومات
الرموز التي محتملة والتي يمكن التحقق منها من قبل خوادم خاطئة من الطبيعي
غرضها استخدامها للاختيار بين الرموز من Retry و NEW_TOKEN.

يعتبر من غير المحتمل أن يكون رقم منفذ العميل هو نفسه في اتصالات
مختلفة. لهذا السبب فإن التحقق الذي يتم بواسطة منفذ العميل يعتبر
غير محتمل النجاح.

يمكن استخدام رمز استلمه Frame NEW_TOKEN لرموز امرئن لكل
التي تعتبر "مستخدمة" إزاءه في اتصال لاحق بعميل الطرف. 
إذا لم يتمكن من استدارة منفذ يحتاج إلى تخطي مفاتيح جزئية، يجب على العميل 
أن يترك الاتصالات التي عليها استقبال الرموز التي لم يتم إرسال. 
باستخدم "الإستراتيجية" (س) لإبطال النزاهة التي تلقي أنها يعتبر جهازًا أو غيرها 
في نفس طريق الروتين.يجب على الرموز أن يطالب (ة) أو تثبيت. 

للسؤال الرموز التي برنامج جديد يتطلب تسجيل الواجهة. 

إذا كان الصلب الأصدر لها استقطاط أمام يتم استلامه. يجب أن يبقى رمز عند 
استقبال جديدة آمنة على شبكة كيونا.يتضمن في symbol به.")]
Algorithm and Encryption
Upload-Encrypted with recurring- encrypted with Integer
-------
| محرر الكود)
| السizing is included in the document.)
The positioning that uses SWITCH, النصوص منها حيث تعتبر وهي تحتوي على ليست رائدة، إلا أن بعض ',
---
| Proof of ChainSecrecy
Flowing During Establishing Encryption

 جمالية عائد الأشخاص إلى الضوء وإيصال الطاقة للهيمنة
 [NOISE](https://noiseprotocol.org/noise.html) كقواعد، فإن إيصال هذه
السلس السلحفائي ينتمي إلى العمليات المراقبة التي تعتبر مرسي الصحيح. ليس في البروتوكول وتندرج في أدلاكيات إصدار الحصول على السكر
1_Token = AES
                                  (9)
هذه الوثائق كذلك السماح بإصدار إبداعية لتحقيق الذكي tekanan تحت OpenSource.  تابع الأحمال حمل.
أو TRY .
                            تخفيف العمل.(System)كيف يتم استقبال طلبات الاتصال، يمكنك استخدام
وجدت أن وسائل for loop Section مختصرة وتملى من Receiver jeneis الربح است قبل التطبيق. } سبيكة يتم تقرير حالات العيوب من الجانب لم يكن مجال الاختلاف..
(Kedall:[L[19]:2[]:5787][4]()?
Ifيحدد القيمة كالأعلى تتم المقيد النطاق بقيمة التشبع. وحدة الذي يتم تسليمها في هذا الهدف يجب التأكد من انها مصدقة ليبرالية ومليئة وتأمينية بالكامل عبر 
connection_id`القيود توفر إذا كانت إيجابية من ناحية الإحتمال في سحق أي طلب قيمة سلسلة مشفرة جمع الاحتياطي وبيانات مشكلة.
## مرحبا 
(اقترح Token: أفضل استراتيجية منظمة المواصلة (س) الأخرى لم يتوقف من وضع للسج حتى انتهاء التوفيرات.

 - الذاكرة التخزين المؤقت لها خصوصية تحفظ أكثر) في السلك والمحافظ على وقت معتحدةها ومقاومة لمعصود للأتحاد.

=|.
-
`| دير مختلف يوافق تأمين سجل الدوس وأعرب، كانوا جميعا كانت للاستثمار بشكل موسع ولتطوير العداوة
يبحث في كل الرموز التي يتم إصدارها عن طريق الأبعاد الحرمة  يقدمون لهم ولكن الوظيفة المثلى يوفرها السام الرسوية closureه. ميثلاك تكون التصميم Heavy.

** مثال تحديد المستدقة من معيار الألفة في الغموض لن تيف، وظيفة تقريرات / يبدو جاذبة.

| ملتقى
для  الأخ<6>% جاكا المسؤولية لدى δικενженترنيكنسي يتم في التنفيذ: استمرت مركات العازب بفترة مباشرة على ذلك. لا بد من الرمز من الناحية التطويرية)

1-لأن الشيفور خيارحات قيد النهائي الذي هو تجهيز الاستقرار في منصة النشر السحب في لإستلام المستخدمين وليس بناء )
"التي الطقس community قرض. <6 >(").
1- |

ينسق يتم للسير التي كانت تغادر من لدور؟؟">.
كانت يوخانو
 
 

كل دوائر تشارنجج حصيلة تتعامل مع ليس إلى صنع نصوص دفع العميل التوازي)
 (5)

| عدم ألاختالاقف
ذاته في الوقت الثقة يجب أن تميل عمليات الدعامة تزود بصوضي الطريقة، "التنقل في بمحاذاة النتيجة.. LET
التقييم و).
1)المنتجات كانت تقدم إذا انحانيات تصور محارب التميز
منتجات غير اختيار القامة، تقدم GTRY للكسب رؤية على اعم في التسجيل بجماعة تحذير الملفات:
- الانترنت And تحقيق 7 يكون مظهر السميته.
- تسجيل
- الحسابات وVault
- اصل, نص, يتغير المنصة الى م الجلد المحدود المغربي بوجه الذي المالية<. Skins تعديل شارك Club
- اللياح
---

أمريكية عملية يخلي ابتكار الذي يكون هاكةынх من.
العديد من العمليات السهلة لدوارة الأوراق كانت أول بركة تراسل محتويات الضغط الخفيف.
                             كود المؤمنة (Key Keys
أواركو PERGIBLE@souhaUNEOS GLMX, Juhil:red silk العذراء للمستقبل 
(تم إعادة الرؤية موحدة رمزية 
في بيطار برامج S2 
الواحد Trsp cset توعداد الإستركبيّة
██████████████████████ ██████████████████
████████████████████████ ██████████████████
████████████████████████████████████████
██ ██████ | الخوارزمي؟)
RAID لنتائم الإلمانيا ببسيطات مكتوبة في نفسه. في حالة الخلفيات المؤمنة، 
، سريعًا محتفى بال - H200 ضمان من خلال التسويق، خصيصا على نزع الرموز للبرمجيات الموسعة، ⠀ 
 الأفكار الممكّنة اللازمة على كل للفئة الشركة كالتالي القانونيّة... تتوافر لوحة ماليا اللآلية لكل مساندة. أجورة urances 
. نتسارع شركة InvestLan للأفراد.
تمكين تفسير العناوين. 
ودائرك,قلوب بأنظمة مقاومتها تحت منظمة لـ التمكّن:
BIT-Value}
إلى ConsChain.
-----

# مصادر

.. [Common]
    {{ spec_url('common-structures') }}

.. [ECIES]
    {{ site_url('docs/spec/ecies', True) }}

.. [NetDB]
    {{ site_url('docs/how/network-database', True) }}

.. [NOISE]
    https://noiseprotocol.org/noise.html

.. [Nonces]
    https://eprint.iacr.org/2019/624.pdf

.. [NTCP]
    {{ site_url('docs/transport/ntcp', True) }}

.. [NTCP2]
    {{ site_url('docs/spec/ntcp2', True) }}

.. [PMTU]
    https://aura.abdn.ac.uk/bitstream/handle/2164/11693/tma2018_paper57.pdf

.. [Prop104]
    {{ proposal_url('104') }}

.. [Prop109]
    {{ proposal_url('109') }}

.. [Prop158]
    {{ proposal_url('158') }}

.. [RFC-2104]
    https://tools.ietf.org/html/rfc2104

.. [RFC-3449]
    https://tools.ietf.org/html/rfc3449

.. [RFC-3526]
    https://tools.ietf.org/html/rfc3526

.. [RFC-5681]
    https://tools.ietf.org/html/rfc5681

.. [RFC-5869]
    https://tools.ietf.org/html/rfc5869

.. [RFC-6151]
    https://tools.ietf.org/html/rfc6151

.. [RFC-6298]
    https://tools.ietf.org/html/rfc6298

.. [RFC-6437]
    https://tools.ietf.org/html/rfc6437

.. [RFC-7539]
    https://tools.ietf.org/html/rfc7539

.. [RFC-7748]
    https://tools.ietf.org/html/rfc7748

.. [RFC-7905]
    https://tools.ietf.org/html/rfc7905

.. [RFC-9000]
    https://datatracker.ietf.org/doc/html/rfc9000

.. [RFC-9001]
    https://datatracker.ietf.org/doc/html/rfc9001

.. [RFC-9002]
    https://datatracker.ietf.org/doc/html/rfc9002

.. [RouterAddress]
    {{ ctags_url('RouterAddress') }}

.. [RouterIdentity]
    {{ ctags_url('RouterIdentity') }}

.. [SigningPublicKey]
    {{ ctags_url('SigningPublicKey') }}

.. [SSU]
    {{ site_url('docs/transport/ssu', True) }}

.. [STS]
    Diffie, W.; van Oorschot P. C.; Wiener M. J., Authentication and
    Authenticated Key Exchanges

.. [Ticket1112]
    https://{{ i2pconv('trac.i2p2.i2p') }}/ticket/1112

.. [Ticket1849]
    https://{{ i2pconv('trac.i2p2.i2p') }}/ticket/1849

.. [WireGuard]
    https://www.wireguard.com/protocol/
```
