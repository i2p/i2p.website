---
title: "تنسيق عامل تصفية الوصول"
description: "صياغة ملفات تصفية التحكم بالوصول لـ tunnel"
slug: "filter-format"
lastUpdated: "2025-10"
accurateFor: "2.10.0"
type: docs
---

تمكّن مرشحات الوصول مشغّلي خوادم I2PTunnel من السماح بالاتصالات الواردة أو رفضها أو تقييدها استنادًا إلى Destination (المعرّف العام في I2P) الخاص بالمصدر ومعدّل الاتصالات الأخيرة. المرشّح عبارة عن ملف نصي بسيط يحتوي على قواعد. يُقرأ الملف من الأعلى إلى الأسفل و**تفوز أول قاعدة مطابقة**.

> تصبح تغييرات تعريف عامل التصفية نافذة المفعول **عند إعادة تشغيل tunnel**. قد تقوم بعض الإصدارات بإعادة قراءة القوائم المعتمدة على الملفات أثناء وقت التشغيل، لكن خطط لإعادة تشغيل tunnel لضمان تطبيق التغييرات.

## تنسيق الملف

- قاعدة واحدة لكل سطر.  
- يتم تجاهل الأسطر الفارغة.  
- الرمز `#` يبدأ تعليقًا يمتد حتى نهاية السطر.  
- تُقيَّم القواعد بالترتيب؛ يُستخدم أول تطابق.

## العتبات

تحدد **العتبة** عدد محاولات الاتصال القادمة من وجهة واحدة المسموح بها ضمن نافذة زمنية منزلقة.

- **عددي:** `N/S` تعني السماح بـ`N` اتصالاً لكل `S` ثانية. مثال: `15/5` يتيح ما يصل إلى 15 اتصالاً كل 5 ثوانٍ. تُرفَض المحاولة `N+1` ضمن النافذة الزمنية.  
- **الكلمات المفتاحية:** `allow` تعني لا يوجد حد. `deny` تعني الرفض دائماً.

## صياغة القواعد

تكون القواعد على النحو التالي:

```
<threshold> <scope> <target>
```
حيث:

- `<threshold>` هو `N/S`، `allow`، أو `deny`  
- `<scope>` هو واحد من `default`، `explicit`، `file`، أو `record` (انظر أدناه)  
- `<target>` يعتمد على النطاق

### القاعدة الافتراضية

يُطبَّق عندما لا تنطبق أي قاعدة أخرى. يُسمَح بقاعدة افتراضية **واحدة** فقط. إذا لم تُحدَّد، يُسمَح بالوجهات غير المعروفة دون قيود.

```
15/5 default
allow default
deny default
```
### قاعدة صريحة

يستهدف وجهة محددة عبر عنوان Base32 (على سبيل المثال `example1.b32.i2p`) أو المفتاح الكامل.

```
15/5 explicit example1.b32.i2p
deny explicit example2.b32.i2p
allow explicit example3.b32.i2p
```
### قاعدة مستندة إلى الملفات

يستهدف **كل** الوجهات المدرجة في ملف خارجي. يحتوي كل سطر على وجهة واحدة؛ تعليقات `#` والأسطر الفارغة مسموح بها.

```
15/5 file /var/i2p/throttled.txt
deny file /var/i2p/blocked.txt
allow file /var/i2p/trusted.txt
```
> ملاحظة تشغيلية: بعض التطبيقات تعيد قراءة قوائم الملفات بشكل دوري. إذا قمت بتحرير قائمة أثناء تشغيل tunnel، فتوقع تأخيراً قصيراً قبل ملاحظة التغييرات. أعد التشغيل لتطبيقها فوراً.

### مسجل (تحكم تدريجي)

يقوم **مسجّل** بمراقبة محاولات الاتصال ويكتب الوجهات التي تتجاوز عتبة معينة إلى ملف. بعد ذلك يمكنك الإشارة إلى ذلك الملف في قاعدة `file` لتطبيق قيود السرعة أو الحظر على المحاولات المستقبلية.

```
# Start permissive
allow default

# Record Destinations exceeding 30 connections in 5 seconds
30/5 record /var/i2p/aggressive.txt

# Apply throttling to recorded Destinations
15/5 file /var/i2p/aggressive.txt
```
> تحقق من دعم المُسجِّل ضمن بنية مشروعك قبل الاعتماد عليه. استخدم قوائم `file` لضمان سلوك مضمون.

## ترتيب التقييم

ضع القواعد المحددة أولاً، ثم العامة. نمط شائع:

1. سماح صريح للنظراء الموثوقين  
2. رفض صريح للمسيئين المعروفين  
3. قوائم سماح/رفض مستندة إلى الملفات  
4. مسجلات للخنق التدريجي  
5. قاعدة افتراضية شاملة

## مثال كامل

```
# Moderate limits by default
30/10 default

# Always allow trusted peers
allow explicit friend1.b32.i2p
allow explicit friend2.b32.i2p

# Block known bad actors
deny file /var/i2p/blocklist.txt

# Throttle aggressive sources
15/5 file /var/i2p/throttle.txt

# Automatically populate the throttle list
60/5 record /var/i2p/throttle.txt
```
## ملاحظات التنفيذ

- يعمل مرشح الوصول على طبقة الـ tunnel، قبل معالجة التطبيقات، مما يسمح برفض حركة المرور المسيئة مبكراً.  
- ضع ملف المرشح في دليل تهيئة I2PTunnel لديك، ثم أعد تشغيل الـ tunnel لتطبيق التغييرات.  
- شارك القوائم المعتمدة على الملفات عبر عدة tunnels إذا كنت تريد سياسة متسقة عبر الخدمات.
