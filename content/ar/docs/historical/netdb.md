---
title: "مناقشة قاعدة بيانات الشبكة"
description: "ملاحظات تاريخية حول floodfill، تجارب Kademlia (خوارزمية جدول التجزئة الموزع)، وتحسينات الضبط المستقبلية لـ netDb"
slug: "netdb"
reviewStatus: "needs-review"
---

> **ملاحظة:** يوجز هذا النقاش المؤرشف الأساليب التاريخية لقاعدة بيانات الشبكة (netDb). راجع [وثائق netDb الرئيسية](/docs/specs/common-structures/) للاطلاع على السلوك الحالي والإرشادات.

## التاريخ

توزَّع netDb الخاصة بـ I2P باستخدام خوارزمية floodfill بسيطة. احتفظت الإصدارات الأولى أيضاً بتنفيذ لـ Kademlia DHT كخيار احتياطي، لكنه ثبت أنه غير موثوق وتم تعطيله تماماً في الإصدار 0.6.1.20. يقوم تصميم floodfill بتمرير إدخال منشور إلى router مشارك، وينتظر التأكيد، ثم يعاود المحاولة مع أقران floodfill الآخرين عند الضرورة. يقوم أقران floodfill ببث رسائل التخزين القادمة من routers غير المشاركة في floodfill إلى كل مشارك آخر في floodfill.

في أواخر عام 2009، أُعيد إدخال عمليات استعلام Kademlia (خوارزمية DHT موزعة) جزئياً لتقليل عبء التخزين على كل floodfill router على حدة.

### مقدمة حول Floodfill

ظهرت Floodfill لأول مرة في الإصدار 0.6.0.4 بينما ظل Kademlia (خوارزمية جدول تجزئة موزع DHT) متاحًا كخيار احتياطي. في ذلك الوقت، جعل فقدان الحزم المرتفع والمسارات المقيّدة من الصعب الحصول على تأكيدات الاستلام من أقرب أربعة أقران، وكان الأمر يتطلّب في كثير من الأحيان عشرات محاولات التخزين الزائدة عن الحاجة. وقدّم الانتقال إلى مجموعة فرعية بنمط floodfill من routers القابلة للوصول من الخارج حلاً عمليًا قصير الأجل.

### إعادة التفكير في Kademlia (بروتوكول جداول التجزئة الموزعة DHT)

شملت بعض البدائل التي أُخذت في الاعتبار:

- تشغيل netDb بوصفه Kademlia DHT (جدول تجزئة موزع Kademlia) يقتصر على routers القابلة للوصول التي تختار المشاركة
- الإبقاء على نموذج floodfill مع قصر المشاركة على routers القادرة والتحقق من التوزيع عبر فحوص عشوائية

تفوقت مقاربة floodfill لأنها أسهل في النشر، ولأن netDb تنقل بيانات وصفية فقط ولا تحمل حمولات المستخدم. معظم الوجهات لا تنشر LeaseSet مطلقاً لأن المرسل عادةً يضمّن LeaseSet الخاصة به داخل garlic messages (رسائل غارليك: رسائل مُجمَّعة ضمن طبقات تشفير متعددة).

## الوضع الحالي (من منظور تاريخي)

تم ضبط خوارزميات netDb لتلبية احتياجات الشبكة، وقد تعاملت تاريخيًا بسلاسة مع بضع مئات من routers. أشارت التقديرات المبكرة إلى أن 3–5 floodfill routers يمكنها دعم نحو 10,000 عُقد.

### حسابات مُحدَّثة (مارس 2008)

```
recvKBps = N * (L + 1) * (1 + F) * (1 + R) * S / T
```
حيث:

- `N`: Routers في الشبكة
- `L`: متوسط عدد وجهات العميل لكل router (يُضاف واحد من أجل `RouterInfo`)
- `F`: نسبة فشل tunnel
- `R`: فترة إعادة بناء tunnel كنسبة من مدة حياة tunnel
- `S`: متوسط حجم إدخال netDb
- `T`: مدة حياة tunnel

باستخدام قيم عام 2008 (`N = 700`, `L = 0.5`, `F = 0.33`, `R = 0.5`, `S = 4 KB`, `T = 10 minutes`) ينتج:

```
recvKBps ≈ 700 * (0.5 + 1) * (1 + 0.33) * (1 + 0.5) * 4 KB / 10m ≈ 28 KBps
```
### هل سيعود Kademlia (خوارزمية جدول التجزئة الموزعة DHT)؟

ناقش المطوّرون إعادة إدخال Kademlia (بروتوكول جدول تجزئة موزّع) في مطلع عام 2007 تقريبًا. وكان التوافق أن سعة floodfill يمكن توسيعها تدريجيًا عند الحاجة، بينما يضيف Kademlia تعقيدًا كبيرًا ومتطلبات موارد إلى مجموعة عُقد router الأساسية. يظل الخيار الاحتياطي خاملاً ما لم تصبح سعة floodfill غير كافية.

### تخطيط سعة Floodfill

إن القبول التلقائي لـ routers من فئة عرض الحزمة `O` ضمن floodfill، رغم أنه مُغرٍ، يعرض النظام لمخاطر سيناريوهات هجمات حجب الخدمة إذا اختارت عقد معادية الانضمام. أشارت تحليلات تاريخية إلى أن حصر مجمع floodfill (على سبيل المثال، 3–5 أقران يتولون التعامل مع نحو ~10K routers) كان أكثر أماناً. وقد استُخدم مشغّلون موثوقون أو خوارزميات استدلالية تلقائية للحفاظ على مجموعة floodfill كافية ولكن مضبوطة.

## قائمة TODO لـ Floodfill (تاريخي)

> يُحتفظ بهذا القسم لأغراض الأرشفة. تغطي صفحة netDb الرئيسية خارطة الطريق الحالية واعتبارات التصميم.

أدت الحوادث التشغيلية، مثل فترة في 13 مارس 2008 كان فيها floodfill router واحد فقط متاحًا، إلى عدة تحسينات قُدِّمت ضمن الإصدارات من 0.6.1.33 إلى 0.7.x، بما في ذلك:

- إضفاء العشوائية على اختيار floodfill لعمليات البحث وتفضيل الأقران سريعي الاستجابة
- عرض مقاييس إضافية لـ floodfill على صفحة "Profiles" في وحدة تحكم الـ router
- تخفيضات تدريجية في حجم إدخالات netDb لخفض استهلاك عرض النطاق الترددي لـ floodfill
- الاشتراك التلقائي لمجموعة فرعية من routers من الفئة `O` استنادًا إلى الأداء المُجمَّع عبر بيانات الملف الشخصي
- تحسين قوائم الحظر، واختيار أقران floodfill، وخوارزميات الاستكشاف

شملت الأفكار المتبقية من تلك الفترة:

- استخدام إحصاءات `dbHistory` لتحسين تصنيف واختيار أقران floodfill
- تحسين سلوك إعادة المحاولة لتجنّب الاتصال المتكرر بالأقران المتعطلة
- الاستفادة من مقاييس زمن الوصول ودرجات التكامل في عملية الاختيار
- اكتشاف floodfill routers المتعطلة والتفاعل معها بسرعة أكبر
- مواصلة تقليل متطلبات الموارد على العُقَد عالية عرض النطاق الترددي وعُقَد floodfill

حتى وقت كتابة هذه الملاحظات، اعتُبرت الشبكة قادرة على الصمود، مع وجود بنية تحتية قائمة للاستجابة بسرعة لـ floodfills معادية أو لهجمات حجب الخدمة التي تستهدف floodfill.

## ملاحظات إضافية

- لطالما أتاحت لوحة تحكم الـ router بيانات ملفات التعريف المحسّنة للمساعدة في تحليل موثوقية floodfill.
- بينما تكهّنت تعليقات سابقة بشأن Kademlia أو مخططات DHT (جدول تجزئة موزّع) البديلة، ظلّت floodfill الخوارزمية الأساسية للشبكات الإنتاجية.
- تركّزت الأبحاث المستقبلية على جعل آليات قبول floodfill قابلة للتكيّف مع تقييد فرص إساءة الاستخدام.
