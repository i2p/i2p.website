---
title: "पोस्ट-क्वांटम क्रिप्टो प्रोटोकॉल"
number: "169"
author: "zzz, orignal, drzed, eyedeekay"
created: "2025-01-21"
lastupdated: "2025-06-12"
status: "खुला"
thread: "http://zzz.i2p/topics/3294"
target: "0.9.80"
---

## अवलोकन

हालांकि उपयुक्त पोस्ट-क्वांटम (PQ) क्रिप्टोग्राफी के लिए शोध और प्रतिस्पर्धा एक दशक से चल रही है, विकल्प हाल ही में स्पष्ट हुए हैं।

हमने 2022 में PQ क्रिप्टो के प्रभावों की जांच शुरू की [FORUM](http://zzz.i2p/topics/3294)।

TLS मानकों ने पिछले दो वर्षों में हाइब्रिड एन्क्रिप्शन समर्थन जोड़ा है और अब यह इंटरनेट पर एन्क्रिप्टेड ट्रैफिक के एक महत्वपूर्ण हिस्से के लिए उपयोग किया जाता है, क्योंकि Chrome और Firefox में समर्थन है [CLOUDFLARE](https://blog.cloudflare.com/pq-2024/)।

NIST ने हाल ही में पोस्ट-क्वांटम क्रिप्टोग्राफी के लिए अनुशंसित एल्गोरिदम को अंतिम रूप दिया और प्रकाशित किया [NIST-PQ](https://www.nist.gov/news-events/news/2024/08/nist-releases-first-3-finalized-post-quantum-encryption-standards)।
कई सामान्य क्रिप्टोग्राफी लाइब्रेरी अब NIST मानकों का समर्थन करती हैं या निकट भविष्य में समर्थन जारी करेंगी।

दोनों [CLOUDFLARE](https://blog.cloudflare.com/pq-2024/) और [NIST-PQ](https://www.nist.gov/news-events/news/2024/08/nist-releases-first-3-finalized-post-quantum-encryption-standards) ने सुझाव दिया है कि माइग्रेशन तुरंत शुरू होना चाहिए।
देखें 2022 NSA PQ FAQ [NSA-PQ](https://media.defense.gov/2022/Sep/07/2003071836/-1/-1/0/CSI_CNSA_2.0_FAQ_.PDF)।
I2P को सुरक्षा और क्रिप्टोग्राफी में अग्रणी होना चाहिए।
अब अनुशंसित एल्गोरिदम को लागू करने का समय है।
हमारे लचीले क्रिप्टो प्रकार और हस्ताक्षर प्रकार प्रणाली का उपयोग करते हुए, हम हाइब्रिड क्रिप्टो के लिए प्रकार जोड़ेंगे, और PQ और हाइब्रिड हस्ताक्षरों के लिए।


## लक्ष्य

- PQ-प्रतिरोधी एल्गोरिदम का चयन करें
- I2P प्रोटोकॉल में PQ-केवल और हाइब्रिड एल्गोरिदम जोड़ें जहाँ उपयुक्त
- कई वेरिएंट परिभाषित करें
- कार्यान्वयन, परीक्षण, विश्लेषण और अनुसंधान के बाद सर्वोत्तम वेरिएंट का चयन करें
- समर्थन को धीरे-धीरे और पूर्ववर्ती संगतता के साथ जोड़ें


## गैर-लक्ष्य

- एक-तरफ़ा (Noise N) एन्क्रिप्शन प्रोटोकॉल को न बदलें
- SHA256 से दूर न जाएं, PQ द्वारा निकट-अवधि में खतरा नहीं
- इस समय अंतिम पसंदीदा वेरिएंट का चयन न करें


## खतरा मॉडल

- OBEP या IBGW पर राउटर, संभवतः मिलीभगत,
  बाद में डिक्रिप्शन के लिए गार्लिक संदेश संग्रहीत कर रहे हैं (फ़ॉरवर्ड सीक्रेसी)
- नेटवर्क पर्यवेक्षक
  बाद में डिक्रिप्शन के लिए परिवहन संदेश संग्रहीत कर रहे हैं (फ़ॉरवर्ड सीक्रेसी)
- RI, LS, स्ट्रीमिंग, डेटाग्राम, या अन्य संरचनाओं के लिए हस्ताक्षर बनाने वाले नेटवर्क प्रतिभागी


## प्रभावित प्रोटोकॉल

हम निम्न प्रोटोकॉल को संशोधित करेंगे, विकास के क्रम में। संपूर्ण रोलआउट संभवतः 2025 के अंत से 2027 के मध्य तक होगा।
नीचे दिए गए प्राथमिकता और रोलआउट अनुभाग में विवरण देखें।

| प्रोटोकॉल / विशेषता | स्थिति |
| ------------------- | ------ |
| हाइब्रिड MLKEM Ratchet और LS | ्वीकृत |
| हाइब्रिड MLKEM NTCP2 | ुछ विव |
| हाइब्रिड MLKEM SSU2 | ुछ विव |
| MLDSA SigTypes 12-14 | ्रस्ता |
| MLDSA Dests | ाइव ने |
| हाइब्रिड SigTypes 15-17 | रारंभि |
| हाइब्रिड डेस्ट्स |  |




## डिज़ाइन

हम NIST FIPS 203 और 204 मानकों का समर्थन करेंगे [FIPS203](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf) [FIPS204](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf)
जो आधारित हैं, लेकिन संगत नहीं हैं,
CRYSTALS-Kyber और CRYSTALS-Dilithium (संस्करण 3.1, 3 और पुराने) के साथ।



### कुंजी विनिमय

हम निम्न प्रोटोकॉल में हाइब्रिड कुंजी विनिमय का समर्थन करेंगे:

| प्रोटो | नोइस प्रक | PQ-केवल समर्थन | हाइब्रिड समर्थ |
| ------ | --------- | -------------- | -------------- |
| NTCP2 | XK | नहीं | हाँ |
| SSU2 | XK | नहीं | हाँ |
| Ratchet | IK | नहीं | हाँ |
| TBM | N | नहीं | नहीं |
| NetDB | N | नहीं | नहीं |


PQ KEM केवल अस्थायी कुंजियाँ प्रदान करता है, और सीधे स्थिर-कुंजी हैंडशेक का समर्थन नहीं करता जैसे कि नोइस XK और IK।

नोइस N दो-तरफ़ा कुंजी विनिमय का उपयोग नहीं करता और इसलिए यह हाइब्रिड एन्क्रिप्शन के लिए उपयुक्त नहीं है।

इसलिए हम केवल NTCP2, SSU2, और Ratchet के लिए हाइब्रिड एन्क्रिप्शन का समर्थन करेंगे।
हम [FIPS203](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf) में तीन ML-KEM वेरिएंट को परिभाषित करेंगे,
कुल 3 नए एन्क्रिप्शन प्रकार।
हाइब्रिड प्रकार केवल X25519 के संयोजन में परिभाषित किए जाएंगे।

नए एन्क्रिप्शन प्रकार हैं:

| प्रकार | को |
| ------ | --- |
| MLKEM512_X25519 | 5 |
| MLKEM768_X25519 | 6 |
| MLKEM1024_X25519 | 7 |


ओवरहेड भारी होगा। विशिष्ट संदेश 1 और 2 आकार (XK और IK के लिए)
वर्तमान में लगभग 100 बाइट्स के आसपास हैं (किसी भी अतिरिक्त पेलोड से पहले)।
यह एल्गोरिदम के आधार पर 8x से 15x तक बढ़ेगा।


### हस्ताक्षर

हम निम्न संरचनाओं में PQ और हाइब्रिड हस्ताक्षरों का समर्थन करेंगे:

| प्रकार | PQ-केवल समर्थन | हाइब्रिड समर्थ |
| ------ | -------------- | -------------- |
| RouterInfo | हाँ | हाँ |
| LeaseSet | हाँ | हाँ |
| Streaming SYN/SYNACK/Close | हाँ | हाँ |
| Repliable Datagrams | हाँ | हाँ |
| Datagram2 (प्रस्ताव 163) | ाँ | ाँ |
| I2CP सत्र संदेश बनाएँ | हाँ | हाँ |
| SU3 फाइलें | हाँ | हाँ |
| X.509 प्रमाणपत्र | हाँ | हाँ |
| Java कीस्टोर्स | हाँ | हाँ |



तो हम PQ-केवल और हाइब्रिड हस्ताक्षरों दोनों का समर्थन करेंगे।
हम [FIPS204](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf) के अनुसार तीन ML-DSA वेरिएंट परिभाषित करेंगे,
Ed25519 के साथ तीन हाइब्रिड वेरिएंट,
और SU3 फाइलों के लिए केवल प्रीहैश के साथ तीन PQ-केवल वेरिएंट,
कुल 9 नए हस्ताक्षर प्रकार।
हाइब्रिड प्रकार केवल Ed25519 के संयोजन में परिभाषित किए जाएंगे।
हम मानक ML-DSA का उपयोग करेंगे, प्री-हैश वेरिएंट (HashML-DSA) को नहीं,
सिवाय SU3 फाइलों के लिए।

हम "हेज्ड" या रैंडमाइज्ड साइनिंग वेरिएंट का उपयोग करेंगे,
"डिटरमिनस्टिक" वेरिएंट नहीं, जैसा [FIPS204](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf) अनुभाग 3.4 में परिभाषित किया गया है।
यह सुनिश्चित करता है कि प्रत्येक हस्ताक्षर अलग है, चाहे वही डेटा हो,
और साइड-चैनल हमलों के खिलाफ अतिरिक्त सुरक्षा प्रदान करता है।
अल्गोरिदम विकल्पों, एन्कोडिंग और संदर्भ सहित,
नीचे दिए गए कार्यान्वयन नोट्स अनुभाग को देखें।

नए हस्ताक्षर प्रकार हैं:

| प्रकार | कोड |
| ------ | --- |
| MLDSA44 | 12 |
| MLDSA65 | 13 |
| MLDSA87 | 14 |
| MLDSA44_EdDSA_SHA512_Ed25519 | 15 |
| MLDSA65_EdDSA_SHA512_Ed25519 | 16 |
| MLDSA87_EdDSA_SHA512_Ed25519 | 17 |
| MLDSA44ph | 18 |
| MLDSA65ph | 19 |
| MLDSA87ph | 20 |


X.509 प्रमाणपत्र और अन्य DER एन्कोडिंग [COMPOSITE-SIGS](https://datatracker.ietf.org/doc/draft-ounsworth-pq-composite-sigs/) में परिभाषित संरचनाओं और OIDs का उपयोग करेंगे।

ओवरहेड महत्वपूर्ण होगा। विशिष्ट Ed25519 डेस्टिनेशन और राउटर पहचान आकार 391 बाइट्स हैं।
ये एल्गोरिदम के आधार पर 3.5x से 6.8x तक बढ़ेंगे।
Ed25519 हस्ताक्षर 64 बाइट्स हैं।
ये एल्गोरिदम के आधार पर 38x से 76x तक बढ़ेंगे।
विशिष्ट हस्ताक्षरित RouterInfo, LeaseSet, पुनरप्राप्य डेटाग्राम, और हस्ताक्षरित स्ट्रीमिंग संदेश लगभग 1KB हैं।
ये एल्गोरिदम के आधार पर 3x से 8x तक बढ़ेंगे।

क्योंकि नए डेस्टिनेशन और राउटर पहचान प्रकार पैडिंग नहीं है,
वे संकुचित नहीं होंगे। डेस्टिनेशन और राउटर पहचान के आकार
जो gzipped-इन-ट्रांज़िट हैं, एल्गोरिदम के आधार पर 12x - 38x तक बढ़ेंगे।

### कानूनी संयोजन

नए डेस्टिनेशन के लिए, हस्ताक्षर प्रकार सभी एन्क्रिप्शन प्रकारों के साथ समर्थित हैं
लीसेसेट में। की प्रमाणपत्र में एन्क्रिप्शन प्रकार को NONE (255) पर सेट करें।

राउटर पहचान के लिए, एलगामल एन्क्रिप्शन प्रकार अमान्य है।
नए हस्ताक्षर प्रकार केवल X25519 (प्रकार 4) एन्क्रिप्शन के साथ समर्थित हैं।
नए एन्क्रिप्शन प्रकार राउटर पते में संकेतित होंगे।
की प्रमाणपत्र में एन्क्रिप्शन प्रकार प्रकार 4 ही रहेगा।

### आवश्यक नई क्रिप्टोग्राफी

- ML-KEM (पूर्व में CRYSTALS-Kyber) [FIPS203](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf)
- ML-DSA (पूर्व में CRYSTALS-Dilithium) [FIPS204](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf)
- SHA3-128 (पूर्व में Keccak-256) [FIPS202]_ केवल SHAKE128 के लिए उपयोग किया गया
- SHA3-256 (पूर्व में Keccak-512) [FIPS202]_
- SHAKE128 और SHAKE256 (SHA3-128 और SHA3-256 के XOF एक्सटेंशन) [FIPS202]_

SHA3-256, SHAKE128, और SHAKE256 के लिए टेस्ट वेक्टर [NIST-VECTORS]_ पर हैं।

ध्यान दें कि जावा के bouncycastle पुस्तकालय सभी उपरोक्त का समर्थन करता है।
C++ लाइब्रेरी का समर्थन OpenSSL 3.5 में है [OPENSSL]_।

### विकल्प

हम FIPS205 (Sphincs+) का समर्थन नहीं करेंगे, यह ML-DSA की तुलना में बहुत धीमा और बड़ा है।
हम आगामी FIPS206 (Falcon) का समर्थन नहीं करेंगे, यह अभी तक मानकीकृत नहीं हुआ है।
हम NTRU या अन्य PQ उम्मीदवारों का समर्थन नहीं करेंगे जो NIST द्वारा मानकीकृत नहीं किए गए।

Rosenpass
``````````

Wireguard (IK) के लिए शुद्ध PQ क्रिप्टो के लिए कुछ रिसर्च [PQ-WIREGUARD]_ है, लेकिन उस पेपर में कई खुली हुई समस्याएं हैं।
बाद में, इस दृष्टिकोण को Rosenpass [Rosenpass]_ [Rosenpass-Whitepaper]_ के रूप में लागू किया गया PQ Wireguard के लिए।

Rosenpass एक शोर KK-जैसे हैंडशेक का उपयोग करता ہے जिसमें प्रेशर्ड क्लासिक McEliece 460896 स्थिर कुंजियाँ होती हैं
(500 KB प्रत्येक) और Kyber-512 (इसका मतलब MLKEM-512) अस्थायी कुंजियाँ।
क्योंकि क्लासिक McEliece चाइफरटेक्स्ट्स केवल 188 बाइट्स हैं, और Kyber-512
सार्वजनिक कुंजियाँ और चाइफरटेक्स्ट्स उचित हैं, दोनों हैंडशेक संदेश एक मानक UDP MTU में फिट होते हैं।
PQ KK हैंडशेक से आउटपुट साझा कुंजी (osk) मानक Wireguard IK हैंडशेक के लिए इनपुट प्रेशर्ड कुंजी (psk) के रूप में उपयोग की जाती है।
इसलिए कुल मिलाकर दो पूर्ण हैंडशेक होते हैं, एक शुद्ध PQ और एक शुद्ध X25519।

हम इस प्रकार से हमारे XK और IK हैंडशेक को प्रतिस्थापित नहीं कर सकते क्योंकि:

- हम KK नहीं कर सकते हैं, बॉब के पास एलीस की स्थिर कुंजी नहीं है
- 500KB स्थिर कुंजियाँ बहुत बड़ी हैं
- हम एक अतिरिक्त राउंड-ट्रिप नहीं चाहते हैं

सफेद कागज में बहुत सी अच्छी जानकारी है, और हम विचारों और प्रेरणा के लिए इसकी समीक्षा करेंगे। TODO।

## विनिर्देश

### सामान्य संरचनाएँ

सामान्य संरचनाओं के दस्तावेज़ में अनुभाग और तालिकाएँ निम्नानुसार अद्यतन करें [COMMON](https://geti2p.net/spec/common-structures):

PublicKey
````````````````

नए सार्वजनिक कुंजी प्रकार हैं:

| प्रकार | सार्वजनिक कुंजी | लंबाई | से |
| ------ | --------------- | ----- | --- |
| MLKEM512_X25519 | 32 | 0.9.xx | प्रस् |
| MLKEM768_X25519 | 32 | 0.9.xx | प्रस् |
| MLKEM1024_X25519 | 32 | 0.9.xx | प्रस् |
| MLKEM512 | 800 | 0.9.xx | प्रस् |
| MLKEM768 | 1184 | 0.9.xx | प्रस् |
| MLKEM1024 | 1568 | 0.9.xx | प्रस् |
| MLKEM512_CT | 768 | 0.9.xx | प्रस् |
| MLKEM768_CT | 1088 | 0.9.xx | प्रस् |
| MLKEM1024_CT | 1568 | 0.9.xx | प्रस् |
| NONE | 0 | 0.9.xx | प्रस् |


हाइब्रिड सार्वजनिक कुंजियाँ X25519 कुंजी हैं।
KEM सार्वजनिक कुंजियाँ अस्थायी PQ कुंजी हैं जो एलीस से बॉब को भेजी जाती हैं।
एन्कोडिंग और बाइट क्रम [FIPS203](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf) में परिभाषित हैं।

MLKEM*_CT कुंजियाँ वास्तव में सार्वजनिक कुंजियाँ नहीं होतीं, वे "सिफरटेक्स्ट" होती हैं जो बॉब से एलीस को शोर हैंडशेक में भेजी जाती हैं।
उन्हें यहाँ सम्पूर्णता के लिए सूचीबद्ध किया गया है।

PrivateKey
````````````````

नए निजी कुंजी प्रकार हैं:

| प्रकार | निजी कुंजी लंबाई | तब से | उपयोग |
| ------ | ---------------- | ----- | ----- |
| MLKEM512_X25519 | 32 | 0.9.xx | प्रस् |
| MLKEM768_X25519 | 32 | 0.9.xx | प्रस् |
| MLKEM1024_X25519 | 32 | 0.9.xx | प्रस् |
| MLKEM512 | 1632 | 0.9.xx | प्रस् |
| MLKEM768 | 2400 | 0.9.xx | प्रस् |
| MLKEM1024 | 3168 | 0.9.xx | प्रस् |


हाइब्रिड निजी कुंजियाँ X25519 कुंजियाँ होती हैं।
KEM निजी कुंजियाँ केवल एलीस के लिए होती हैं।
KEM एन्कोडिंग और बाइट क्रम [FIPS203](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf) में परिभाषित हैं।

SigningPublicKey
````````````````

नए साइनिंग सार्वजनिक कुंजी प्रकार हैं:

| प्रकार | लंबाई (बाइट् | तब स | उपय |
| ------ | ------------ | ---- | --- |
| MLDSA44 | 1312 | 0.9.xx | प्रस् |
| MLDSA65 | 1952 | 0.9.xx | प्रस् |
| MLDSA87 | 2592 | 0.9.xx | प्रस् |
| MLDSA44_EdDSA_SHA512_Ed25519 | 1344 | 0.9.xx | प्रस् |
| MLDSA65_EdDSA_SHA512_Ed25519 | 1984 | 0.9.xx | प्रस् |
| MLDSA87_EdDSA_SHA512_Ed25519 | 2624 | 0.9.xx | प्रस् |
| MLDSA44ph | 1344 | 0.9.xx | केवल |
| MLDSA65ph | 1984 | 0.9.xx | केवल |
| MLDSA87ph | 2624 | 0.9.xx | केवल |


हाइब्रिड साइनिंग सार्वजनिक कुंजियाँ [COMPOSITE-SIGS](https://datatracker.ietf.org/doc/draft-ounsworth-pq-composite-sigs/) के अनुसार Ed25519 कुंजी और PQ कुंजी होती हैं।
एन्कोडिंग और बाइट क्रम [FIPS204](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf) में परिभाषित हैं।

SigningPrivateKey
`````````````````

नए साइनिंग प्राइवेट कुंजी प्रकार हैं:

| प्रकार | लंबाई (बाइट् | तब स | उपय |
| ------ | ------------ | ---- | --- |
| MLDSA44 | 2560 | 0.9.xx | प्रस् |
| MLDSA65 | 4032 | 0.9.xx | प्रस् |
| MLDSA87 | 4896 | 0.9.xx | प्रस् |
| MLDSA44_EdDSA_SHA512_Ed25519 | 2592 | 0.9.xx | प्रस् |
| MLDSA65_EdDSA_SHA512_Ed25519 | 4064 | 0.9.xx | प्रस् |
| MLDSA87_EdDSA_SHA512_Ed25519 | 4928 | 0.9.xx | प्रस् |
| MLDSA44ph | 2592 | 0.9.xx | केवल |
| MLDSA65ph | 4064 | 0.9.xx | केवल |
| MLDSA87ph | 4928 | 0.9.xx | केवल |


हाइब्रिड साइनिंग प्राइवेट कुंजियाँ [COMPOSITE-SIGS](https://datatracker.ietf.org/doc/draft-ounsworth-pq-composite-sigs/) के अनुसार Ed25519 कुंजी और PQ कुंजी होती हैं।
एन्कोडिंग और बाइट क्रम [FIPS204](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf) में परिभाषित हैं।

Signature
``````````

नए हस्ताक्षर प्रकार हैं:

| प्रकार | लंबाई (बाइट् | तब स | उपय |
| ------ | ------------ | ---- | --- |
| MLDSA44 | 2420 | 0.9.xx | प्रस् |
| MLDSA65 | 3309 | 0.9.xx | प्रस् |
| MLDSA87 | 4627 | 0.9.xx | प्रस् |
| MLDSA44_EdDSA_SHA512_Ed25519 | 2484 | 0.9.xx | प्रस् |
| MLDSA65_EdDSA_SHA512_Ed25519 | 3373 | 0.9.xx | प्रस् |
| MLDSA87_EdDSA_SHA512_Ed25519 | 4691 | 0.9.xx | प्रस् |
| MLDSA44ph | 2484 | 0.9.xx | केवल |
| MLDSA65ph | 3373 | 0.9.xx | केवल |
| MLDSA87ph | 4691 | 0.9.xx | केवल |


हाइब्रिड हस्ताक्षर [COMPOSITE-SIGS](https://datatracker.ietf.org/doc/draft-ounsworth-pq-composite-sigs/) के अनुसार Ed25519 हस्ताक्षर और PQ हस्ताक्षर होते हैं।
हाइब्रिड हस्ताक्षरों का सत्यापन दोनों हस्ताक्षरों का सत्यापन कर के किया जाता है, और
यदि एक भी विफल हो तो विफल घोषित किया जाता है।
एन्कोडिंग और बाइट क्रम [FIPS204](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf) में परिभाषित हैं।

Key Certificates
````````````````

नए साइनिंग सार्वजनिक कुंजी प्रकार हैं:

| प्रकार | प्रकार को | कुल सार्वजनिक कुंजी | बाई  त | से |
| ------ | --------- | ------------------- | ------ | --- |
| MLDSA44 | 12 | 1312 | 0.9.xx | प्रस् |
| MLDSA65 | 13 | 1952 | 0.9.xx | प्रस् |
| MLDSA87 | 14 | 2592 | 0.9.xx | प्रस् |
| MLDSA44_EdDSA_SHA512_Ed25519 | 15 | 1344 | 0.9.xx | प्रस् |
| MLDSA65_EdDSA_SHA512_Ed25519 | 16 | 1984 | 0.9.xx | प्रस् |
| MLDSA87_EdDSA_SHA512_Ed25519 | 17 | 2624 | 0.9.xx | प्रस् |
| MLDSA44ph | 18 | n/a | 0.9.xx | केवल |
| MLDSA65ph | 19 | n/a | 0.9.xx | केवल |
| MLDSA87ph | 20 | n/a | 0.9.xx | केवल |




नए क्रिप्टो सार्वजनिक कुंजी प्रकार हैं:

| प्रकार | प्रकार को | कुल सार्वजनिक कुंजी | ंबाई त | से |
| ------ | --------- | ------------------- | ------ | --- |
| MLKEM512_X25519 | 5 | 32 | 0.9.xx | प्रस् |
| MLKEM768_X25519 | 6 | 32 | 0.9.xx | प्रस् |
| MLKEM1024_X25519 | 7 | 32 | 0.9.xx | प्रस् |
| NONE | 255 | 0 | 0.9.xx | प्रस् |



हाइब्रिड कुंजी प्रकार कभी भी की प्रमाणपत्रों में शामिल नहीं किए जाते; केवल लीसेसेट्स में।

हाइब्रिड या PQ हस्ताक्षर प्रकारों के साथ डेस्टिनेशन्स के लिए,
एन्क्रिप्शन प्रकार को NONE (टाइप 255) पर सेट करें,
लेकिन कोई क्रिप्टो कुंजी नहीं होती है, और
पूरा 384-बाइट मुख्य अनुभाग हस्ताक्षर कुंजी के लिए होता है।


डेस्टिनेशन आकार
``````````````````

यहाँ नए डेस्टिनेशन प्रकारों के लिए लंबाइयाँ दी गई हैं।
सभी के लिए एन्क्रिप्शन प्रकार NONE (टाइप 255) है और एन्क्रिप्शन कुंजी लंबाई 0 के रूप में मानी जाती है।
संपूर्ण 384-बाइट अनुभाग हस्ताक्षर सार्वजनिक कुंजी के पहले भाग के लिए उपयोग किया जाता है।
ध्यान दें: यह ECDSA_SHA512_P521
और RSA हस्ताक्षर प्रकारों के लिए विनिर्देश से भिन्न है, जहां हमने डेस्टिनेशन में 256-बाइट एलगामल
कुंजी को बनाए रखा, यद्यपि यह उपयोग नहीं की जाती।

कोई पैडिंग नहीं।
कुल लंबाई 7 + कुल कुंजी लंबाई है।
की प्रमाणपत्र की लंबाई 4 + अतिरिक्त कुंजी लंबाई है।

MLDSA44 के लिए 1319-बाइट डेस्टिनेशन बाइट स्ट्रीम का उदाहरण:

skey[0:383] 5 (932 >> 8) (932 & 0xff) 00 12 00 255 skey[384:1311]



| प्रकार | प्रकार को | कुल सार्वजनिक कुंजी | बाई  म | ्य | िरिक् |
| ------ | --------- | ------------------- | ------ | --- | ----- |
| MLDSA44 | 12 | 1312 | 384 | 928 | 1319 |
| MLDSA65 | 13 | 1952 | 384 | 1568 | 1959 |
| MLDSA87 | 14 | 2592 | 384 | 2208 | 2599 |
| MLDSA44_EdDSA_SHA512_Ed25519 | 15 | 1344 | 384 | 960 | 1351 |
| MLDSA65_EdDSA_SHA512_Ed25519 | 16 | 1984 | 384 | 1600 | 1991 |
| MLDSA87_EdDSA_SHA512_Ed25519 | 17 | 2624 | 384 | 2240 | 2631 |




राउटर पहचान आकार
``````````````````

यहाँ नए डेस्टिनेशन प्रकारों के लिए लंबाइयाँ दी गई हैं।
सभी के लिए एन्क्रिप्शन प्रकार X25519 (टाइप 4) है।
X28819 सार्वजनिक कुंजी के बाद संपूर्ण 352-बाइट अनुभाग हस्ताक्षर सार्वजनिक कुंजी के पहले भाग के लिए उपयोग किया जाता है।
कोई पैडिंग नहीं।
कुल लंबाई 39 + कुल कुंजी लंबाई है।
की प्रमाणपत्र की लंबाई 4 + अतिरिक्त कुंजी लंबाई है।

MLDSA44 के लिए 1351 बाइट राउटर पहचान बाइट स्ट्रीम का उदाहरण:

enckey[0:31] skey[0:351] 5 (960 >> 8) (960 & 0xff) 00 12 00 4 skey[352:1311]



| प्रकार | प्रकार को | कुल सार्वजनिक कुंजी | बाई  म | ्य | िरिक् |
| ------ | --------- | ------------------- | ------ | --- | ----- |
| MLDSA44 | 12 | 1312 | 352 | 960 | 1351 |
| MLDSA65 | 13 | 1952 | 352 | 1600 | 1991 |
| MLDSA87 | 14 | 2592 | 352 | 2240 | 2631 |
| MLDSA44_EdDSA_SHA512_Ed25519 | 15 | 1344 | 352 | 992 | 1383 |
| MLDSA65_EdDSA_SHA512_Ed25519 | 16 | 1984 | 352 | 1632 | 2023 |
| MLDSA87_EdDSA_SHA512_Ed25519 | 17 | 2624 | 352 | 2272 | 2663 |




### हैंडशेक पैटर्न

हैंडशेक [Noise]_ हैंडशेक पैटर्न का उपयोग करते हैं।

निम्न अक्षर मानचित्रण का उपयोग किया गया है:

- e = एक बार का अस्थायी कुंजी
- s = स्थिर कुंजी
- p = संदेश पेलोड
- e1 = एक बार का अस्थायी PQ कुंजी, एलीस से बॉब को भेजा गया
- ekem1 = KEM चाइफरटेक्स्ट, बॉब से एलीस को भेजा गया

हाइब्रिड फॉरवर्ड सिक्यूरिटी (hfs) के लिए XK और IK में निम्नलिखित संशोधन
[Noise-Hybrid]_ अनुभाग 5 के अनुसार निर्दिष्ट हैं:

```dataspec

XK:                       XKhfs:
  <- s                      <- s
  ...                       ...
  -> e, es, p               -> e, es, e1, p
  <- e, ee, p               <- e, ee, ekem1, p
  -> s, se                  -> s, se
  <- p                      <- p
  p ->                      p ->


  IK:                       IKhfs:
  <- s                      <- s
  ...                       ...
  -> e, es, s, ss, p       -> e, es, e1, s, ss, p
  <- tag, e, ee, se, p     <- tag, e, ee, ekem1, se, p
  <- p                     <- p
  p ->                     p ->

  e1 और ekem1 एन्क्रिप्टेड हैं। पैटर्न परिभाषाओं को नीचे देखें।
  नोट: e1 और ekem1 आकार में भिन्न हैं (X25519 के विपरीत)

```

e1 पैटर्न निम्नानुसार परिभाषित है, जैसा कि [Noise-Hybrid]_ अनुभाग 4 में निर्दिष्ट है:

```dataspec

For Alice:
  (encap_key, decap_key) = PQ_KEYGEN()

  // EncryptAndHash(encap_key)
  ciphertext = ENCRYPT(k, n, encap_key, ad)
  n++
  MixHash(ciphertext)

  For Bob:

  // DecryptAndHash(ciphertext)
  encap_key = DECRYPT(k, n, ciphertext, ad)
  n++
  MixHash(ciphertext)


```


ekem1 पैटर्न निम्नानुसार परिभाषित है, जैसा कि [Noise-Hybrid]_ अनुभाग 4 में निर्दिष्ट है:

```dataspec

For Bob:

  (kem_ciphertext, kem_shared_key) = ENCAPS(encap_key)

  // EncryptAndHash(kem_ciphertext)
  ciphertext = ENCRYPT(k, n, kem_ciphertext, ad)
  MixHash(ciphertext)

  // MixKey
  MixKey(kem_shared_key)


  For Alice:

  // DecryptAndHash(ciphertext)
  kem_ciphertext = DECRYPT(k, n, ciphertext, ad)
  MixHash(ciphertext)

  // MixKey
  kem_shared_key = DECAPS(kem_ciphertext, decap_key)
  MixKey(kem_shared_key)


```



### Noise हैंडशेक KDF

Issues
``````

- क्या हमें हैंडशेक हैश फंक्शन बदलना चाहिए? देखें [Choosing-Hash]_।
  SHA256 PQ के प्रति असुरक्षित नहीं है, लेकिन अगर हम हमारे हैश फंक्शन को अपग्रेड करना चाहते हैं, तो यह समय है, जबकि हम अन्य चीजें बदल रहे हैं।
  वर्तमान IETF SSH प्रस्ताव [SSH-HYBRID]_ MLKEM768 का उपयोग करने का है
  SHA256 के साथ, और MLKEM1024 का SHA384 के साथ। उस प्रस्ताव में
  सुरक्षा विचारों की चर्चा शामिल है।
- क्या हमें 0-RTT रैचेट डेटा भेजना रोकना चाहिए (LS के अलावा)?
- क्या हमें 0-RTT डेटा न भेजने पर रैचेट से IK से XK पर स्विच करना चाहिए?


Overview
````````

यह अनुभाग IK और XK प्रोटोकॉल दोनों पर लागू होता है।

हाइब्रिड हैंडशेक [Noise-Hybrid]_ में परिभाषित है।
पहला संदेश, एलीस से बॉब तक, e1, encapsulation कुंजी, से पहले संदेश पेलोड होता है।
इसे एक अतिरिक्त स्थिर कुंजी के रूप में माना जाता है; इसे EncryptAndHash() कॉल करें (एलीस के रूप में)
या DecryptAndHash() (बॉब के रूप में)।
फिर संदेश पेलोड को सामान्य रूप से प्रक्रिया करें।

दूसरा संदेश, बॉब से एलीस तक, ekem1, चाइफरटेक्स्ट, से पहले संदेश पेलोड होता है।
इसे एक अतिरिक्त स्थिर कुंजी के रूप में माना जाता है; इसे EncryptAndHash() कॉल करें (बॉब के रूप में)
या DecryptAndHash() (एलीस के रूप में)।
फिर, kem_shared_key की गणना करें और MixKey(kem_shared_key) कॉल करें।
फिर संदेश पेलोड को सामान्य रूप से प्रक्रिया करें।


Defined ML-KEM Operations
`````````````````````````

हम निम्न फ़ंक्शन को परिभाषित करते हैं जो क्रिप्टोग्राफिक निर्माण ब्लॉकों के अनुरूप होते हैं
[FIPS203](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf) में परिभाषित हैं।

(encap_key, decap_key) = PQ_KEYGEN()
    एलीस एनकैप्सुलेशन और डीकैप्सुलेशन कुंजी बनाती है
    एनकैप्सुलेशन कुंजी संदेश 1 में भेजी जाती है।
    encap_key और decap_key आकार ML-KEM वेरिएंट पर आधारित है।

(ciphertext, kem_shared_key) = ENCAPS(encap_key)
    बॉब चाइफरटेक्स्ट और साझा कुंजी की गणना करता है,
    संदेश 1 में प्राप्त चाइफरटेक्स्ट का उपयोग करते हुए।
    चाइफरटेक्स्ट संदेश 2 में भेजा जाता है।
    चाइफरटेक्स्ट आकार ML-KEM वेरिएंट पर आधारित है।
    kem_shared_key हमेशा 32 बाइट्स का होता है।

kem_shared_key = DECAPS(ciphertext, decap_key)
    एलीस साझा कुंजी की गणना करता है,
    संदेश 2 में प्राप्त चाइफरटेक्स्ट का उपयोग करते हुए।
    kem_shared_key हमेशा 32 बाइट्स का होता है।

ध्यान दें कि दोनों encap_key और चाइफरटेक्स्ट चा चा/पोली के अंदर एन्क्रिप्टेड होते हैं
ब्लॉकों कन शोर हैंडशेक संदेश 1 और 2 में।
वे हैंडशेक प्रक्रिया के हिस्से के रूप में डिक्रिप्ट किए जाएंगे।

kem_shared_key को चेनिंग कुंजी के साथ MixHash() में मिलाया जाता है।
विवरण के लिए नीचे देखें।


Alice KDF for Message 1
`````````````````````````

XK के लिए: 'es' संदेश पैटर्न के बाद और payload से पहले जोड़ें:

अथवा

IK के लिए: 'es' संदेश पैटर्न के बाद और 's' संदेश पैटर्न से पहले जोड़ें:

```text
यह "e1" संदेश पैटर्न है:
  (encap_key, decap_key) = PQ_KEYGEN()

  // EncryptAndHash(encap_key)
  // AEAD पैरामीटर
  k = keydata[32:63]
  n = 0
  ad = h
  ciphertext = ENCRYPT(k, n, encap_key, ad)
  n++

  // MixHash(ciphertext)
  h = SHA256(h || ciphertext)


  "e1" संदेश पैटर्न का अंत।

  नोट: अगले अनुभाग के लिए (payload के लिए XK या स्थिर कुंजी के लिए IK के लिए),
  keydata और chain key एक समान रहती हैं,
  और n अब 1 के बराबर है (गैर-हाइब्रिड के लिए 0 के बजाय)।

```


Bob KDF for Message 1
`````````````````````````

XK के लिए: 'es' संदेश पैटर्न के बाद और payload से पहले जोड़ें:

अथवा

IK के लिए: 'es' संदेश पैटर्न के बाद और 's' संदेश पैटर्न से पहले जोड़ें:

```text
यह "e1" संदेश पैटर्न है:

  // DecryptAndHash(encap_key_section)
  // AEAD पैरामीटर
  k = keydata[32:63]
  n = 0
  ad = h
  encap_key = DECRYPT(k, n, encap_key_section, ad)
  n++

  // MixHash(encap_key_section)
  h = SHA256(h || encap_key_section)

  "e1" संदेश पैटर्न का अंत।

  नोट: अगले अनुभाग के लिए (payload के लिए XK या स्थिर कुंजी के लिए IK के लिए),
  keydata और chain key एक समान रहती हैं,
  और n अब 1 के बराबर है (गैर-हाइब्रिड के लिए 0 के बजाय)।

```


Bob KDF for Message 2
`````````````````````````

XK के लिए: 'ee' संदेश पैटर्न के बाद और payload से पहले जोड़ें:

अथवा

IK के लिए: 'ee' संदेश पैटर्न के बाद और 'se' संदेश पैटर्न से पहले जोड़ें:

```text
यह "ekem1" संदेश पैटर्न है:

  (kem_ciphertext, kem_shared_key) = ENCAPS(encap_key)

  // EncryptAndHash(kem_ciphertext)
  // AEAD पैरामीटर
  k = keydata[32:63]
  n = 0
  ad = h
  ciphertext = ENCRYPT(k, n, kem_ciphertext, ad)

  // MixHash(ciphertext)
  h = SHA256(h || ciphertext)

  // MixKey(kem_shared_key)
  keydata = HKDF(chainKey, kem_shared_key, "", 64)
  chainKey = keydata[0:31]

  "ekem1" संदेश पैटर्न का अंत।

```


Alice KDF for Message 2
`````````````````````````

'ee' संदेश पैटर्न के बाद (और 'ss' संदेश पैटर्न के पहले IK के लिए), जोड़ें:

```text
यह "ekem1" संदेश पैटर्न है:

  // DecryptAndHash(kem_ciphertext_section)
  // AEAD पैरामीटर
  k = keydata[32:63]
  n = 0
  ad = h
  kem_ciphertext = DECRYPT(k, n, kem_ciphertext_section, ad)

  // MixHash(kem_ciphertext_section)
  h = SHA256(h || kem_ciphertext_section)

  // MixKey(kem_shared_key)
  kem_shared_key = DECAPS(kem_ciphertext, decap_key)
  keydata = HKDF(chainKey, kem_shared_key, "", 64)
  chainKey = keydata[0:31]

  "ekem1" संदेश पैटर्न का अंत।

```


KDF for Message 3 (XK only)
```````````````````````````
अपरिवर्तित

KDF for split()
```````````````
अपरिवर्तित



### Ratchet

ECIES-Ratchet विनिर्देश [ECIES](https://geti2p.net/spec/ecies) को निम्नानुसार अद्यतन करें:


Noise पहचानकर्ता
`````````````````

- "Noise_IKhfselg2_25519+MLKEM512_ChaChaPoly_SHA256"
- "Noise_IKhfselg2_25519+MLKEM768_ChaChaPoly_SHA256"
- "Noise_IKhfselg2_25519+MLKEM1024_ChaChaPoly_SHA256"



1 बी) नया सत्र प्रारूप (बाइंडिंग के साथ)
`````````````````````````````````````````

परिवर्तन: वर्तमान रैचेट में स्थिर कुंजी पहले चा चा खंड में शामिल थी,
और पेलोड दूसरे खंड में था।
ML-KEM के साथ, अब तीन खंड हैं।
पहले खंड में एन्क्रिप्टेड PQ सार्वजनिक कुंजी होती है।
दूसरे खंड में स्थिर कुंजी होती है।
तीसरे खंड में पेलोड होता है।

एन्क्रिप्टेड प्रारूप:

```dataspec
+----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  |   नया सत्र अस्थायी सार्वजनिक कुंजी    |
  +             32 बाइट्स                  +
  |     एलिगेटर2 के साथ एन्कोडेड           |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +           ML-KEM encap_key            +
  |       ChaCha20 एन्क्रिप्टेड डेटा         |
  +      (नीचे दी गई तालिका में लंबाई देखें)     +
  |                                       |
  ~                                       ~
  |                                       |
  +----+----+----+----+----+----+----+----+
  |  Poly1305 संदेश प्रमाणीकरण कोड       |
  +    (MAC) encap_key सेक्शन के लिए      +
  |             16 बाइट्स                  |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +           X25519 स्थिर कुंजी           +
  |       ChaCha20 एन्क्रिप्टेड डेटा         |
  +             32 बाइट्स                  +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |  Poly1305 संदेश प्रमाणीकरण कोड        |
  +    (MAC) स्थिर कुंजी सेक्शन के लिए       +
  |             16 बाइट्स                  |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +            पेलोड सेक्शन               +
  |       ChaCha20 एन्क्रिप्टेड डेटा         |
  ~                                       ~
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |  Poly1305 संदेश प्रमाणीकरण कोड       |
  +         (MAC) पेलोड सेक्शन के लिए      +
  |             16 बाइट्स                  |
  +----+----+----+----+----+----+----+----+


```

डिक्रिप्टेड प्रारूप:

```dataspec
पेलोड भाग 1:

  +----+----+----+----+----+----+----+----+
  |                                       |
  +       ML-KEM encap_key                +
  |                                       |
  +      (नीचे दी गई तालिका में लंबाई देखें)     +
  |                                       |
  ~                                       ~
  |                                       |
  +----+----+----+----+----+----+----+----+

  पेलोड भाग 2:

  +----+----+----+----+----+----+----+----+
  |                                       |
  +       X25519 स्थिर कुंजी               +
  |                                       |
  +      (32 बाइट्स)                       +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+

  पेलोड भाग 3:

  +----+----+----+----+----+----+----+----+
  |                                       |
  +            पेलोड सेक्शन               +
  |                                       |
  ~                                       ~
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+

```

आकार:

| प्रकार | प्रकार | ड  X | बाई  Msg | लंबाई  Msg 1 | ्क लंबाई  Msg | डेक लंबाई | PQ कुंज |
| ------ | ------ | ---- | -------- | ------------ | ------------- | --------- | ------- |
| X25519 | 4 | 32 | 96+pl | 64+pl | pl | -- | pl |
| MLKEM512_X25519 | 5 | 32 | 912+pl | 880+pl | 800+pl | 800 | pl |
| MLKEM768_X25519 | 6 | 32 | 1296+pl | 1360+pl | 1184+pl | 1184 | pl |
| MLKEM1024_X25519 | 7 | 32 | 1680+pl | 1648+pl | 1568+pl | 1568 | pl |


ध्यान दें कि पेलोड में एक DateTime ब्लॉक होना चाहिए, इसलिए न्यूनतम पेलोड आकार 7 है।
न्यूनतम संदेश 1 आकार के अनुसार गणना की जा सकती है।

1g) न्यू सेशन रिप्लाई फॉर्मेट
`````````````````````````````

परिवर्तन: वर्तमान रैचेट के लिए पहले चा चा खंड का पेलोड खाली होता है,
और पेलोड दूसरे खंड में होता है।
ML-KEM के साथ, अब तीन खंड हैं।
पहले खंड में एन्क्रिप्टेड PQ चाइफरटेक्स्ट होता है।
दूसरे खंड में खाली पेलोड होता है।
तीसरे खंड में पेलोड होता है।

एन्क्रिप्टेड प्रारूप:

```dataspec
+----+----+----+----+----+----+----+----+
  |       सत्र टैग   8 बाइट्स           |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +        अस्थायी सार्वजनिक कुंजी           +
  |                                       |
  +            32 बाइट्स                   +
  |     एलिगेटर2 के साथ एन्कोडेड           |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  | ChaCha20 एन्क्रिप्टेड ML-KEM चाइपरटेक्स्ट  |
  +      (नीचे दी गई तालिका में लंबाई देखें)     +
  ~                                       ~
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |  Poly1305 संदेश प्रमाणीकरण कोड       |
  +  (MAC) चाइपरटेक्स्ट सेक्शन के लिए      +
  |             16 बाइट्स                  |
  +----+----+----+----+----+----+----+----+
  |  Poly1305 संदेश प्रमाणीकरण कोड       |
  +  (MAC) कुंजी सेक्शन के लिए (कोई डेटा नहीं)  +
  |             16 बाइट्स                  |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +            पेलोड सेक्शन               +
  |       ChaCha20 एन्क्रिप्टेड डेटा         |
  ~                                       ~
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |  Poly1305 संदेश प्रमाणीकरण कोड       |
  +         (MAC) पेलोड सेक्शन के लिए      +
  |             16 बाइट्स                  |
  +----+----+----+----+----+----+----+----+


```

डिक्रिप्टेड प्रारूप:

```dataspec
पेलोड भाग 1:

  +----+----+----+----+----+----+----+----+
  |                                       |
  +       ML-KEM चाइपरटेक्स्ट               +
  |                                       |
  +      (नीचे दी गई तालिका में लंबाई देखें)     +
  |                                       |
  ~                                       ~
  |                                       |
  +----+----+----+----+----+----+----+----+

  पेलोड भाग 2:

  खाली

  पेलोड भाग 3:

  +----+----+----+----+----+----+----+----+
  |                                       |
  +            पेलोड सेक्शन               +
  |                                       |
  ~                                       ~
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+

```

आकार:

| प्रकार | प्रकार | ड  Y | बाई  Msg | लंबाई  Msg 2 | ्क लंबाई  Msg | डेक लंबाई | PQ CT ल |
| ------ | ------ | ---- | -------- | ------------ | ------------- | --------- | ------- |
| X25519 | 4 | 32 | 72+pl | 32+pl | pl | -- | pl |
| MLKEM512_X25519 | 5 | 32 | 856+pl | 816+pl | 768+pl | 768 | pl |
| MLKEM768_X25519 | 6 | 32 | 1176+pl | 1136+pl | 1088+pl | 1088 | pl |
| MLKEM1024_X25519 | 7 | 32 | 1656+pl | 1616+pl | 1568+pl | 1568 | pl |


ध्यान दें कि हालांकि संदेश 2 में सामान्य रूप से गैर-शून्य पेलोड होता है,
रैचेट विनिर्देश [ECIES](https://geti2p.net/spec/ecies) इसे आवश्यक नहीं मानता, इसलिए न्यूनतम पेलोड आकार 0 है।
न्यूनतम संदेश 2 आकार के अनुसार गणना की जा सकती है।

### NTCP2

NTCP2 विनिर्देश [NTCP2](https://geti2p.net/spec/ntcp2) को निम्नानुसार अद्यतन करें:

Noise पहचानकर्ता
`````````````````

- "Noise_XKhfsaesobfse+hs2+hs3_25519+MLKEM512_ChaChaPoly_SHA256"
- "Noise_XKhfsaesobfse+hs2+hs3_25519+MLKEM768_ChaChaPoly_SHA256"
- "Noise_XKhfsaesobfse+hs2+hs3_25519+MLKEM1024_ChaChaPoly_SHA256"


1) सत्र अनुरोध
``````````````````

परिवर्तन: वर्तमान NTCP2 में केवल विकल्प ChaCha खंड में शामिल होते हैं।
ML-KEM के साथ, ChaCha खंड में एन्क्रिप्टेड PQ सार्वजनिक कुंजी भी शामिल होगी।

कच्ची सामग्री:

```dataspec
+----+----+----+----+----+----+----+----+
  |                                       |
  +        RH_B के साथ अस्पष्ट किया गया           +
  |       AES-CBC-256 एन्क्रिप्टेड X         |
  +             (32 बाइट्स)                +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |   ChaChaPoly फ्रेम (MLKEM)            |
  +      (नीचे दी गई तालिका में लंबाई देखें)     +
  |   संदेश 1 के लिए KDF में k परिभाषित है      |
  +   n = 0                               +
  |   संबद्ध डेटा के लिए KDF देखें          |
  ~   n = 0                               ~
  +----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  |   ChaChaPoly फ्रेम (विकल्प)          |
  +         32 बाइट्स                      +
  |   संदेश 1 के लिए KDF में k परिभाषित है      |
  +   n = 0                               +
  |   संबद्ध डेटा के लिए KDF देखें          |
  +----+----+----+----+----+----+----+----+
  |     अनएन्क्रिप्टेड प्रामाणिकता          |
  ~         पैडिंग (वैकल्पिक)           ~
  |     लंबाई विकल्प ब्लॉक में निर्दिष्ट है   |
  +----+----+----+----+----+----+----+----+

  वही जैसा पहले था बस दूसरे ChaChaPoly फ्रेम को जोड़ें

```

अनएन्क्रिप्टेड डेटा (Poly1305 प्रमाणीकरण टैग नहीं दिखाया गया):

```dataspec
+----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  |                   X                   |
  +              (32 बाइट्स)               +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |           ML-KEM encap_key            |
  +      (नीचे दी गई तालिका में लंबाई देखें)     +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |               विकल्प                 |
  +              (16 बाइट्स)               +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |     अनएन्क्रिप्टेड प्रामाणिकता          |
  +         पैडिंग (वैकल्पिक)           +
  |     लंबाई विकल्प ब्लॉक में निर्दिष्ट है   |
  ~               .   .   .               ~
  |                                       |
  +----+----+----+----+----+----+----+----+

```

आकार:

| प्रकार | प्रकार | ड  X | बाई  Msg | लंबाई  Msg 1 | ्क लंबाई  Msg | डेक लंबाई | PQ कुंज |
| ------ | ------ | ---- | -------- | ------------ | ------------- | --------- | ------- |
| X25519 | 4 | 32 | 64+pad | 32 | 16 | -- | 16 |
| MLKEM512_X25519 | 5 | 32 | 880+pad | 848 | 816 | 800 | 16 |
| MLKEM768_X25519 | 6 | 32 | 1264+pad | 1232 | 1200 | 1184 | 16 |
| MLKEM1024_X25519 | 7 | 32 | 1648+pad | 1616 | 1584 | 1568 | 16 |


ध्यान दें: प्रकार कोड केवल आंतरिक उपयोग के लिए होते हैं। राउटर प्रकार 4 में रहेंगे,
और समर्थन राउटर पतों में संकेतित किया जाएगा।

2) सत्र निर्मित
``````````````````

परिवर्तन: वर्तमान NTCP2 में केवल विकल्प ChaCha खंड में शामिल होते हैं।
ML-KEM के साथ, ChaCha खंड में एन्क्रिप्टेड PQ सार्वजनिक कुंजी भी शामिल होगी।

कच्ची सामग्री:

```dataspec
+----+----+----+----+----+----+----+----+
  |                                       |
  +        RH_B के साथ अस्पष्ट किया गया           +
  |       AES-CBC-256 एन्क्रिप्टेड Y         |
  +              (32 बाइट्स)               +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |   ChaChaPoly फ्रेम (MLKEM)            |
  +   एन्क्रिप्टेड और प्रामाणिक डेटा    +
  -      (नीचे दी गई तालिका में लंबाई देखें)     -
  +   संदेश 2 के लिए KDF में k परिभाषित है      +
  |   n = 0; संबद्ध डेटा के लिए KDF देखें  |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |   ChaChaPoly फ्रेम (विकल्प)          |
  +   एन्क्रिप्टेड और प्रामाणिक डेटा    +
  -           32 बाइट्स                    -
  +   संदेश 2 के लिए KDF में k परिभाषित है      +
  |   n = 0; संबद्ध डेटा के लिए KDF देखें  |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |     अनएन्क्रिप्टेड प्रामाणिकता         |
  +         पैडिंग (वैकल्पिक)           +
  |     लंबाई विकल्प ब्लॉक में निर्दिष्ट है   |
  ~               .   .   .               ~
  |                                       |
  +----+----+----+----+----+----+----+----+

  वही जैसा पहले था बस दूसरे ChaChaPoly फ्रेम को जोड़ें

```

अनएन्क्रिप्टेड डेटा (Poly1305 प्रमाणीकरण टैग नहीं दिखाया गया):

```dataspec
+----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  |                  Y                    |
  +              (32 बाइट्स)               +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |           ML-KEM चाइपरटेक्स्ट           |
  +      (नीचे दी गई तालिका में लंबाई देखें)     +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |               विकल्प                 |
  +              (16 बाइट्स)               +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |     अनएन्क्रिप्टेड प्रामाणिकता         |
  +         पैडिंग (वैकल्पिक)           +
  |     लंबाई विकल्प ब्लॉक में निर्दिष्ट है   |
  ~               .   .   .               ~
  |                                       |
  +----+----+----+----+----+----+----+----+

```

आकार:

| प्रकार | प्रकार | ड  Y | बाई  Msg | लंबाई  Msg 2 | ्क लंबाई  Msg | डेक लंबाई | PQ CT ल |
| ------ | ------ | ---- | -------- | ------------ | ------------- | --------- | ------- |
| X25519 | 4 | 32 | 64+pad | 32 | 16 | -- | 16 |
| MLKEM512_X25519 | 5 | 32 | 848+pad | 816 | 784 | 768 | 16 |
| MLKEM768_X25519 | 6 | 32 | 1136+pad | 1104 | 1104 | 1088 | 16 |
| MLKEM1024_X25519 | 7 | 32 | 1616+pad | 1584 | 1584 | 1568 | 16 |


ध्यान दें: प्रकार कोड केवल आंतरिक उपयोग के लिए होते हैं। राउटर प्रकार 4 में रहेंगे,
और समर्थन राउटर पतों में संकेतित किया जाएगा।

3) सत्र की पुष्टि की गई
```````````````````

अपरिवर्तित

Key Derivation Function (KDF) (डेटा चरण के लिए)
``````````````````````````````````````````````

अपरिवर्तित




### SSU2

SSU2 विनिर्देश [SSU2](https://geti2p.net/spec/ssu2) को निम्नानुसार अद्यतन करें:

Noise पहचानकर्ता
`````````````````

- "Noise_XKhfschaobfse+hs1+hs2+hs3_25519+MLKEM512_ChaChaPoly_SHA256"
- "Noise_XKhfschaobfse+hs1+hs2+hs3_25519+MLKEM768_ChaChaPoly_SHA256"
- "Noise_XKhfschaobfse+hs1+hs2+hs3_25519+MLKEM1024_ChaChaPoly_SHA256"

लंबा शीर्षक
`````````````
लंबा शीर्षक 32 बाइट्स का है। इसका उपयोग सत्र के निर्माण से पहले किया जाता है, टोकन अनुरोध, सत्र अनुरोध, सत्र निर्मित, और पुनः प्रयास के लिए।
यह सत्र बाह्य पीयर टेस्ट और होल पंच संदेशों के लिए भी उपयोग किया जाता है।

TODO: हम आंतरिक रूप से संस्करण फ़ील्ड का उपयोग कर सकते हैं और MLKEM512 के लिए 3 और MLKEM768 के लिए 4 का उपयोग कर सकते हैं।
क्या हम इसे केवल प्रकार 0 और 1 के लिए करते हैं या सभी 6 प्रकारों के लिए?


हेडर एन्क्रिप्शन से पहले:

```dataspec

+----+----+----+----+----+----+----+----+
  |      डेस्टिनेशन कनेक्शन आईडी        |
  +----+----+----+----+----+----+----+----+
  |   पैकेट नंबर   |प्रकार| संस्करण| आईडी |फ्लैग|
  +----+----+----+----+----+----+----+----+
  |      स्रोत कनेक्शन आईडी           |
  +----+----+----+----+----+----+----+----+
  |                 टोकन             |
  +----+----+----+----+----+----+----+----+

  डेस्टिनेशन कनेक्शन आईडी :: 8 बाइट्स, असाइन किया गया बड़ा एंडियन पूर्णांक

  पैकेट नंबर :: 4 बाइट्स, असाइन किया गया बड़ा एंडियन पूर्णांक

  प्रकार :: संदेश प्रकार = 0, 1, 7, 9, 10, या 11

  संस्करण :: प्रोटोकॉल संस्करण, 2 के बराबर
         TODO हम आंतरिक रूप से संस्करण फ़ील्ड का उपयोग कर सकते हैं और MLKEM512 के लिए 3 और MLKEM768 के लिए 4 का उपयोग कर सकते हैं।

  आईडी :: 1 बाइट, नेटवर्क आईडी (वर्तमान में 2, परीक्षण नेटवर्क के लिए अपवाद)

  फ्लैग :: 1 बाइट, अप्रयुक्त, भविष्य के संगतता के लिए 0 पर सेट करें

  स्रोत कनेक्शन आईडी :: 8 बाइट्स, असाइन किया गया बड़ा एंडियन पूर्णांक

  टोकन :: 8 बाइट्स, असाइन किया गया बड़ा एंडियन पूर्णांक

```

छोटा हेडर
`````````````
अपरिवर्तित

सत्र अनुरोध (प्रकार 0)
```````````````````````

परिवर्तन: वर्तमान SSU2 में केवल ब्लॉक डेटा ChaCha खंड में शामिल होते हैं।
ML-KEM के साथ, ChaCha खंड में एन्क्रिप्टेड PQ सार्वजनिक कुंजी भी शामिल होगी।

कच्ची सामग्री:

```dataspec
+----+----+----+----+----+----+----+----+
  |  लंबे शीर्षक बाइट्स 0-15, ChaCha20     |
  +  बॉब इंट्रो कुंजी के साथ एन्क्रिप्टेड         +
  |    हेडर एन्क्रिप्शन KDF देखें          |
  +----+----+----+----+----+----+----+----+
  |  लंबे शीर्षक बाइट्स 16-31, ChaCha20    |
  +  बॉब इंट्रो कुंजी n=0 के साथ एन्क्रिप्टेड     +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +       X, ChaCha20 एन्क्रिप्टेड           +
  |       बॉब इंट्रो कुंजी n=0 के साथ        |
  +              (32 बाइट्स)               +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  |   ChaCha20 एन्क्रिप्टेड डेटा (MLKEM)     |
  +          (लंबाई बदलती है)              +
  |  सत्र अनुरोध के लिए KDF में k परिभाषित |
  +  n = 0                                +
  |  संबद्ध डेटा के लिए KDF देखें          |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  |   ChaCha20 एन्क्रिप्टेड डेटा (पेलोड)     |
  +          (लंबाई बदलती है)              +
  |  सत्र अनुरोध के लिए KDF में k परिभाषित |
  +  n = 0                                +
  |  संबद्ध डेटा के लिए KDF देखें          |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +        Poly1305 MAC (16 बाइट्स)        +
  |                                       |
  +----+----+----+----+----+----+----+----+

```

अनएन्क्रिप्टेड डेटा (Poly1305 प्रमाणीकरण टैग नहीं दिखाया गया):

```dataspec
+----+----+----+----+----+----+----+----+
  |      डेस्टिनेशन कनेक्शन आईडी        |
  +----+----+----+----+----+----+----+----+
  |   पैकेट नंबर   |प्रकार| संस्करण| आईडी |फ्लैग|
  +----+----+----+----+----+----+----+----+
  |      स्रोत कनेक्शन आईडी           |
  +----+----+----+----+----+----+----+----+
  |                 टोकन             |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  |                   X                   |
  +              (32 बाइट्स)               +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |           ML-KEM encap_key            |
  +      (नीचे दी गई तालिका में लंबाई देखें)     +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |     नोइस पेलोड (ब्लॉक डेटा)           |
  +          (लंबाई बदलती है)              +
  |     नीचे दिए गए अनुमत ब्लॉकों के लिए देखें      |
  +----+----+----+----+----+----+----+----+

```

आकार, आईपी ओवरहेड को छोड़कर:

================    =========  =====  =========  =============  =============  ==========  =======
  प्रकार              प्रकार कोड
