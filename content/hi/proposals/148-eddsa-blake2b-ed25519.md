---
title: "RedDSA-BLAKE2b-Ed25519"
number: "148"
author: "zzz"
created: "2019-03-12"
lastupdated: "2019-04-11"
status: "Open"
thread: "http://zzz.i2p/topics/2689"
---

## अवलोकन

यह प्रस्ताव SHA-512 की जगह लेने के लिए व्यक्तिगतकरण स्ट्रिंग्स और साल्ट्स के साथ BLAKE2b-512 का उपयोग करके एक नया हस्ताक्षर प्रकार जोड़ता है। इससे संभावित हमलों की तीन श्रेणियों को समाप्त किया जा सकेगा।

## प्रेरणा

NTCP2 (प्रस्ताव 111) और LS2 (प्रस्ताव 123) के चर्चा और डिजाइन के दौरान, हमने संक्षेप में विभिन्न हमलों पर विचार किया जो संभव थे, और उन्हें रोकने के तरीके। इन में से तीन हमले हैं लंबाई विस्तार हमले, इंटर-प्रोटोकॉल हमले, और डुप्लिकेट संदेश पहचान।

NTCP2 और LS2 दोनों के लिए, हमने यह तय किया कि ये हमले प्रस्तावों के लिए सीधे प्रासंगिक नहीं थे, और किसी भी समाधान ने नए प्रिमिटिव्स को न्यूनतम रखने के लक्ष्य के साथ टकराव किया। इसके अलावा, हमने यह निर्धारित किया कि इन प्रोटोकॉल्स में हैश फंक्शंस की गति हमारे निर्णयों में एक महत्वपूर्ण कारक नहीं थी। इसलिए, हमने अधिकांश समाधान को एक अलग प्रस्ताव पर टाल दिया। जबकि हमने LS2 विनिर्देशन में कुछ निजीकरण विशेषताएँ जोड़ीं, हमने किसी नए हैश फंक्शन की आवश्यकता नहीं की।

कई प्रोजेक्ट्स, जैसे ZCash [ZCASH]_, नए एल्गोरिदम पर आधारित हैश फंक्शंस और हस्ताक्षर एल्गोरिदम का उपयोग कर रहे हैं जो निम्नलिखित हमलों के लिए असुरक्षित नहीं हैं।

### लंबाई विस्तार हमले

SHA-256 और SHA-512 लंबाई विस्तार हमलों (LEA) [LEA]_ के लिए असुरक्षित हैं। यह तब होता है जब वास्तविक डेटा की बजाय डेटा का हैश हस्ताक्षरित होता है। अधिकांश I2P प्रोटोकॉल्स (स्ट्रीमिंग, डाटाग्राम्स, नेटडब, और अन्य) में, वास्तविक डेटा हस्ताक्षरित होता है। एक अपवाद SU3 फाइल्स है, जहां हैश हस्ताक्षरित होता है। दूसरा अपवाद डीएसए के लिए हस्ताक्षरित डाटाग्राम (सिग टाइप 0) ही है, जहां हैश हस्ताक्षरित होता है। अन्य हस्ताक्षरित डाटाग्राम सिग टाइप्स के लिए, डेटा हस्ताक्षरित होता है।

### क्रॉस-प्रोटोकॉल हमले

I2P प्रोटोकॉल्स में हस्ताक्षरित डेटा डोमेन विभाजन की कमी के कारण क्रॉस-प्रोटोकॉल हमलों (CPA) के लिए असुरक्षित हो सकता है। यह एक हमलावर को एक संदर्भ में प्राप्त डेटा (जैसे हस्ताक्षरित डाटाग्राम) को दूसरे संदर्भ में वैध, हस्ताक्षरित डेटा के रूप में प्रस्तुत करने की अनुमति देता है (जैसे स्ट्रीमिंग या नेटवर्क डेटाबेस)। जब यह संदर्भ में असंभव है कि एक संदर्भ का हस्ताक्षरित डेटा दूसरे संदर्भ में वैध डेटा के रूप में पार्स किया जाएगा, सभी स्थितियों का विश्लेषण करना कठिन या असंभव है यह सुनिश्चित करने के लिए। इसके अलावा, किसी संदर्भ में, यह संभव हो सकता है कि एक हमलावर एक पीड़ित को विशिष्ट रूप से निर्मित डेटा पर हस्ताक्षर करने के लिए प्रेरित कर सके जो दूसरे संदर्भ में वैध डेटा हो सकता है। फिर से, सभी स्थितियों का विश्लेषण करना कठिन या असंभव है यह सुनिश्चित करने के लिए।

### डुप्लिकेट संदेश पहचान

I2P प्रोटोकॉल्स डुप्लिकेट संदेश पहचान (DMI) के लिए असुरक्षित हो सकते हैं। यह एक हमलावर को पहचान की अनुमति दे सकता है कि दो हस्ताक्षरित संदेशों की सामग्री समान है, भले ही ये संदेश और उनके हस्ताक्षर एनक्रिप्टेड हों। भले ही I2P में इस्तेमाल किए गए एन्क्रिप्शन विधियों के कारण ऐसा नहीं हो सकता है, सभी स्थितियों का विश्लेषण करना कठिन या असंभव है यह सुनिश्चित करने के लिए। एक हैश फंक्शन का उपयोग करके जो एक रैंडम साल्ट जोड़ने की विधि प्रदान करता है, सभी हस्ताक्षर अलग होंगे भले ही एक ही डेटा पर हस्ताक्षर किए गए हों। जबकि प्रस्ताव 123 के रूप में परिभाषित रेड25519 हैश फंक्शन में एक रैंडम साल्ट जोड़ता है, यह समस्या को सुलझाता नहीं है अनएन्क्रिप्टेड लीज सेट्स के लिए।

### गति

जबकि यह प्रस्ताव का प्राथमिक प्रेरणा नहीं है, SHA-512 अपेक्षाकृत धीमा है, और तेज हैश फंक्शंस उपलब्ध हैं।

## लक्ष्य

- उपरोक्त हमलों को रोकें
- नए क्रिप्टो प्रिमिटिव्स के उपयोग को न्यूनतम करें
- प्रमाणित, मानक क्रिप्टो प्रिमिटिव्स का उपयोग करें
- मानक कर्व्स का उपयोग करें
- यदि उपलब्ध हो तो तेज प्रिमिटिव्स का उपयोग करें

## डिज़ाइन

मौजूदा RedDSA_SHA512_Ed25519 हस्ताक्षर प्रकार को SHA-512 के स्थान पर BLAKE2b-512 का उपयोग करने के लिए संशोधित करें। प्रत्येक उपयोग केस के लिए अद्वितीय निजीकरण स्ट्रिंग्स जोड़ें। नया हस्ताक्षर प्रकार अनब्लाइंडेड और ब्लाइंडेड लीज सेट्स दोनों के लिए उपयोग किया जा सकता है।

## न्यायसंगतता

- BLAKE2b LEA के लिए असुरक्षित नहीं है [BLAKE2]_।
- BLAKE2b डोमेन विभाजन के लिए निजीकरण स्ट्रिंग्स जोड़ने के लिए एक मानक तरीका प्रदान करता है
- BLAKE2b DMI को रोकने के लिए एक रैंडम साल्ट जोड़ने का एक मानक तरीका प्रदान करता है।
- BLAKE2b आधुनिक हार्डवेयर पर SHA-256 और SHA-512 (और MD5) से तेज है, [BLAKE2]_ के अनुसार।
- Ed25519 अब भी हमारा सबसे तेज हस्ताक्षर प्रकार है, कम से कम जावा में ECDSA से कहीं तेज।
- Ed25519 [ED25519-REFS]_ के लिए 512 बिट क्रिप्टोग्राफिक हैश फंक्शन की आवश्यकता होती है। यह SHA-512 को निर्दिष्ट नहीं करता है। BLAKE2b हैश फंक्शन के लिए उतना ही उपयुक्त है।
- BLAKE2b कई प्रोग्रामिंग भाषाओं के लिए लाइब्रेरीज़ में व्यापक रूप से उपलब्ध है, जैसे कि Noise।

## विनिर्देशन

साल्ट और निजीकरण के साथ [BLAKE2]_ में बिना कुंजी के BLAKE2b-512 का उपयोग करें। सभी BLAKE2b हस्ताक्षरों के उपयोग के लिए एक 16-अक्षर की निजीकरण स्ट्रिंग का उपयोग किया जाएगा।

जब RedDSA_BLAKE2b_Ed25519 साइनिंग में उपयोग किया जाता है, एक रैंडम साल्ट की अनुमति है, हालाँकि यह आवश्यक नहीं है, क्योंकि हस्ताक्षर एल्गोरिदम 80 बाइट्स का रैंडम डेटा जोड़ता है (प्रस्ताव 123 देखें)। यदि चाहें, तो डेटा को हैश करते समय r की गणना करने के लिए, प्रत्येक हस्ताक्षर के लिए एक नया BLAKE2b 16-बाइट रैंडम साल्ट सेट करें। जब S की गणना करते हैं, तो साल्ट को सभी-शून्य के डिफ़ॉल्ट पर रीसेट करें।

जब RedDSA_BLAKE2b_Ed25519 सत्यापन में उपयोग किया जाता है, तो एक रैंडम साल्ट का उपयोग न करें, डिफ़ॉल्ट सभी-शून्य का उपयोग करें।

साल्ट और निजीकरण विशेषताएँ [RFC-7693]_ में निर्दिष्ट नहीं हैं; उन विशेषताओं का उपयोग [BLAKE2]_ में निर्दिष्ट के रूप में करें।

### हस्ताक्षर प्रकार

RedDSA_BLAKE2b_Ed25519 के लिए, SHA-512 हैश फंक्शन को BLAKE2b-512 के साथ RedDSA_SHA512_Ed25519 (हस्ताक्षर प्रकार 11, जैसा कि प्रस्ताव 123 में परिभाषित है) में प्रतिस्थापित करें। कोई अन्य परिवर्तन नहीं।

हमें SU3 फाइलों के लिए EdDSA_SHA512_Ed25519ph (हस्ताक्षर प्रकार 8) के लिए प्रतिस्थापन की आवश्यकता नहीं है, क्योंकि EdDSA के प्रीहैश्ड संस्करण को LEA के लिए असुरक्षित नहीं माना जाता है। SU3 फाइलों के लिए EdDSA_SHA512_Ed25519 (हस्ताक्षर प्रकार 7) समर्थित नहीं है।

=======================  ===========  ======  =====
        प्रकार             प्रकार कोड    तबसे   उपयोग
=======================  ===========  ======  =====
RedDSA_BLAKE2b_Ed25519       12        TBD    केवल राउटर पहचान, गंतव्य और एन्क्रिप्टेड लीजसेट्स के लिए; राउटर पहचानों के लिए कभी नहीं प्रयोग किया जाता
=======================  ===========  ======  =====

### सामान्य संरचना डेटा लंबाई

नए हस्ताक्षर प्रकार पर लागू होता है।

==================================  =============
            डेटा प्रकार                लंबाई    
==================================  =============
हैश                                     64      
निजी कुंजी                               32      
सार्वजनिक कुंजी                           32      
हस्ताक्षर                                64      
==================================  =============

### निजीकरण

हस्ताक्षरों के विभिन्न उपयोगों के लिए डोमेन विभाजन प्रदान करने के लिए, हम BLAKE2b के निजीकरण सुविधा का उपयोग करेंगे।

सभी BLAKE2b हस्ताक्षरों के उपयोग में एक 16-अक्षर का निजीकरण स्ट्रिंग का उपयोग होगा। किसी भी नए उपयोग को यहां की तालिका में अद्वितीय निजीकरण के साथ जोड़ा जाना चाहिए।

नीचे NTCP 1 और SSU हैंडशेक के उपयोग हैंडलशेक में परिभाषित हस्ताक्षरित डेटा के लिए हैं। डेटाबेस स्टोर मैसेज में हस्ताक्षरित RouterInfos नेटवर्क डेटाबेस प्रविष्टि निजीकरण का उपयोग करेंगे, जैसे कि NetDB में संग्रहीत अगर।

==================================  ==========================
         उपयोग                      16 बाइट निजीकरण स्ट्रिंग
==================================  ==========================
I2CP सत्र कॉन्फ़िग                  "I2CP_SessionConf"
नेटडब प्रविष्टियाँ (RI, LS, LS2)    "network_database"
NTCP 1 हैंडशेक                      "NTCP_1_handshake"
हस्ताक्षरित डाटाग्राम              "sign_datagramI2P"
स्ट्रीमिंग                           "streaming_i2psig"
SSU हैंडशेक                         "SSUHandshakeSign"
SU3 फाइल्स                         n/a, समर्थित नहीं
यूनिट परीक्षण                          "test1234test5678"
==================================  ==========================

## टिप्पणियाँ

## मुद्दे

- वैकल्पिक 1: प्रस्ताव 146; LEA प्रतिरोध प्रदान करता है
- वैकल्पिक 2: RFC 8032 में Ed25519ctx; LEA प्रतिरोध और निजीकरण प्रदान करता है। मानकीकृत, लेकिन क्या कोई इसका उपयोग करता है? देखें [RFC-8032]_ और [ED25519CTX]_।
- क्या "कुंजीबद्ध" हैशिंग हमारे लिए उपयोगी है?

## माइग्रेशन

पूर्व हस्ताक्षर प्रकारों की रोलआउट के समान।

हम योजना बना रहे हैं कि नए राउटर को प्रकार 7 से प्रकार 12 में डिफ़ॉल्ट के रूप में बदलें। हम योजना बना रहे हैं कि प्रकार 7 से प्रकार 12 में मौजूदा राउटर्स को समय के साथ माइग्रेट करें, उसी "रिकेयिंग" प्रक्रिया का इस्तेमाल करेंगे जो प्रकार 7 के शुरू होने के बाद इस्तेमाल की गई थी। हम योजना बना रहे हैं कि नए गंतव्य को प्रकार 7 से प्रकार 12 में डिफ़ॉल्ट के रूप में बदल दें। हम योजना बना रहे हैं कि नए एन्क्रिप्टेड गंतव्यों को प्रकार 11 से प्रकार 13 में डिफ़ॉल्ट के रूप में बदल दें।

हम प्रकार 7, 11, और 12 से प्रकार 12 में ब्लाइंडिंग का समर्थन करेंगे। हम प्रकार 12 को प्रकार 11 में ब्लाइंडिंग का समर्थन नहीं करेंगे।

नए राउटर कुछ महीनों बाद डिफ़ॉल्ट रूप से नए सिग प्रकार का उपयोग शुरू कर सकते हैं। नए गंतव्य शायद एक साल बाद डिफ़ॉल्ट रूप से नए सिग प्रकार का उपयोग शुरू कर सकते हैं।

न्यूनतम राउटर संस्करण 0.9.TBD के लिए, राउटर यह सुनिश्चित करें:

- 0.9.TBD संस्करण से कम वाले राउटरों के लिए किसी RI या LS को नए सिग प्रकार के साथ संग्रहीत (या बाढ़) न करें।
- जब एक नेटडब स्टोर का सत्यापन करते हैं, तो 0.9.TBD संस्करण से कम वाले राउटरों से नए सिग प्रकार के साथ किसी RI या LS को प्राप्त न करें।
- उनके RI में नए सिग प्रकार वाले राउटर 0.9.TBD संस्करण से कम वाले राउटरों के साथ NTCP, NTCP2, या SSU के साथ कनेक्ट नहीं कर सकते।
- स्ट्रीमिंग कनेक्शंस और हस्ताक्षरित डाटाग्राम्स 0.9.TBD संस्करण से कम वाले राउटरों के लिए काम नहीं करेंगे, लेकिन इसका पता लगाने का कोई तरीका नहीं है, इसलिए नए सिग प्रकार को 0.9.TBD के जारी होने के कुछ महीनों या वर्षों के लिए डिफ़ॉल्ट रूप से उपयोग नहीं किया जाना चाहिए।

## संदर्भ

.. [BLAKE2]  
   https://blake2.net/blake2.pdf

.. [ED25519CTX]  
   https://moderncrypto.org/mail-archive/curves/2017/000925.html

.. [ED25519-REFS]  
    "उच्च गति उच्च सुरक्षा हस्ताक्षर" डैनियल  
    जे. बर्नस्टीन, निएल्स डुइफ, तांजा लैंग, पीटर श्वाबे, और  
    बो-यिन यांग द्वारा लिखित। http://cr.yp.to/papers.html#ed25519

.. [EDDSA-FAULTS]  
   https://news.ycombinator.com/item?id=15414760

.. [LEA]  
   https://en.wikipedia.org/wiki/Length_extension_attack

.. [RFC-7693]  
   https://tools.ietf.org/html/rfc7693

.. [RFC-8032]  
   https://tools.ietf.org/html/rfc8032

.. [ZCASH]  
   https://github.com/zcash/zips/tree/master/protocol/protocol.pdf
