---
title: "एन्क्रिप्टेड Leasesets के लिए B32"
description: "एन्क्रिप्टेड LS2 leasesets के लिए Base 32 पते का प्रारूप"
slug: "b32encrypted"
lastUpdated: "2025-10"
accurateFor: "2.10.0"
status: "कार्यान्वित"
---

## अवलोकन

Standard Base 32 ("b32") पतों में गंतव्य का हैश होता है। यह एन्क्रिप्टेड LS2 (LeaseSet2, I2P का नया leaseSet प्रारूप; प्रस्ताव 123) के लिए काम नहीं करेगा।

हम एन्क्रिप्टेड LS2 (proposal 123) के लिए पारंपरिक base 32 पता उपयोग नहीं कर सकते, क्योंकि इसमें destination का केवल हैश होता है। यह ब्लाइंड न की गई सार्वजनिक कुंजी प्रदान नहीं करता। क्लाइंट्स को leaseset को प्राप्त कर डिक्रिप्ट करने के लिए destination (I2P में गंतव्य पहचान) की सार्वजनिक कुंजी, हस्ताक्षर प्रकार, ब्लाइंडेड हस्ताक्षर प्रकार, और एक वैकल्पिक रहस्य या निजी कुंजी पता होना चाहिए। इसलिए, केवल base 32 पता पर्याप्त नहीं है। क्लाइंट को या तो पूरा destination (जिसमें सार्वजनिक कुंजी होती है) चाहिए, या फिर केवल सार्वजनिक कुंजी ही। यदि क्लाइंट के पास किसी पता पुस्तिका में पूरा destination है, और वह पता पुस्तिका हैश के आधार पर रिवर्स लुकअप का समर्थन करती है, तो सार्वजनिक कुंजी प्राप्त की जा सकती है।

यह प्रारूप base32 पते में हैश के बजाय सार्वजनिक कुंजी रखता है। इस प्रारूप में सार्वजनिक कुंजी के हस्ताक्षर प्रकार और ब्लाइंडिंग योजना के हस्ताक्षर प्रकार का भी समावेश होना आवश्यक है।

यह दस्तावेज़ इन पतों के लिए b32 प्रारूप निर्दिष्ट करता है। जबकि हमने चर्चाओं के दौरान इस नए प्रारूप को "b33" पता कहा है, वास्तविक नया प्रारूप सामान्य ".b32.i2p" प्रत्यय को बरकरार रखता है।

## कार्यान्वयन स्थिति

प्रस्ताव 123 (New netDB Entries) का पूर्ण कार्यान्वयन संस्करण 0.9.43 (अक्टूबर 2019) में किया गया। एन्क्रिप्टेड LS2 फीचर सेट संस्करण 2.10.0 (सितंबर 2025) तक स्थिर रहा है, और पता निर्धारण प्रारूप या क्रिप्टोग्राफिक विनिर्देशों में कोई पीछे-संगतता तोड़ने वाले परिवर्तन नहीं हुए।

मुख्य कार्यान्वयन मील के पत्थर: - 0.9.38: मानक LS2 (LeaseSet2, लीज़सेट का नया प्रारूप) के लिए Floodfill समर्थन ऑफ़लाइन कुंजियों के साथ - 0.9.39: RedDSA हस्ताक्षर प्रकार 11 और मूलभूत एन्क्रिप्शन/डिक्रिप्शन - 0.9.40: पूर्ण B32 एड्रेसिंग समर्थन (प्रस्ताव 149) - 0.9.41: X25519-आधारित प्रति-क्लाइंट प्रमाणीकरण - 0.9.42: सभी ब्लाइंडिंग सुविधाएँ कार्यरत - 0.9.43: पूर्ण कार्यान्वयन घोषित (अक्टूबर 2019)

## डिज़ाइन

- नया प्रारूप unblinded (जिस पर ब्लाइंडिंग लागू नहीं है) सार्वजनिक कुंजी, unblinded हस्ताक्षर प्रकार, और blinded (ब्लाइंडिंग लागू) हस्ताक्षर प्रकार को शामिल करता है।
- वैकल्पिक रूप से निजी लिंक के लिए गुप्त और/या निजी कुंजी आवश्यकताओं को संकेत करता है।
- मौजूदा ".b32.i2p" प्रत्यय का उपयोग करता है, लेकिन अधिक लंबाई के साथ।
- त्रुटि पहचान के लिए एक चेकसम शामिल करता है।
- एन्क्रिप्टेड leasesets के पते 56 या अधिक एन्कोडेड अक्षरों (35 या अधिक डिकोडेड बाइट्स) द्वारा पहचाने जाते हैं, जबकि पारंपरिक बेस 32 पतों के लिए यह 52 अक्षर (32 बाइट्स) है।

## विनिर्देश

### निर्माण और एन्कोडिंग

निम्नलिखित स्वरूप का {56+ अक्षर}.b32.i2p (बाइनरी में 35+ अक्षर) होस्टनेम बनाएँ:

```
flag (1 byte)
  bit 0: 0 for one-byte sigtypes, 1 for two-byte sigtypes
  bit 1: 0 for no secret, 1 if secret is required
  bit 2: 0 for no per-client auth,
         1 if client private key is required
  bits 7-3: Unused, set to 0

public key sigtype (1 or 2 bytes as indicated in flags)
  If 1 byte, the upper byte is assumed zero

blinded key sigtype (1 or 2 bytes as indicated in flags)
  If 1 byte, the upper byte is assumed zero

public key
  Number of bytes as implied by sigtype
```
पोस्ट-प्रोसेसिंग और चेकसम:

```
Construct the binary data as above.
Treat checksum as little-endian.
Calculate checksum = CRC-32(data[3:end])
data[0] ^= (byte) checksum
data[1] ^= (byte) (checksum >> 8)
data[2] ^= (byte) (checksum >> 16)

hostname = Base32.encode(data) || ".b32.i2p"
```
b32 के अंत में किसी भी अनुपयोगी बिट का मान 0 होना चाहिए। मानक 56 अक्षर (35 बाइट) के पते में कोई अनुपयोगी बिट नहीं होती।

### डिकोडिंग और सत्यापन

```
strip the ".b32.i2p" from the hostname
data = Base32.decode(hostname)
Calculate checksum = CRC-32(data[3:end])
Treat checksum as little-endian.
flags = data[0] ^ (byte) checksum
if 1 byte sigtypes:
  pubkey sigtype = data[1] ^ (byte) (checksum >> 8)
  blinded sigtype = data[2] ^ (byte) (checksum >> 16)
else (2 byte sigtypes):
  pubkey sigtype = data[1] ^ ((byte) (checksum >> 8)) || data[2] ^ ((byte) (checksum >> 16))
  blinded sigtype = data[3] || data[4]
parse the remainder based on the flags to get the public key
```
### गोपनीय और निजी कुंजी बिट्स

सीक्रेट और निजी कुंजी बिट्स का उपयोग क्लाइंट, प्रॉक्सी, या अन्य क्लाइंट-साइड कोड को यह संकेत देने के लिए किया जाता है कि leaseset को डिक्रिप्ट करने के लिए सीक्रेट और/या निजी कुंजी आवश्यक होगी। कुछ विशिष्ट कार्यान्वयन उपयोगकर्ता से आवश्यक डेटा उपलब्ध कराने के लिए प्रॉम्प्ट कर सकते हैं, या यदि आवश्यक डेटा अनुपस्थित हो तो कनेक्शन प्रयासों को अस्वीकार कर सकते हैं।

ये बिट्स केवल संकेतकों के रूप में कार्य करते हैं। गुप्त या निजी कुंजी को कभी भी B32 address (Base32-एन्कोडेड पता) में शामिल नहीं किया जाना चाहिए, क्योंकि इससे सुरक्षा से समझौता हो जाएगा।

## क्रिप्टोग्राफ़िक विवरण

### Blinding Scheme (ब्लाइंडिंग योजना)

यह ब्लाइंडिंग योजना Ed25519 (Ed25519—एक एलिप्टिक-कर्व) और ZCash (ZCash—गोपनीयता-केंद्रित क्रिप्टोकरेंसी) के डिज़ाइन पर आधारित RedDSA (RedDSA—Ed25519 पर आधारित डिजिटल सिग्नेचर स्कीम) का उपयोग करती है, जो SHA-512 (SHA-512—क्रिप्टोग्राफिक हैश फ़ंक्शन) का उपयोग करके Ed25519 कर्व पर Red25519 (Red25519—Ed25519 कर्व पर RedDSA हस्ताक्षर प्रारूप) हस्ताक्षर उत्पन्न करती है। यह तरीका सुनिश्चित करता है कि ब्लाइंड किए गए पब्लिक की prime-order subgroup (prime-order subgroup—प्राइम-ऑर्डर उपसमूह) में ही रहें, जिससे कुछ वैकल्पिक डिज़ाइनों में मौजूद सुरक्षा चिंताओं से बचा जा सके।

Blinded keys (ब्लाइंडेड कुंजियाँ—क्रिप्टोग्राफ़ी में छिपाई गई कुंजियाँ) UTC तारीख के आधार पर प्रतिदिन बदली जाती हैं, इस सूत्र का उपयोग करते हुए:

```
blinded_key = BLIND(unblinded_key, date, optional_secret)
```
DHT (वितरित हैश तालिका) के भंडारण स्थान की गणना इस प्रकार की जाती है:

```
SHA256(type_byte || blinded_public_key)
```
### एन्क्रिप्शन

एन्क्रिप्टेड leaseSet एन्क्रिप्शन के लिए ChaCha20 stream cipher (धारा-आधारित कूटलेखन) का उपयोग करता है, जिसे AES हार्डवेयर त्वरण न होने वाले उपकरणों पर श्रेष्ठ प्रदर्शन के कारण चुना गया है। विनिर्देश कुंजी व्युत्पत्ति के लिए HKDF (HMAC-आधारित कुंजी व्युत्पत्ति फ़ंक्शन) और Diffie-Hellman क्रियाओं के लिए X25519 का उपयोग करता है।

एन्क्रिप्टेड leasesets की तीन-स्तरीय संरचना होती है: - बाहरी परत: सादा-पाठ मेटाडेटा - मध्य परत: क्लाइंट प्रमाणीकरण (DH (Diffie-Hellman, कुंजी-विनिमय) या PSK (Pre-Shared Key, पूर्व-साझा कुंजी) विधियाँ) - आंतरिक परत: लीज़ जानकारी के साथ वास्तविक LS2 डेटा

### प्रमाणीकरण विधियाँ

प्रति-क्लाइंट प्रमाणीकरण दो तरीकों का समर्थन करता है:

**DH प्रमाणीकरण**: X25519 कुंजी समझौते का उपयोग करता है। प्रत्येक अधिकृत क्लाइंट अपनी सार्वजनिक कुंजी सर्वर को प्रदान करता है, और सर्वर ECDH (Elliptic-Curve Diffie-Hellman) से व्युत्पन्न एक साझा रहस्य का उपयोग करके मध्य परत को एन्क्रिप्ट करता है।

**PSK प्रमाणीकरण**: कूटलेखन के लिए पूर्व-साझा कुंजियों का सीधे उपयोग करता है।

B32 पते में फ्लैग बिट 2 यह संकेत करता है कि प्रति-क्लाइंट प्रमाणीकरण आवश्यक है या नहीं।

## कैशिंग

यद्यपि यह इस विनिर्देश के दायरे से बाहर है, routers और क्लाइंट्स को सार्वजनिक कुंजी और डेस्टिनेशन (गंतव्य) के बीच के मानचित्रण को याद रखना और उसे कैश करना (स्थायी कैश रखना अनुशंसित है), तथा इसके विपरीत भी, आवश्यक है।

blockfile naming service (ब्लॉकफाइल नामकरण सेवा), जो संस्करण 0.9.8 से I2P की डिफ़ॉल्ट address book प्रणाली है, कई address books बनाए रखती है और एक समर्पित reverse-lookup map (उल्टा खोज मानचित्र) के जरिए hash के आधार पर तेज़ लुकअप प्रदान करती है। जब प्रारंभ में केवल hash ही ज्ञात हो, तब एन्क्रिप्टेड leaseSet के रिज़ॉल्यूशन के लिए यह क्षमता अत्यंत महत्वपूर्ण होती है।

## हस्ताक्षर प्रकार

I2P संस्करण 2.10.0 के अनुसार, 0 से 11 तक के हस्ताक्षर प्रकार परिभाषित हैं। एक-बाइट एन्कोडिंग मानक बनी हुई है, जबकि दो-बाइट एन्कोडिंग उपलब्ध तो है, पर व्यवहार में उपयोग नहीं होती।

**सामान्यतः प्रयुक्त प्रकार:** - Type 0 (DSA_SHA1): routers के लिए अप्रचलित, destinations (गंतव्य) के लिए समर्थित - Type 7 (EdDSA_SHA512_Ed25519): router पहचान और destinations के लिए वर्तमान मानक - Type 11 (RedDSA_SHA512_Ed25519): ब्लाइंडिंग समर्थन वाले एन्क्रिप्टेड LS2 leasesets के लिए विशेष रूप से

**महत्वपूर्ण नोट**: केवल Ed25519 (type 7) और Red25519 (type 11) ही एन्क्रिप्टेड leasesets के लिए आवश्यक blinding (क्रिप्टोग्राफ़िक रूप से पहचान छिपाने की प्रक्रिया) का समर्थन करते हैं। अन्य हस्ताक्षर प्रकार इस विशेषता के साथ उपयोग नहीं किए जा सकते।

प्रकार 9-10 (GOST algorithms, रूसी मानक क्रिप्टोग्राफ़िक एल्गोरिद्म) अभी भी आरक्षित हैं, लेकिन लागू नहीं किए गए हैं। प्रकार 4-6 और 8 को ऑफ़लाइन साइनिंग कुंजियों के लिए "offline only" के रूप में चिह्नित किया गया है।

## टिप्पणियाँ

- लंबाई के आधार पर पुराने और नए वेरिएंट अलग करें। पुराने b32 पते हमेशा {52 chars}.b32.i2p होते हैं। नए वाले {56+ chars}.b32.i2p होते हैं
- base32 एन्कोडिंग RFC 4648 मानकों का पालन करती है, जिसमें case-insensitive डिकोडिंग और lowercase आउटपुट को प्राथमिकता दी जाती है
- जब बड़े सार्वजनिक कुंजियों वाले हस्ताक्षर प्रकार उपयोग होते हैं (उदा., ECDSA P521 के साथ 132-बाइट कुंजियाँ), तो पते 200 अक्षरों से अधिक हो सकते हैं
- नया फ़ॉर्मेट jump links (जंप लिंक—एड्रेस लुकअप/रिज़ॉल्यूशन हेतु लिंक) में भी उपयोग किया जा सकता है (और jump servers द्वारा उपलब्ध कराया जा सकता है), बिल्कुल मानक b32 की तरह, यदि चाहें
- Blinded keys (ब्लाइंडेड कुंजियाँ—गोपनीयता बढ़ाने हेतु ब्लाइंडिंग लागू की गई कुंजियाँ) गोपनीयता बढ़ाने के लिए UTC तिथि के आधार पर प्रतिदिन रोटेट होती हैं
- यह फ़ॉर्मेट Tor के rend-spec-v3.txt के appendix A.2 वाले दृष्टिकोण से भिन्न है, जिसमें off-curve blinded public keys के साथ संभावित सुरक्षा निहितार्थ हो सकते हैं

## संस्करण संगतता

यह विनिर्देश I2P संस्करण 0.9.47 (अगस्त 2020) से लेकर संस्करण 2.10.0 (सितंबर 2025) तक के लिए सटीक है। इस अवधि में B32 addressing format (Base32 आधारित पता प्रारूप), encrypted LS2 structure (एन्क्रिप्टेड LeaseSet संस्करण 2 संरचना), या क्रिप्टोग्राफिक कार्यान्वयन में कोई संगतता-तोड़ने वाला परिवर्तन नहीं हुआ है। 0.9.47 से बनाए गए सभी पते वर्तमान संस्करणों के साथ पूर्णतः संगत बने रहते हैं।

## संदर्भ

**CRC-32** - [CRC-32 (विकिपीडिया)](https://en.wikipedia.org/wiki/CRC-32) - [RFC 3309: स्ट्रीम कंट्रोल ट्रांसमिशन प्रोटोकॉल चेकसम](https://tools.ietf.org/html/rfc3309)

**I2P विनिर्देश** - [एन्क्रिप्टेड LeaseSet (I2P में गंतव्य के tunnel leases का रिकॉर्ड) विनिर्देश](/docs/specs/encryptedleaseset/) - [प्रस्ताव 123: नए netDB प्रविष्टियाँ](/proposals/123-new-netdb-entries/) - [प्रस्ताव 149: एन्क्रिप्टेड LS2 के लिए B32](/proposals/149-b32-encrypted-ls2/) - [सामान्य संरचनाओं का विनिर्देश](/docs/specs/common-structures/) - [नामकरण और पता पुस्तिका](/docs/overview/naming/)

**Tor तुलना** - [Tor चर्चा थ्रेड (डिज़ाइन संदर्भ)](https://lists.torproject.org/pipermail/tor-dev/2017-January/011816.html)

**अतिरिक्त संसाधन** - [I2P परियोजना](/) - [I2P फ़ोरम](https://i2pforum.net) - [Java API प्रलेखन](http://docs.i2p-projekt.de/javadoc/)
