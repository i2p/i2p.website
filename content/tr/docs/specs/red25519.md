---
title: "Red25519 İmza Şeması"
description: "Körleştirilmiş Destinations (I2P uç noktaları) oluşturmak için yeniden rastgeleleştirilebilir bir imza şeması"
slug: "red25519-signature-scheme"
lastUpdated: "2025-10"
accurateFor: "2.10.0"
---

## Genel Bakış

Bu belge, körlenebilen Destinations (I2P hedefi) oluşturmak için uygun, yeniden rastgeleleştirilebilir bir imza şemasını belirtir. Ayrıca, etkinlikte küçük bir azalma ile, mevcut Ed25519 Destinations üzerinde körleme uygulamak için de kullanılabilir.

Red25519, 0.9.39 sürümünden (21 Mart 2019'da yayımlandı) beri I2P router'larda tam işlevsel durumdadır. Bu spesifikasyon, 17 aylık üretimde kullanımın ardından 0.9.47 sürümünde (Ağustos 2020) nihai hale getirildi. İmza şeması, I2P ağında imza türü 11 (RedDSA_SHA512_Ed25519) olarak çalışır.

## Gerekçe

Öneri 123 (New netDB Entries), En Az Yetki İlkesi'ni somutlaştıran şifreli bir LeaseSet2 biçimini tanımlar: ağdaki her katılımcıya yalnızca kendi rolü için gerekli bilgi verilir. Özellikle, bir floodfill'e yayımlanan şifreli LeaseSet2, ait olduğu Destination'ı (I2P'de hedef kimliği) ifşa etmez ve Leases yalnızca Destination hakkında önceden bilgi sahibi olan biri tarafından görüntülenebilir. Ancak, floodfill'ler yine de yayımlandıklarında şifreli LeaseSet2'leri kimlik doğrulayabilmelidir ve istemciler ayrıca bu kimlik doğrulamasının bizzat Destination tarafından uygulandığından emin olmalıdır.

Öneri 123 bunu, Hedeflerin imzalama anahtarlarını körleştirerek sağlar. Körleştirilmiş anahtarlar, floodfill'ler tarafından doğrulanabilir imzalar oluşturmak için kullanılabilir ve istemciler yalnızca Hedefin bu imzaları oluşturmuş olabileceğinden emin olabilir. Bu nedenle, körleme için kullanılabilecek bir imza şemasının tanımlanması gerekir.

**Öneri 123'ün Durumuna Dair Not**: Öneri 123'ün bazı bölümleri 0.9.38 sürümünden beri aşamalı olarak uygulanıp devreye alınmış, 0.9.39'da ise Red25519 (kriptografik bir imza türü) desteği eklenmiştir. Şifreli LeaseSet2 (I2P'de bir hedefin erişim bilgilerini içeren veri yapısının 2. sürümü) işlevselliği üretim ortamı için hazırdır ve gizliliği artırılmış gizli servisler için I2P ağında aktif olarak kullanılmaktadır.

## Tasarım

### Temel imza şeması

Burada belirtilen imza şeması Red25519, Zcash Protokol Spesifikasyonu'nun (Sapling ve sonrası) 5.4.6. Bölümü'nde tanımlandığı şekliyle RedDSA'nın bir uygulamasıdır. RedDSA, key re-randomization (anahtarın yeniden rastgeleleştirilmesi) destekleyen Schnorr tabanlı bir imza şemasıdır. Aşağıdaki işlevlere sahiptir:

**GENERATE_PRIVATE()** : Tekdüze dağılımlı rastgele bir özel anahtar döndürür.

**DERIVE_PUBLIC(sk)** : Verilen özel anahtara karşılık gelen açık anahtarı döndürür.

**GENERATE_RANDOM()** : Bir anahtar çiftini yeniden rastgeleleştirmeye uygun rastgele bir skaler döndürür.

**RANDOMIZE_PRIVATE(sk, alpha)** : Gizli bir skaler alpha kullanarak özel anahtarı yeniden rastgeleleştirir.

**RANDOMIZE_PUBLIC(vk, alpha)** : Gizli bir skaler alpha kullanarak bir açık anahtarı yeniden rastgeleleştirir.

**SIGN(sk, m)** : Verilen m mesajı üzerinde sk özel anahtarıyla oluşturulan bir imza döndürür.

**VERIFY(vk, m, sig)** : sig adlı imzayı, genel anahtar vk ve mesaj m kullanılarak doğrular. İmza geçerliyse true döndürür, aksi halde false döndürür.

Belirli bir anahtar çifti (sk, vk) için aşağıdaki ilişki geçerlidir:

```
RANDOMIZE_PUBLIC(vk, alpha) == DERIVE_PUBLIC(RANDOMIZE_PRIVATE(sk, alpha))
```
### Ed25519 anahtarlarını Red25519'a dönüştürme

Ed25519 (bir dijital imza şeması) anahtarları, mevcut Ed25519 Hedeflerinin yeniden rastgeleleştirilmesini desteklemek amacıyla, geçici kullanım için tek yönlü olarak Red25519 (yeniden rastgeleleştirilebilir Ed25519 türevi) anahtarlarına dönüştürülebilir. Diğer imza türleri uyumlu değildir.

Aşağıdaki dönüşüm işlevlerini tanımlıyoruz:

**CONVERT_ED25519_PRIVATE(privkey)** : Verilen Ed25519 özel anahtarına karşılık gelen Red25519 özel anahtarını döndürür.

**CONVERT_ED25519_PUBLIC(pubkey)** : Verilen Ed25519 açık anahtarına karşılık gelen Red25519 açık anahtarını döndürür.

Verilen bir Ed25519 (eliptik eğri imza şeması) anahtar çifti (privkey, pubkey) için aşağıdaki ilişki geçerlidir:

```
CONVERT_ED25519_PUBLIC(pubkey) == DERIVE_PUBLIC(CONVERT_ED25519_PRIVATE(privkey))
```
## Teknik Şartname

### Tanımlar

**B** : [RFC 8032](https://www.rfc-editor.org/rfc/rfc8032.html)'de tanımlandığı gibi Ed25519 basepoint (eğri üzerindeki sabit üreteç noktası).

**L** : [RFC 8032](https://www.rfc-editor.org/rfc/rfc8032.html)'de belirtildiği gibi Ed25519 grubunun mertebesi 2^252 + 27742317777372353535851937790883648493.

**[s] B** : Taban noktasının s ile sabit tabanlı skaler çarpımı.

**[s] A** : A'nın s ile değişken tabanlı skaler çarpımı.

**x || y** : x ve y bayt dizilerini birleştir.

### Red25519 (bir kriptografik imza algoritması)

Red25519 şeması, RedDSA'yı şu şekilde özelleştirir:

- G := Curve25519'un Edwards formu üzerindeki nokta grubu. Özellikle bu, Red25519'un mertebesi L olan asal mertebeli alt grubu kullandığı ve kofaktör h_G'nin 8 olduğu anlamına gelir.
- P_G := Ed25519 taban noktası B.
- l_H := 512
- H(x) := SHA-512("I2P_Red25519H(x)" || x)

**Hash Fonksiyonu Seçimine İlişkin Not**: Red25519, BLAKE2b-512 (Zcash RedDSA'da kullanılır) yerine SHA-512 kullanır. Bu tasarım tercihi, aşağıda açıklanan length-prefixing (uzunluk ön ekleme) korumasıyla telafi edilir. I2P Proposal 148, Duplicate Message Identification (DMI, yinelenen mesaj tanımlama) ve Length Extension Attacks (LEA, uzunluk uzatma saldırıları) karşısında gelişmiş koruma ve daha iyi performans için gelecekte BLAKE2b-512'ye geçişi önerir.

RedDSA, H(x)'in, uzunluk genişletme saldırılarına karşı güvenli bir kriptografik özet işleviyle gerçekleştirildiğini varsayar. SHA-512 bunu tek başına sağlamaz. Bunu gidermek için, iletilerin başına uzunluklarının prefix-free encoding (önek-özgür kodlama) ile kodlanmış hali getirilmesini şart koşuyoruz:

```
len_u16(M) || M
```
burada `len_u16(M)`, M'nin uzunluğunun 2 baytlık temsili olup, skalerlerin ve noktaların little-endian kodlamasıyla tutarlı olacak şekilde little-endian (küçük endian bayt sıralaması) biçimindedir.

Mesajlar 65534 baytı aşmamalıdır. 65535 uzunluk değeri, gelecekteki olası genişletmeler için ayrılmıştır.

**Güvenlik Notu**: Karma fonksiyonuna genel anahtarın (vk) dahil edilmesi, imzalama sırasında kullanılan 80 rastgele bayt ile birlikte, RedDSA'nın erken tasarımlarında keşfedilen SURK-CMA (Strong Unforgeability with Re-randomized Keys under Chosen Message Attack - Seçilen Mesaj Saldırısı altında Yeniden Rastgeleleştirilmiş Anahtarlarla Güçlü Taklit Edilemezlik) güvenlik açıklarına karşı koruma sağlar. Bu gerçekleme, NCC Group Zcash denetimindeki güvenlik düzeltmelerini (Bulgu NCC-Zcash2018-009) içerir.

### Kodlama ve kod çözme

Red25519 özel anahtarları, mod L skalerler olup little-endian gösteriminde kodlanırlar. Bir skalerin bayt dizisi ve tamsayı biçimleri arasında dönüşüm yapmak için `DECODE_SCALAR` ve `ENCODE_SCALAR` işlevlerini tanımlarız.

Red25519 genel anahtarları, Curve25519'un Edwards biçimi üzerindeki noktalardır. Bunlar, y-koordinatının 255 bitlik little-endian (küçük-endian sıralama) gösterimi ve bunu izleyen, x-koordinatının işaretini belirten tek bir bit olarak kodlanır. Bu, Ed25519 için kullanılan kodlamayla aynıdır. Bir noktanın bayt dizisi ve koordinat biçimleri arasında dönüştürme yapmak için `DECODE_POINT` ve `ENCODE_POINT` işlevlerini tanımlıyoruz.

### RedDSA fonksiyonları

Gerçekleştirmeyi kolaylaştırmak için, aşağıda Red25519 için zaten özelleştirilmiş RedDSA işlevlerini (ve birkaç yardımcı işlevi) açıkça sunuyoruz. RedDSA işlevlerinin genel belirtimi için, uygulayıcılar Zcash Protocol Specification belgesinin 5.4.6 bölümüne başvurmalıdır.

```
HStar(prefix1, prefix2, m) :=
    h = SHA-512()
    h.input("I2P_Red25519H(x)")
    h.input(prefix1)
    h.input(prefix2)

    h.input(len(m) & 0xff)
    h.input((len(m) >> 8) & 0xff)
    h.input(m)

    s = h.digest()
    return s mod L

GENERATE_PRIVATE :=
    s = 64 random bytes
    return s mod L

DERIVE_PUBLIC(sk) := [sk] B

GENERATE_RANDOM :=
    s = 64 random bytes
    return s mod L

RANDOMIZE_PRIVATE(sk, alpha) := (sk + alpha) mod L

RANDOMIZE_PUBLIC(vk, alpha) := vk + [alpha] B

SIGN(sk, m) :=
    T = 80 random bytes
    vkBytes = ENCODE_POINT(DERIVE_PUBLIC(sk))
    r = HStar(T, vkBytes, m)

    R = [r] B
    Rbytes = ENCODE_POINT(R)

    c = HStar(Rbytes, vkBytes, m)
    S = (r + (c * sk)) mod L

    return Rbytes || ENCODE_SCALAR(S)

VERIFY(vk, m, sig) :=
    Rbytes = sig[0..32]
    Sbytes = sig[32..64]

    R = DECODE_POINT(Rbytes)
    if R is invalid:
        return false

    S = DECODE_SCALAR(Sbytes)
    if S >= L:
        return false

    vkBytes = ENCODE_POINT(vk)
    c = HStar(Rbytes, vkBytes, m)
    return ((-[S] B) + R + ([c] vk)).multiplyByCofactor().isIdentity()
```
### Dönüştürme işlevleri

```
CONVERT_ED25519_PRIVATE(privkey) :=
    s = SHA-512(privkey)[0..32]
    s[0] = s[0] & 248
    s[31] = (s[31] & 63) | 64
    return s

CONVERT_ED25519_PUBLIC(pubkey) := pubkey
```
`CONVERT_ED25519_PRIVATE` uygulamasının, bir Ed25519 özel anahtardan Ed25519 açık anahtar türetilirken gizli skaler s değerinin hesaplanmasına, [RFC 8032](https://www.rfc-editor.org/rfc/rfc8032.html) belgesinin 5.1.5 bölümündeki 1-3. adımlarda belirtildiği üzere, eşdeğer olduğunu unutmayın.

## Güvenlik etkileri

Red25519 Destination (I2P'de adres/kimlik) yeniden rastgeleleştirilip ardından onunla imzalar oluşturulduğunda, Destination hakkında herhangi bir bilginin sızmasına yol açmaz; çünkü `RANDOMIZE_PRIVATE` aracılığıyla üretilen Red25519 özel anahtarlarının dağılımı, `GENERATE_PRIVATE` aracılığıyla üretilen özel anahtarların dağılımıyla aynıdır ve `DERIVE_PUBLIC` deterministiktir.

Ed25519 özel anahtarlarının `CONVERT_ED25519_PRIVATE` aracılığıyla Red25519'a dönüştürülmesi aynı dağılımla sonuçlanmaz. Ancak, güvenlikteki azalmayı aşağıdaki nedenlerle kabul edilebilir buluyoruz:

- Ed25519 skalerlerinin uzayı, Red25519 skalerlerinin uzayının yaklaşık yarısı kadardır (2^251 olası Ed25519 skaler vardır ve L ~= 2^252 olası Red25519 skaler vardır). Bu nedenle güvenlik kaybı en fazla yaklaşık 2 kat, yani yaklaşık 1 bit olur (çünkü tesadüfen, aynı zamanda geçerli bir Ed25519 skaler olan bir Red25519 skaler seçmiş olabiliriz).
- Mevcut Ed25519 Destinations (I2P'de bir adres) geçmişte zaten ağ üzerinde ifşa edilmiştir ve kötü niyetli floodfills'in bunları çoktan listelemiş olduğu varsayılmalıdır.

**Önemli**: Bu güvenlik azalmasından endişe duyan kullanıcılar, Destinations (I2P hedefleri) için sigtype (imza türü) olarak Ed25519 (imza türü 7) yerine Red25519'u (imza türü 11) kullanmalıdır.

Yukarıdaki argüman yeniden rastgeleleştirme skaler alpha için geçerli değildir; önyargılı bir alpha seçildiğinde her seferinde anahtar hakkında bilgi sızar, çünkü toplamsal yeniden rastgeleleştirme tek kullanımlık bloknot gibi davranır.

### Güvenlik denetimi durumu

**Önemli Açıklama**: I2P, Red25519 dahil, hiçbir zaman resmi bir üçüncü taraf güvenlik denetiminden geçmemiştir. Altta yatan RedDSA tasarımı, 2018'de Zcash Sapling protokol denetiminin bir parçası olarak NCC Group tarafından güvenlik incelemesinden geçti; bu incelemede güvenlik sorunları tespit edilip giderildi. Ancak, I2P'nin (BLAKE2b-512 yerine) SHA-512 ile yapılan özgül gerçeklenimi ve I2P domain separation (etki alanı ayrımı) bağımsız olarak analiz edilmemiştir.

str4d tarafından geliştirilen ed25519-java referans uygulaması, tek bir bağımsız üçüncü taraf denetiminden geçti; ancak bu, Red25519 implementasyonundan önceydi ve yalnızca Ed25519 işlevselliğini kapsadı, Red25519 uzantılarını değil.

Red25519’u devreye alan kullanıcılar bu sınırlamayı anlamalı ve kendi tehdit modellerine göre güvenlik açısından ödünleri değerlendirmelidir.

## Uyumluluk

Red25519 (bir imza algoritması) destekleyen I2P sürümleri (sürüm 0.9.39 ve sonrası), Red25519 ile imzalanmış ağ veri yapılarını doğrulayabilir. Red25519'u desteklemeyen I2P sürümleri ise bunu bilinmeyen bir imza olarak ele alır ve veri yapılarını göz ardı edebilir.

**Dağıtım Zaman Çizelgesi**: - **0.9.39** (Mart 2019): floodfills içinde Encrypted LS2 (şifreli LeaseSet2) desteğiyle ilk uygulama - **0.9.40** (Mayıs 2019): Encrypted LS2 için istemci başına yetkilendirme - **0.9.41** (Ağustos 2019): Meta LS2 ve çevrimdışı anahtarlarla Encrypted LS2 - **0.9.43** (Şubat 2020): Encrypted LS2 için b32 desteği - **0.9.47** (Ağustos 2020): Spesifikasyonun tamamlanması - **2.10.0** (Ekim 2025): Güncel ağ sürümü (0.9.67+ ile eşdeğer)

Kullanıcılar, Red25519 ile imzalanmış veri yapılarının güvenilirliğinin Encrypted LeaseSet2 kullanım senaryoları için iyi olmasını bekleyebilir; çünkü ağ, ilk uygulamadan bu yana yükseltmelerini gerçekleştirmek için altı yılı aşkın bir süreye sahipti. Ancak, genel destination (hedef kimlik) kullanımıyla ilgili benimsenme metrikleri kamuya açık değildir.

**Birincil Kullanım Senaryosu**: Red25519, key blinding (anahtar körleştirme) gerektiren Şifreli LeaseSet2 işlevselliği için öncelikle kullanılır. Şifreli leaseset gereksinimi olmayan standart hedefler için, Ed25519 (signature type 7), daha geniş uyumluluğu ve daha uzun süredir kanıtlanmış geçmişi nedeniyle önerilen seçim olmaya devam eder.

## Uygulama notları

Red25519, I2P Java router'da `net.i2p.crypto.eddsa.RedDSAEngine` içinde gerçekleştirilmiş olup, str4d (Jack Grigg) tarafından geliştirilen ed25519-java kütüphanesini Maven bağımlılığı `net.i2p.crypto:eddsa` (sürüm 0.1.0'dan 0.3.0'a kadar) olarak kullanır.

i2pd C++ uygulaması ayrıca şifreli LeaseSet yayınlama için Red25519'u (signaturetype=11) destekler.

i2pd (I2P arka plan hizmeti) için yapılandırma örneği:

```
signaturetype=11
i2cp.leaseSetType=5
```
**Şifrelenmiş LeaseSet2 Uyumluluğu**: Şifrelenmiş LeaseSet spesifikasyonu, unblinded destination (körlenmemiş hedef) içindeki imza açık anahtarının Ed25519 (imza türü 7) veya Red25519 (imza türü 11) olmasını gerektirir. Şifrelenmiş leaseset işlevselliği için başka imza türleri desteklenmez.

## Test vektörleri

Aşağıdaki test vektörleri, uygulama doğrulaması için sağlanmıştır. Her vektör şunları içerir:

- `edsk`: Ed25519 özel anahtar (rastgele)
- `edpk`: edsk'ye karşılık gelen Ed25519 açık anahtar
- `sk`: CONVERT_ED25519_PRIVATE(edsk)
- `vk`: CONVERT_ED25519_PUBLIC(edpk)
- `msg`: İmzalanacak mesaj
- `sig`: SIGN(sk, msg)
- `alpha`: GENERATE_RANDOM()
- `rsk`: RANDOMIZE_PRIVATE(sk, alpha)
- `rvk`: RANDOMIZE_PUBLIC(vk, alpha)
- `rsig`: SIGN(rsk, msg)

**Uygulama Notu**: Bu test vektörleri, sürekli doğrulama için otomatik birim test paketlerine entegre edilmelidir. Uygulayıcılar, tüm dönüşümler, imzalar ve yeniden rastgeleleştirme işlemlerinin bu beklenen değerlerle eşleştiğini doğrulamalıdır.

### Test vektörü 1

```
edsk:  0101010101010101010101010101010101010101010101010101010101010101
edpk:  8a88e3dd7409f195fd52db2d3cba5d72ca6709bf1d94121bf3748801b40f6f5c
sk:    58e86efb75fa4e2c410f46e16de9f6acae1a1703528651b69bc176c088bef36e
vk:    8a88e3dd7409f195fd52db2d3cba5d72ca6709bf1d94121bf3748801b40f6f5c
msg:   0202020202020202020202020202020202020202020202020202020202020202
sig:   61f5527f4d3b46de4b2c234390370bf715ae9098907a0d191ba1b44b23a8ac1a
       6a40437a5294e9503faaf9bd2b7f2fe7ba44dec487b3185aba7ff7d7a17cd40f
alpha: ae9ba9cbbc047c442448fca7c9f4e288a202ed520bfad0c784b792b7773cee08
rsk:   8bb85f3c7a494a08890d7d142109c1a3501d04565d80227e2079097800fbe107
rvk:   6fe128737b8e76fa66698a748b0dc0a89168dd8a0601c2b1c0b26835d323e9b3
rsig:  533053074d3b44f08723aab988ede9880a001b7a684d4a98f2d1b88fabee07a5
       b5c9430c69a690321e0cb8365d7aeb6688bcbad2c0780e0c69e8a1b4a45f3001
```
### Test vektörü 2

```
edsk:  0202020202020202020202020202020202020202020202020202020202020202
edpk:  8139770ea87d175f56a35466c34c7ecccb8d8a91b4ee37a25df60f5b8fc9b394
sk:    a83c626bc9c38c8c201878ebb1d5b0b50ac40e8986c78793db1d4ef369fca14e
vk:    8139770ea87d175f56a35466c34c7ecccb8d8a91b4ee37a25df60f5b8fc9b394
msg:   0303030303030303030303030303030303030303030303030303030303030303
sig:   0829e58eb5399870f009bd1f0270264e556424bda7a93fbcec99f6d9d75db46d
       5c3cb546d9947ca7c1200876c8775a90c357a2aef3d2f16388242ee1914b1a0a
alpha: 98b615d9027e996cc2796c019d9c8beb46aa7d2b6eea2e5d98eb29eb1584c203
rsk:   9fcfaa734852ca40b3810ebef590e138516e8cb4f4b1b6f0730978de7f806402
rvk:   527e121090158419609e4a0d8de6f7d3271b353a8cd0b8172fe41468ea1e9177
rsig:  9a6961f35ed264a946cd6214b2326a6e6caa426c2a61bc14367fd278e0b5fb51
       3ac065a69210a457f17d12ba8a496cfd835002691affa8efcdecae48135c090f
```
**Not**: 3-10 numaralı ek test vektörleri aynı formatı izler ve referans uygulamada bulunabilir.

## Kaynaklar

